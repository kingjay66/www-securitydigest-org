VIRUS-L Digest   Tuesday,  4 Dec 1990    Volume 3 : Issue 191

Today's Topics:

Making Money With Viruses
Re: Sunday virus description? (PC)
Re: Any news on the SCANV trojan? (PC)
Warning Virus Alert! (PC)
Stoned (PC)
Re: Stoned in C: (PC)
Re: How safe are FTP sites from viruses? (PC)
Stoned virus (PC)
Re: How safe are FTP sites from viruses? (PC)
Re: RE: Trojan Warning (PC)
Re: Papers/Documentation...
Re: Washing machine (PC)
Re: Lateral Thinking
Re: ways to circumvent viri attack, maybe
Re: WDEF Prevention (Mac)
Virus Card?? (PC)
MUSICBUG (PC)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a non-digested Usenet counterpart.
Discussions are not limited to any one hardware/software platform -
diversity is welcomed.  Contributions should be relevant, concise,
polite, etc.  Please sign submissions with your real name.  Send
contributions to VIRUS-L@IBM1.CC.LEHIGH.EDU (that's equivalent to
VIRUS-L at LEHIIBM1 for you BITNET folks).  Information on accessing
anti-virus, documentation, and back-issue archives is distributed
periodically on the list.  Administrative mail (comments, suggestions,
and so forth) should be sent to me at: krvw@CERT.SEI.CMU.EDU.

   Ken van Wyk

---------------------------------------------------------------------------

Date:    29 Nov 90 11:52:00 -0400
From:    "zmudzinski, thomas" <zmudzinskit@imo-uvax.dca.mil>
Subject: Making Money With Viruses

I just received a flier pushing some new books on viruses and other
vandalware.  I wonder who is rich enough and dumb enough to buy this
stuff?

_Software Under Seige: Viruses and Worms_ by Ernst L. Leiss
    	 100pp, UK #45 US $76.50

_Security for Small Computers_ by Tricia Saddington
    	 119pp, UK #35 US $68

_The PC Security Guide 90/91_ by Keith Jackson & Jan Hruska
    	 372pp, UK #125 US $225

_Computer Virus Handbook_ Edited by Dr. Harold J. Highland
    	 375pp, UK #85 US $153

All I can say is, "Thar's GOLD in them thar worms!"

/Tom Zmudzinski/

+-----------+   Disclaimer under construction   +-----------+

The above does not constitute an endorsement for any product,
organization, or anything else that can be traced back to me.
                            In fact, I never said this!  *:{D

+----+   End construction - Resume normal blathering   +----+

------------------------------

Date:    29 Nov 90 17:17:55 +0000
From:    frisk@rhi.hi.is (Fridrik Skulason)
Subject: Re: Sunday virus description? (PC)

p0.f7.n391.z1.fidonet.org!David.Hobbs@uafhp.uark.edu (David Hobbs) writes:
>Can anyone explain what the Sunday virus is?  It seems to be going
>around (the town I live in).  What does McAfee's clean really do?
>Does it make the infected program reusable?

The Sunday virus is one of many Jerusalem variants - modified somewhat, but
still closely related to Jerusalem, New Jerusalem, Suriv 3, Anarkia, A-204,
Payday and all the other viruses in the Jerusalem family.

The problem with CLEAN, (as well as my own, and all other disinfection
programs) is thal all the above viruses may corrupt the file they infect,
making disinfection impossible.

This only happens, however, if the true length of an .EXE file does not match
the information stored in the header.

Worse still, occasionally (I only know of a fandful of examples), this
corruption cannot be detected by the disinfection software. Therefore, it is
safer not to disinfect, but to replace with originals, when you are dealing
with a Jerusalem-family virus.

The disinfection works in 99%+ of cases, restoring the program almost to its
original state, although the checksum in the header is usually wrong
afterwards.

- -frisk

------------------------------

Date:    Thu, 29 Nov 90 18:24:00 +0000
From:    s37775d@taltta.hut.fi (Pandy (A. Holmberg))
Subject: Re: Any news on the SCANV trojan? (PC)

ELEE4CZ@jetson.uh.edu (J.K. Meddahi) writes:
>I read a couple of postings last week that mentionned Trojans in the
>zip files SCANV68 and SCANV70. I was expecting more reactions to these
>two messages, but nothing got posted. Does that mean that this was an
>unfounded rumor?

	The answer is NO: Here is an article by Nir Klar, where he explains
	his problems with SCANV68:

=============================================================================
   Date : 18-Sep-90 22:27
   From : Nir Klar
Subject : scanv68 is a trojan

Hi Users,
I got a file called scanv68.zip (29248 bytes) that contained a file called
scan.com (63526 bytes). When I run it nothing really happened but after I
tried to run several other programs with no success I got some message about
SADAM HOUSAIN ! and so on.
* When I run it on my hard disk it filled the rest of the disk with the same
prog. (or just claimed it did).
* Info: date of scan.com is 10 aug 90
        time 15:55:62
        crc dco62f1a
* scan ver 66 did not detect any virus on it !

IT CAN BE A MODIFIED VER AND/OR TROJAN AND/OR VIRUS !!!!!!

BEWARE BEWARE BEWARE BEWARE BEWARE BEWARE BEWARE BEWARE BEWARE BEWARE !!!!!

                                                Hope I helped
                                                     Nir Klar

- --- RA 0.04a via TBU DemonTasker
 * Origin: > The Black Universe BBS - Setting New Standards < (2:403/139)

==============================================================================

	So be careful everybody. The latest official version of SCANV
	is today SCANV67C!!!!!!

	/pandy

- --
"I'm dreaming of a white christmas"
                            -- B. Crosby

******************************************************************************
       /I I   Andreas "Pandy" Holmberg             pandy@spiff.hut.fi
      /-I-I   Helsinki University of Technology    pandy@otax.hut.fi
     /  I I   Faculty of Electrical Engineering    s37775d@taltta.hut.fi
******************************************************************************

------------------------------

Date:    Thu, 29 Nov 90 19:42:28 +0000
From:    ajauch@orion.oac.uci.edu (Alex Jauch)
Subject: Warning Virus Alert! (PC)

WARNING: DO NOT BUY ARKANOID II, REVENGE OF DOH FROM WHEREHOUSE (ARCADIA).

I just purchased Arkanoid II and it was infected with the Jerusalem B
virus.  I called Wherehouse to inform them and they refused to
investigate or remove the product from the shelves.  I called Taito
and they didn't know what a virus was.

This was the IBM version on 5 1/4" disks.

BTW, I now have some pd stuff to fight this virus if anyone else has
had this problem.

- --
Alex Jauch
*ajauch@bonnie.ics.uci.edu       |"If all you have is a hammer, then the whole*
*ajauch@orion.oac.uci.edu        |world looks like a nail" -- Stolen          *

------------------------------

Date:    29 November, 1990
From:    Padgett Peterson <padgett%tccslr.dnet@uvs1.orl.mmc.com>
Subject: Stoned (PC)

OK folks, lets put this hysteria to rest. After all, the internals are
only 512 bytes and it really is not very smart. So far, I have not
seen it cause any destruction to hard disks, it just slides the real
partition table over to sector 7 and plants itself in sector 1. When
booted, it creates a 1k area for itself to go resident at the TOM by
changing location 0:413, and infects any 360k floppy (I'm talking the
Mk 1 version) accessed.

Since the "hidden" sectors of most fixed disks are unused, no damage
is done here, but since floppies use all legal sectors, the STONED
will overwrite the last 512 bytes of the directory table with the real
boot record.  (side 1 cyl 0 sector 3). If a floppy has over 96 files
in the directory table including deleted files, this will overwrite
the last entries and trash a DIR or CHKDSK operation. While the files
are still there and someone good can probably recover them, DOS is in
trouble.

Now what "extra added attractions" hackers have put into the plain
STONED remains to be seen - it would not be difficult to replace the
message mechanism with something else. Similarly, the STONED infects
only by booting from an infected floppy, however a trojan designed to
put the STONED into a partition table would again be a trivial
exercise. (See earlier postings on how to remove it & reverse).

Myself, I am almost as sick of seeing the STONED as the JERUSALEM.

						Padgett

------------------------------

Date:    30 Nov 90 09:34:27 -0500
From:    "David.M.Chess" <CHESS@YKTVMV.BITNET>
Subject: Re: Stoned in C: (PC)

The one case I know of in which the Stoned virus can cause that sort
of problem is if the hard disk was last FDISKed under a version of DOS
prior to 3.0.  DOS 2.x FDISK sets up the hard disk (under at least
some circumstances) so that part of the FAT is in the space that the
Stoned uses to store the disk's original master boot record.  So when
the Stoned infects such a hard disk, it does essentially-random things
to 512 bytes of the FAT; this will at least confuse CHKDSK, and if
that part of the FAT was in active use for files, can do arbitrary bad
things to the disk's file structure.  DC

------------------------------

Date:    30 Nov 90 09:38:24 -0500
From:    "David.M.Chess" <CHESS@YKTVMV.BITNET>
Subject: Re: How safe are FTP sites from viruses? (PC)

Patrick Ryan <sauron@stretch.cs.mun.ca>:
> Are you SURE?  I would disagree... the lab in our building has Stoned
> infections occurring very frequently, and not all of them are due to
> people booting from infected disks.  If that WERE the case, how would
> it spread to a floppy from hard drive?

Every Stoned virus that I've ever seen infects only when a machine is
booted from an infected diskette or hard disk.  When a machine with a
hard disk is booted from an infected floppy, the virus infects the
hard disk and loads itself into memory; when a machine is booted from
an infected hard disk, it just loads into memory.  While the virus is
in memory, it will infect any diskette used in Drive A: (roughly).
   It is of course possible that someone's written a Trojan Horse (or
even a virus) that lives in an EXE or COM file, and installs the
Stoned virus on hard disks under some circumstances.  I've never seen
such a program, though...

DC

------------------------------

Date:    Fri, 30 Nov 90 10:06:00 -0500
From:    George Bragg <George_Bragg@carleton.ca>
Subject: Stoned virus (PC)

Having seen a lot of confusion about what the stoned virus does, I
thought I'd tell you my own experiences with said virus when a major
infestation hit the university where I work as a computer consultant.
Stoned, as mentioned by others, is a boot sector virus.  It can only
infect memory if you boot up from a "dirty" disk.  Once it is in
memory, however, it writes to anything.  If you get it on a hard
drive, it attacks the FAT (I think), and when you reboot from the hard
drive, it's back in memory to spread it's jolly message to the masses.
This is probably why you'd see the cross- linked files with CHKDSK,
and why a floppy can be infected from a HD.  BTW, McAfee's SCAN does a
wonderful job of both detecting and removing this virus.

Disclaimer:  Nobody cares about my opinions, so I can't blame anybody else
             for them.
George Bragg (WATPOD46@CARLETON.CA)

------------------------------

Date:    Fri, 30 Nov 90 07:03:17 -0800
From:    Peter Sturdee <sturdee@troa02.enet.dec.com>
Subject: Re: How safe are FTP sites from viruses? (PC)

In Virus-l V3 #190, Patrick Ryan <sauron@stretch.cs.mun.ca> writes:

>... the lab in our building has Stoned infections occurring very frequently,
>and not all of them are due to people booting from infected disks.  If that
>WERE the case, how would it spread to a floppy from hard drive?

    The only time I have had the misfortune to have to deal with a virus,
    was when my portable came back from the shop with someone else's
    (infected) hard drive in it.  I didn't notice until after I had
    formatted several 1.44 meg floppies.  I then puzzled over why they
    were not able to be read by the drive.  Remembering that the Stoned
    virus was written before 3.5" disks and had a hard time dealing with
    them, I had a look at the boot sector.  Bingo, Stoned on all the
    floppies and the hard drive.

    I do not know by what other means the stoned virus spreads from hard
    drive to floppy, but the format utility did do it for me.

    On the other hand, I still do not see how the Stoned virus got off of
    an FTP site and onto a PC.

    Peter

    (We don't get .sig files here)

------------------------------

Date:    30 Nov 90 16:33:11 +0000
From:    abvax!iccgcc.decnet.ab.com!herrickd@uunet.UU.NET
Subject: Re: RE: Trojan Warning (PC)

oper1%drcv06.decnet@drcvax.af.mil (DRCV06::OPER1) writes:
> keithm@ashtate.A-T.COM (Keith Mund) writes:
>
>>>Speaking personally as a software author, buy software from the
>>>manufacturer or a legitimate dealer. The same fears you have are felt
>>>by them manyfold, and great care is taken to insure safe software.
>>>Although you threw out names of companies freely, none of them has
>>>distributed software with any problems. Why fear a problem that does
>>>not exist. Viruses are spread by individuals copying software, not by
>>>legitamate manufacturers.
>
> 	One way of insuring that the SCAN or F-PROT programs are
> legitamate is for the authors to ZIP their program with the -AV
> (Authenticate Verification) switch on.  That way if the programs were
> modified PKUNZIP would tell you.  It would also be a way for users to
> know that the ZIP file came straight from the author and hasn't been
> modified in any way.

Does Authenticate Verification really do something that is not
subvertible?  Forgive my skepticism.  What does it say it does?

dan herrick
herrickd@astro.pc.ab.com

------------------------------

Date:    30 Nov 90 18:06:57 +0000
From:    theo@cs.fau.edu (Theo Heavey)
Subject: Re: Papers/Documentation...

jstewart@rodan.acs.syr.edu (Ace Stewart) writes:

> A Request for Help
> - ------------------
>
> There are plenty of places where one can find virus combatting
> material, and plenty of places with virus programs. What I am looking
> for are Virus published papers, Virus documentation (and I've looked
> through sumex :), and technical reports that have been released.

Through anonymous ftp you can get the information through:
        acns.nwu.edu
        cert.sei.cmu.edu
        lut.fi
        rata.vuw.ac.nz
        watmsg.waterloo.edu

I look forward to "looking up" your anon ftp site when it opens please
keep me informed.

[Ed. You might also want to peruse the VIRUS-L/comp.virus archive
sites.  Stay tuned for info on how to access the archive sites...]

Theo Heavey
Florida Atlantic University
Department of Computer Science
Boca Raton, FL
internet: theo@cs.fau.edu
bitnet  : fauacm@servax.bitnet

------------------------------

Date:    30 Nov 90 18:48:32 +0000
From:    woody@chinacat.Unicom.COM (Woody Baker @ Eagle Signal)
Subject: Re: Washing machine (PC)

>
>         I found a funny thing on one of the machine.  This is a tsr
> file who responded when the return key is pressed.  It say that your
>
> funny joke.  I reset the PC and forgot to take a copy.  If a see it
> again i'll take a copy and let it avalaible to the net.

Sounds to me like DRAIN.  Drain is an old program that has been
floating around for about 6 years.  It is not a TSR.  It puts an A:>
prompt on the screen and looks just like you were logged onto drive A.
If you do anything at all, it starts up, gives a message about how you
have water in your drive, stand by, then proceeds to spin the disk
furiously, all the while doing a very good imitation of a washing
machine going into spin cycle.  Then it slows down, and emits an
extremely good imitation of water going down the drain.  No havoc at
all, just a joke.  This sounds like a modification of it.

Cheers
Woody

------------------------------

Date:    30 Nov 90 19:00:51 +0000
From:    woody@chinacat.Unicom.COM (Woody Baker @ Eagle Signal)
Subject: Re: Lateral Thinking

RZOTTO@DKNKURZ1.BITNET (Otto.Stolz) writes:
> Hellow fellow,
>
> > disk.
>
> > ... doing a reboot with int 19h, this would be difficult.
>
> I think, no virus would be able to survive a genuine, complete re-boot
> in memory AND re-gain controll. (Take this as an educated guess, as

A very good friend of mine, who sometimes watches this group, has
written a nifty gadget that he calls Acabus.  It survives everything
you do short of powering the machine off.  The routine when installed,
grabs a complete snapshot of the interrupt vector area of dos, and
stores it internally.  It then changes all the vectors to point to
it's entry point.  Due to the segmented architecture of the PC, it
does this by manipulating the paragraph and offset values so that they
are all diffrent, but point to the same physical spot.  When Acabus
gains control, it merely has to examine the address on the stack, to
determine which vector it was entered by.  It then vectors to the old
location for that vector.  Upon coming back from the vector, Acabus
again has control and runs a check of the interrupt vector area.  If
any of the vectors have changed, it copies them, chains them back into
the old vector and replaces the vector with what it wants to be there.
This is done very rapidly, and as a result, things operate like
normal.  As a matter of fact, it can gain such a secure hold on the
system that it can survive a boot of an ENTIRELY diffrent operating
system.  It can handle a reboot to CPM or XENIX or DOS and still
maintain control.

Cheers
Woody

------------------------------

Date:    30 Nov 90 19:11:48 +0000
From:    woody@chinacat.Unicom.COM (Woody Baker @ Eagle Signal)
Subject: Re: ways to circumvent viri attack, maybe

pc2d+@ANDREW.CMU.EDU (Philip Edward Cutone, III) writes:
> Just a thought,
>
>    What kind of impact would say, renaming com and exe files to
> something else while not being used.  Then at least viri that scan the
> disk looking for those files to infect would find no hosts in which to

You can patch command.com to accomplish this.  Using Norton utilites
search through command com for exe com and bat strings.  Change them
to whatever you wish.  The rename your files accordingly.  Be aware
however, that some programs spawn or run other programs and they may
assume exe or com extensions.  These will fail.  I have a slightly
diffrent technique.

I have a Tallgrass 1040I tape drive.  A marvelous drive, this little
jewel is a 40 meg drive that has a installable device driver that
makes it look like up to 5 hard drives.  I currently have 4 6.9 meg
drives and one about 14 meg.  I keep nearly all my stuff arced up and
stored on the tape.  When I need something, I go un arc it from the
tape (any dos command will work and you can open the tape files from
any language) and load it to my hard disk.  If I don't need it later,
I just delete it.

NOW: some viruses probably look at the file format to determine what
it is.  you can look for the signature at the front of the file to
determine if it is an exe file.  Dos will run a com file if you rename
it as an exe file, or an exe file if you rename it as a com file.  It
can figure things out, so there is no reason to assume that a virus
cannot do it.

Cheers
Woody

------------------------------

Date:    30 Nov 90 23:07:08 +0000
From:    lev@rsdps.gsfc.nasa.gov (Brian S. Lev)
Subject: Re: WDEF Prevention (Mac)

ACSMARTIN@EKU.BITNET (Bob Martin) writes...
>- -- "Idiots that continue to use the same old infected disks.....". For
>those of us that work in educational settings -- GateKeeper and
>Disinfectant are a must, in my humble opinion. I truly appreciate the
>authors dedication to providing us such fine products -- for free!!
>
>BTW, we also provide a means for folks to get these fantastic programs
>at our Micro Center -- they just bring a blank disk and we give them a
>locked disk with the programs on it.....

Amen to that!  I was volunteered to handle "Mac Security" (i.e.,
anti-virus activities) here a while back, and have lost track of how
many people tell me they NEVER EVER NEVER swap floppies with anyone so
their system is clean -- just as Disinfectant starts telling me their
system file and/or desktop file and/or multiple applications have been
chomped on within the same month!

I put together the "MacSecure" package here, based mainly on John
Norstad's "Disinfectant", and threw in a couple of helpful HyperCard
stacks (v1.2.5).  It's available from dftsrv.gsfc.nasa.gov and
dftnic.gsfc.nasa.gov in binhex format via Anon FTP...  (MacSecure 2.3a
is available; I expect to have 2.4 out late next week.)

+----------------------------------------------------------------------------+
|  Brian Lev/STX                           (301)286-9514   (FTS)888-9514     |
|  NASA Goddard Space Flight Center        DECnet: SDCDCL::LEV  (6153::LEV)  |
|  Advanced Data Flow Technology Office    TCP/IP: lev@dftnic.gsfc.nasa.gov  |
|  Code 930.4                              BITNET: LEV@DFTBIT                |
|  Greenbelt, MD  20771                    TELENET: [BLEV/GSFCMAIL]          |
|     X.400 Address: (C:USA,ADMD:TELEMAIL,PRMD:GSFC,O:GSFCMAIL,UN:BLEV)      |
+----------------------------------------------------------------------------+
|   "The ability of a network to knit together the members of a sprawling    |
|   community has proved to be the most powerful way of fostering scienti-   |
|   fic advancement yet discovered."  -- Peter Denning                       |
+----------------------------------------------------------------------------+
|     DISCLAIMER: THESE STATEMENTS ARE MY OWN AND *NOT* NASA'S OR STX'S!     |
+----------------------------------------------------------------------------+

------------------------------

Date:    Fri, 30 Nov 90 16:15:00 -0700
From:    rtravsky@UWYO.BITNET (Richard W Travsky)
Subject: Virus Card?? (PC)

Going through the December 'Computer Shopper' I spotted an ad for a
card to protect one's pc from virus infection.  It's called "MYODA
VG-303", $129, doesn't say anything about how it works.  Anyone have
any information of this device or others of its kind?  I've not seen
this sort of thing before.

(This was on page 379 of 'Computer Shopper',  from the Kandu mail order outfit.

Richard Travsky                        Bitnet:   RTRAVSKY @ UWYO
Division of Information Technology     Internet: RTRAVSKY @ CORRAL.UWYO.EDU
University of Wyoming                  (303) 766 - 3663 / 3668

------------------------------

Date:    30 November, 1990
From:    Padgett Peterson <padgett%tccslr.dnet@uvs1.orl.mmc.com>
Subject: MUSICBUG (PC)

	Thanks to Michael Head, I have had a chance to take a brief
look at this infector. If it were not for the vector, it might not be
dangerous, however it appears to be being distributed along with
Packard- Bell computers. Since these are often sold from general
merchandisors, it has the capacity to become widespread among
non-computer-literate users.

	The distribution appears to be on utilities disks provided
with the computers. I have not fully disassembled the virus yet but it
is a boot sector infector that can be recognised on floppies since the
DOS warning messages are not found on the boot sector and the jump
parameter of CCh is found in the third byte.

	Once infected, the virus goes resident in the TOM reducing a
CHKDSK total memory return by 4k (640k machine will report 651,264
bytes instead of 655,360 bytes).

	Only part of the code is stored in the boot sector of an
infected floppy. What looks like sloppy programming has the virus
store the action in DOS sector 45 (cyl 2 head 1 sect 1) on the floppy,
overwriting sector(s) in the files area. Both this sector and the
reserved area at the TOM will contain the ASCII string "MusicBug
v1.06. MacroSoft Corp.". It looks like this string will be found at
9C00:0210 in memory but cannot guarentee the address yet. Once the
rest of it is pulled apart, I can let you know what it does to a hard
disk & hopefully a cure.

	From what I have been told, the sealed envelopes containing
the floppy are marked with the same imprint of a blue floppy disk &
blue numbers partially overwritten by a red square containing what
look like chinese characters as was found with the "Modular Component
Technologies" disks that contained the STONED virus a few months ago.

					Meanwhile, it's getting late,
							Padgett

------------------------------

End of VIRUS-L Digest [Volume 3 Issue 191]
******************************************
