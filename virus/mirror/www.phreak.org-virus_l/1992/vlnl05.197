VIRUS-L Digest   Monday,  7 Dec 1992    Volume 5 : Issue 197

Today's Topics:

Re: Vshield vs Virstop (PC)
Info on Music Bug virus (PC)
Re: Filler virus (PC)
Re: Filler virus (PC)
Re: Is this a new virus? (PC)
Re: Need Info about INVOLVE virus (PC)
Re: Is this a new virus? (PC)
Re: Filler virus (PC)
Re: Vshield vs Virstop (PC)
Re: Filler Virus (PC)
Re: does McAfee SCAN remove viruses? (PC)
Re: Untouchable (PC)
Re: using %VARIABLE% with scan (PC)
Re: SCAN 99 and MtE detection (PC)
Re: ViruScan v99 and OS/2 (OS/2)
Re: Not a Stupid OS/2 Question (OS/2)
Re: ViruScan v99 and OS/2 (OS/2)
Second generation problems (Philosophy)
Re: CHRISTMA: The "Card"!(CVP)
CHRISTMA EXEC Wannabes (CVP)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a non-digested Usenet counterpart.
Discussions are not limited to any one hardware/software platform -
diversity is welcomed.  Contributions should be relevant, concise,
polite, etc.  (The complete set of posting guidelines is available by
FTP on cert.sei.cmu.edu or upon request.) Please sign submissions with
your real name.  Send contributions to VIRUS-L@LEHIGH.EDU.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on cert.org (192.88.209.5).  Administrative mail
(comments, suggestions, and so forth) should be sent to me at:
<krvw@CERT.ORG>.

   Ken van Wyk

----------------------------------------------------------------------

Date:    03 Dec 92 12:25:37 +0000
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Vshield vs Virstop (PC)

as789@cleveland.Freenet.Edu (Francisco J. Diaz) writes:

> Hi All! I have a small question, Which antivirus TSR would you
> recommend me to use? Vshield or Virstop? I have seen them both but the

Well... personally I am using Guard, from Dr. Solomon's Anti-Virus
ToolKit. I used Virstop for some time, but then I switched to DR-DOS
6.0 and it seems to have problems when installed high under this
operating system... Guard has more features, but is part of a
commercial package, while Virstop comes with F-Prot - shareware (even
freeware for individual use). On the other side, Vshield's shareware
price is $25, which is a bit expensive, IMHO...

> big difference is the memory used by them...Which one has better
> performance catching viruses?

Haven't done tests of these particular programs, but when comparing
the off-line scanners (SCAN and F-Prot respectively), F-Prot catches
more viruses than SCAN (well, the difference is not that big;
something like 99% for F-Prot and 93% for SCAN, when run on our virus
collection).

BTW, one tip. The detection rate of Virstop is exactly the same as of
F-Prot in Quickscan mode - they are using the same mechanism. Maybe
I'll do tests on our virus collection with F-Prot /quick one of these
days...

> Virstop seems awfully small to have all
> those signatures inside itself, as opposed to Vshield which is big and
> (probably) has all the signatures inside. I don't have memory

:-). Well, the size of VShield doesn't necessarily come from the virus
signatures... For instance, Virstop is written in assembler, while
Vshield is in Microsoft C...

BTW, I think that there is a way to tell Vshield to use the EMS if you
have some. This is a feature that Virstop doesn't have yet. Vshield
has also some other features, like an attempt to do on-line integrity
checking, but this is not implemented well enough.

Regards,
Vesselin
- -- 
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.0 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Thu, 03 Dec 92 17:25:08 +0000
From:    jbs4930@usl.edu (Scott Jeffrey B)
Subject: Info on Music Bug virus (PC)

My 286 clone was recently infected with the 'Music Bug' virus.
Every time something was read from the hard disk, it played
a random tune.  Didn't seem to be harmful - just annoying as hell. 

I successfully removed the virus w/ CPAV software and re-installed
DOS 5.0 

I'm just curious.  Does anyone know exactly what this virus does?
Is it harmful?  Might I still have problems in the future as a result
of this virus?

Thanks for any replies
- --
Brett Scott
jbs4930@usl.edu

------------------------------

Date:    Thu, 03 Dec 92 14:36:25 -0500
From:    Jimmy Kuo <cjkuo@ccmail.norton.com>
Subject: Re: Filler virus (PC)

Shlomo Brill reports: (David Lin also reports similar circumstances.)
>        Scan 99 detected "Filler" active in the memory of my computer.
>When I booted from a write-protected floppy the nasty virus was not
>found, no matter how many times I tried.  By the way, I have CPAV
>constantly running and it did not detect anything wrong.

I've been reading in lots of places lately about Filler being detected
in memory and not being able to find it anywhere on disk.  Always, it
turns out that the user is running CPAV.  Seems a version of CPAV must
be leaving a signature of Filler in memory for everyone else to ID.

BTW, you will not (or should not  :-)  ) see this conflict with NAV.
NAV does a more sophisticated search through memory with knowledge of
where viruses store themselves.

>        Does anybody know anything about Filler ?

It is not supposed to be in the wild.

>        What can I do to get rid of the virus ?

To quote Vesselin from Virus-L Digest #175:

>teasdale@ere.umontreal.ca (Teasdale Gilles) writes:

>> I just find out that Filler virus has invaded my computer system. The
>> Scan Test (SCAN 8.9V97 - McAfee) sometime detect it and other time it
>> can't. Is there any other thing I can do to get rid of this damned
>> virus...

>This is a Hungarian boot sector virus that is not spread at all, so I
>sincerely doubt that it has made it to Canada... It is much more
>probable that you are using some other anti-virus software, like CPAV
>or TNTVIRUS, that does not encrypt its scan strings and is causing a
>false positive. If you are using CPAV, read the manual - it clearly
>says that it is not compatible with any other anti-virus software. So,
>throw away either CPAV or SCAN. If I were you, I would throw away
>CPAV...

Jimmy Kuo                                       cjkuo@ccmail.norton.com
Norton AntiVirus Research

------------------------------

Date:    02 Dec 92 21:51:56 +0000
From:    tck@fold.ucsd.edu (Kevin Marcus)
Subject: Re: Filler virus (PC)

brill@aecom.yu.edu writes:
>	Scan 99 detected "Filler" active in the memory of my computer.
>When I booted from a write-protected floppy the nasty virus was not
>found, no matter how many times I tried.  By the way, I have CPAV
>constantly running and it did not detect anything wrong.
>	Does anybody know anything about Filler ?
>	What can I do to get rid of the virus ?

When you quit a program, it is still in memory, until it's
overwritten; it's not allocated by anything.  However, it still
contains the program that was executing.  Scan may have chosen a
shoddy scan string for this virus and whatever program you were
running might have had the string in it, thus making scan think you
were indeed infected with this virus.  If you use any memory resident
AV programs, then you can also get similar problems.

------------------------------

Date:    02 Dec 92 21:49:11 +0000
From:    tck@fold.ucsd.edu (Kevin Marcus)
Subject: Re: Is this a new virus? (PC)

trinh@camins.camosun.bc.ca writes:
>One PC at our site has a strange virus and we're not sure whether
>we've got rid of it or not.  Here's what happened:
>
>- - The system hung during booting from the HD, displaying two colorful
>patterns on top of the CMOS screen.
>
>- - A clean boot from floppy would allow access to the HD as ussual.
>
>- - McAfee Scan 97 detected [Stoned] but Clean couldn't find it.
>
>- - F-prot 2.05 found Stoned and removed it.
>
>- - A second run of F-Prot found Michaengelo but unable to remove it.
>
>- - Scan also found [Mich] but also unable to clean it.
>
>- - Fdisk /mbr did get rid of the Michaengelo look alike and the system
>reboot successfully from the HD. F-Prot and Scan then gave the system
>a clean bill of virus.
>
>- - Scanning all the floppies used on this PC shown one infected with
>michaengelo, boot the system with this disk would get us back to the
>beginning.
>
>So would anyone please tell me what virus is this one, thanks.

It looks like you had a multiple infection.  Stoned and it's varients
(Michelangelo is one...) don't always copy the MBR to the same spot.
 
Let's make a scenario...:
 
Michelangelo finds it's way onto your system; your MBR at 0,0,0 is
moved to 0,0,7.  Shortly after, some copy of Stoned decides to find
its way there, too, moving 0,0,0 (which is Michelangelo) to 0,0,15.
 
Now, upon a normal boot, the sectors are executed like:
0,0,0  (Stoned)
0,0,15 (Michelangelo)
0,0,7  (Real MBR)
 
Removal of this can be funny because some varients of Stoned store
the real MBR at 0,0,7, as well as Michelangelo.  What probbaly
happened was you removed Stoned, and it took the Michelangelo sector,
tossed it onto the 0,0,0 sector, and then somewhere got confused when
it didn't find the real MBR where it thought it should be at when you
tried to remove the real mbr.  (Though I don't know why this is so,
since Mich uses sector 7, if my memory serves me right).
 
The reason FDISK /MBR worked is because it would just overwrite any
virus residing in your MBR and put a copy of the "Real MBR" there,
without tryign to read one in...

------------------------------

Date:    Fri, 04 Dec 92 19:23:40 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: Need Info about INVOLVE virus (PC)

Hi Vesselin,

bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev) writes:
>dhnguyen@vmsclst1.sc.csupomona.edu writes:
>
>> hello, I am new here. I hope someone could give me some information
>> about the INVOLVE virus.  I know that it changes the date on the files
[...deleted..]
>Hmmm... Which version of SCAN? SCAN 99 never reports such name when
>run on our virus collection. Also, no such name is listed in
>VIRLIST.TXT. On the top of that, I have never heard about a virus with
>this name... Maybe Aryeh can comment?

The Invol (Involuntary) virus is a memory-resident .EXE and .SYS file
infector about 1,400 bytes in length.  It has a little message embedded in 
it thanking users for involuntarily spreading the virus.  Please let me
know if you don't have a copy.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    Fri, 04 Dec 92 20:55:23 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: Is this a new virus? (PC)

Hello Thinh Trinh,

trinh@camins.camosun.bc.ca writes:
>One PC at our site has a strange virus and we're not sure whether
>we've got rid of it or not.  Here's what happened:
>
>- - The system hung during booting from the HD, displaying two colorful
>patterns on top of the CMOS screen.

I have a video card that displays a message and changes the colors in it
when I boot my PC (an Orchid ProDesigner SVGA card).  Was it similar to
this?  The only boot-virus that I can think of which displays graphics on
the screen in the Den Zuk virus, which displays a purple logo with the 
words "Den Zuk" when a soft boot (Ctrl-Alt-Del) is performed.  Did you
see anything like that?

>
>- - A clean boot from floppy would allow access to the HD as ussual.
>
>- - McAfee Scan 97 detected [Stoned] but Clean couldn't find it.

Where was the Stoned virus detected by SCAN V97?  In memory or the
disk?  If on disk, where did SCAN report it?  What version of CLEAN
did you use, and what options did you run it with.

>
>- - F-prot 2.05 found Stoned and removed it.
>
>- - A second run of F-Prot found Michaengelo but unable to remove it.

I think I'll let Frisk answer these :-)

>
>- - Scan also found [Mich] but also unable to clean it.

SCAN does not clean (disinfect) viruses, CLEAN-UP (CLEAN.EXE) does.  To 
remove the Michelangleo virus using CLEAN-UP, cold-boot your PC from a 
clean DOS system-bootable diskette, then run CLEAN-UP by typing 

	CLEAN C: [MICH]

and pressing Enter.  If CLEAN-UP reports that the virus can not safely
be removed, try running it with the [GENP] virus I.D. code.  This invokes
a special maintenance routine to replace the Master Boot Record code
while leaving the data--the actual partition table--intact.

>
>- - Fdisk /mbr did get rid of the Michaengelo look alike and the system
>reboot successfully from the HD. F-Prot and Scan then gave the system
>a clean bill of virus.
>
>- - Scanning all the floppies used on this PC shown one infected with
>michaengelo, boot the system with this disk would get us back to the
>beginning.
>
>So would anyone please tell me what virus is this one, thanks.
>
>(will report more behavior of this virus if noone can identify it)
>

It sounds like you may have a variant of the Michelangelo or Stoned
viruses.  I don't recognize the symptoms you mentioned, though, so
it might be something new.  Without actually looking at a copy of the
virus, it is difficult to tell, though.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    Fri, 04 Dec 92 21:05:15 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: Filler virus (PC)

Hello Shlomo Brill,

brill@aecom.yu.edu writes:
>	Scan 99 detected "Filler" active in the memory of my computer.
>When I booted from a write-protected floppy the nasty virus was not
>found, no matter how many times I tried.  By the way, I have CPAV
[...deleted...]

The Central Point Anti Virus program uses some of the same search
strings that SCAN does to detect viruses, however, the CPAV program
does not encrypt (cipher or otherwise hide) the code in memory,
causing SCAN to erroneously report a virus in memory.  Try running
SCAN without having CPAV resident in memory to see if any viruses are
reported--if none are, then this is the problem.

I had a chat with Larry Beck (my counterpart over at Central Point
Software) and he indicated that this may be fixed in CPAV Version 1.4.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    Fri, 04 Dec 92 21:15:48 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: Vshield vs Virstop (PC)

Hello Francisco J. Diaz Rivera,

as789@cleveland.Freenet.Edu (Francisco J. Diaz) writes:
>Hi All! I have a small question, Which antivirus TSR would you
>recommend me to use? Vshield or Virstop? I have seen them both but the

Isn't VIRSTOP a program by IBM for internal use by IBM employees only?

Regards,

Aryeh Goretsky
McAfee Associates Technical Support

>- -- 
>|     Francisco J. Diaz Rivera     |                           |
>|     University of Puerto Rico    | If the shoe fits, buy it! |
>|    "I hate MATH classes!" :-)    |           - Imelda Marcos |
       ^^^^^^^^^^^^^^^^^^^^
Me too.

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    Fri, 04 Dec 92 21:19:37 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: Filler Virus (PC)

Hello David Lin,

lin@ug.cs.dal.ca (David Lin) writes:
>We have a mild problem here. Scan v97b detected the [Filler] virus with
>the command line:
>	scan c: /chkhi
>The program instructed us to power down and then reboot with a floppy.

You wouldn't, by any chance, be running another anti-viral program on
your system, such as Central Point Anti Virus, would you?  There is a 
known false alarm problem between SCAN and CPAV over the Filler virus.

>We did this but then we could not detect the virus again. This of course
>meant that Clean failed.
[...deleted...]

Not neccessarily.  It could mean that you are experiencing a conflict
between 2 (or more) different anti-viral programs, in which case you should 
probably check with each company's technical support staff, to see if they
are aware of any compatibility problems.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    04 Dec 92 21:22:11 +0000
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: does McAfee SCAN remove viruses? (PC)

mrr1@Ra.MsState.Edu (mark r rauschkolb) writes:

>     I recently got version 97 of SCAN and ran it on a 386 pc.  The pc

[stuff deleted]

> Scanning for known viruses.
>   Virus removed.

> Disk A: contains 2 directories and 7 files.

>  No viruses found.

> What's going on?

You are using DOS 3.x and a buggy anti-virus program. Get version 99,
the bug is fixed there.

Regards,
Vesselin
- -- 
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.0 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    04 Dec 92 21:35:47 +0000
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Untouchable (PC)

RADAI@vms.huji.ac.il (Y. Radai) writes:

> Vesselin's report appeared), and is quite fast.  Moreover, the low
> scores of previous versions of UTSCAN in terms of percentage of
> viruses detected seems to be a thing of the past (the authors claim
> that the latest version of UTSCAN scores higher on the CARO test suite
> and disinfects more reliably than F-PROT 2.06a).  However, UTSCAN

Hmm, I would be interested to see that... Just before the three
batches of new viruses from Poland, the UK, and the USA arrived a few
days ago, F-Prot 2.06a didn't detect only half a dozen of all viruses
in our collection... And about the half of them neither Frisk, nor me
were able to replicate... The version of UTScan that we have here is
23 and it's detection rate is good enough (about 80%), but still far
from F-Prot... Version 25 (this is the latest one, right?) should have
been improved a lot...

> integrity checkers do not.  For example, even early (1988) versions of
> UT (under the name "VirAlarm") were able to detect companion viruses,
> which began to appear only in 1990 (most other integrity checkers

The first companion virus, TP_Worm, was written in Bulgaria in
mid-1989. Just felt like picking nits... :-)

Regards,
Vesselin
- -- 
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.0 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    04 Dec 92 21:45:21 +0000
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: using %VARIABLE% with scan (PC)

craig@cadzook.columbiasc.NCR.COM (Craig.Williamson) writes:

> I need to use a variable as an option with McAfee's scan.  Right now
> it doesn't work.  The variable name is not expanded.  Is there a way
> to do this?

What do you mean?? In my batch files I am using to produce the virus
naming cross-references I am routinely using things like

set scan=c:\bin\antivir\mcafee\scan
set scopts=/nomem /nopause /sub /report %report%
	:
	:
%scan% %scopts%
	:
	:

Regards,
Vesselin
- -- 
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.0 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Fri, 04 Dec 92 04:48:14 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: SCAN 99 and MtE detection (PC)

Hi Vesselin,

bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev) writes:
>As soon as the new version (99) of McAfee Associates' VIRUSCAN was
>officially available, I downloaded it directly from their anonymous
>ftp site and repeated the MtE detection tests with it. Here are the
>results.
[...deleted...]
>Anyway, I was forced to use NETSCAN during the tests. I suppose that
>SCAN has exactly the same MtE detection algorithm, but of course, have

Yes, they do contain the same detection algorithm.

>1) The standard test.
>
>Virus name:	Total samples:	Detected:	Missed:	Reliable?
>- -----------	--------------	---------	-------	---------
>CoffeeShop	    2000	2000		0	Yes
>CryptLab	    2000	2000		0	Yes
>Dedicated	    2000	2000		0	Yes
>Fear		    2000	1879		121	NO
>Groove (EXE)	    2000	2000		0	Yes
>Groove (COM)	    2000	2000		0	Yes
>Pogue		    2000	2000		0	Yes
>Questo		    1994	1852		142	NO

Why do you use different cases for "Yes" and "NO"?  

>This version of SCAN seemed to be unreliable only with Fear and
>Questo. All missed files were unencrypted. A total of 263 samples out
>of 4000 were missed. For those who like statistics, this means that

I think you mentioned this before, but I would like to repeat it
again.  Your tests do not show that an anti-viral program (any one)
does perform 100% detection of all instances of MtE-based viruses.
What the tests show is whether or not the MtE detector (which can be
an individual program, or part of an anti-viral program) detects all
MtE-based viruses from your set of infected files.  And from this one
can infer whether or not an antiviral program "reliably" detects
MtE-based virus, correct?  ("reliable" meaning all viruses in the test
set)

>the detection rate is 93.4% or that one infected file is missed in
>every 15. In fact, SCAN misses almost -all- unencrypted replicants of
>those two viruses (their number was 141 for Fear and 150 for Questo).

If the viruses are not encrypted by the MtE engine, then they will
not be detected by the MtE detection algorithm.  Instead, they will
be looked for with a virus signature (search string).

>It is still beyond my understanding why this happens - it is so simple
>to pick a scan string from the MtE body and besides, SCAN -does-
>detect the unencrypted replicants of the other viruses... Maybe
>somebody from McAfee Associates can explain what the technical problem
>is?

I am not a programmer, but I would guess that there may be a problem
with the search string used to detect the virus.  This would not, however,
be a problem with the MtE detection algorithm, though, but one of the
search strings used by SCAN (and NETSCAN) instead.

>2) The additional test.
>
>Virus name:	Total samples:	Detected:	Missed:	Reliable?
>- -----------	--------------	---------	-------	---------
>CoffeeShop	    3		3		0	Yes
>CryptLab	    1		1		0	Yes
>Dedicated	    108		108		0	Yes
>Fear		    28		25		3	NO
>Groove (EXE)	    1		1		0	Yes
>Groove (COM)	    21		21		0	Yes
>Pogue		    102		102		0	Yes
>Questo		    100		94		6	NO
>
>Clearly the same results as above. All viruses except Fear and Questo
>are detected reliably. Only unencrypted replicants of Fear and Questo
>are missed. The numbers are too small to be useful for any kind of
>statistics; they just confirm the main conclusion of the standard
>test.

Again, same conditions apply as above.

>
>3) The acid test.
>
>The program was tested against 5 replicants of Insufficient - a
>companion MtE-based virus. One of the replicants was not detected. Not
>surprisingly (after the above results), it was unencrypted.

Ditto.

>
>4) The additional acid test.
>
>Since the tests of version 97 of the product, some new MtE-based
>viruses appeared. I decided to test the new version against a few
>replicants of each of them. The test results are not of any serious
>value, since only very few replicants were used and no other scanner
>were submitted to the same tests; so these results cannot be used for
>comparison.
>
>The following new viruses were used:
>
>A) Encroacher.A, 7 replicants. SCAN detected all of them.
>
>B) Encroacher.B, 6 replicants. SCAN detected all of them.

:-)

>C) Groove.B, 11 replicants. SCAN missed one of them. However, the
>missed sample is encrypted.

Does the Groove.B virus that SCAN V99 missed use the same MtE engine
as the other viruses?

>
>When the tests were already ready and I was writing this message, one
>of McAfee Associates' programmers (Igor Grebert) contacted me and told
>me that if SCAN doesn't achieve 100% detection in my tests, I should 
>try it with the /A option.
>
>According to the documentation, the /A option means "scan all files",
>i.e., files with any extension (not only the executables). The reason
>for it is that some files with non-executable extensions (e.g. .APP)
>might be Exec'ed from an application. If a virus is active in the
>memory of the computer at that time, it may infect this file.
>Therefore, once an infection is discovered, it is a good idea to run
>SCAN with the /A option, just in case, to verify that some of your
>files with non-executable extensions are not infected...

That is in the VIRUSCAN documentation, plus there's also some mention
of the /A switch in the VIRLIST.TXT file as well.

>
>However, nowhere in the documentation it is mentioned that the /A
>option increases the ability of the scanner to find viruses in files
>with executable extensions...

It doesn't?  That can be added in the next set of .DOC files, then.
The /A switch scans all files, no matter what their extension, as
well as check more of the actual file(s) being scanned.  It is 
recommended that SCAN (and CLEAN) be run with the /A switch if a
file-infecting virus is found.

>
>Nevertheless, I re-ran the tests, this time with the /A option.
>Surprisingly, this time all infected replicants (except one) were

Unencrypted or encrypted?  Is the file damaged in any way?

>detected. My guess is that this option also forces SCAN to plainly
>scan the whole file, instead of trying to be smart, so the
>(plain-text) scan string from the MtE body is found in the unencrypted
>samples that are normally missed. I do not think that this is a
>correct behavior; there is no reason why those samples should be
>missed in "regular" mode... Coming to think about this, maybe with the

Since SCAN picks up the unencrypted viruses written using the MtE engine
when used with the /A switch, I doubt there is anything wrong with the
actual search string.  It could be (would appear, even) that the string
is not being looked for in the correct location, at least without the /A
switch.  I'll make sure that gets patched for the next release.  And 
detail the operation of the /A switch in the documentation more 
thoroughly.

>/A option SCAN will be able to detect the Commander Bomber virus
>reliably? (It is trivial to detect it, if you scan the whole file.)
>I'll have to check this...

Please do.  In the meantime, the Commander Bomber detector is on
the list of things to be looked at.

>
>Anyway, it seems that when run with the /A option, SCAN (the same goes
>for NETSCAN) -is- able to detect the -known- MtE-based viruses
>reliably. The only one missed sample was Groove.B, which McAfee

Glad to hear it. :-)

>Associates probably have not seen yet. (Not that this is a sound
>excuse; for instance, F-Prot 2.06a -did- detect it, regardless that 
>Frisk had not seen it either...)

While it may not be a "sound excuse," the fact is that it is 
moderately difficult to detect unknown viruses by scanning for 
search strings--it's not impossible, but one has to take into 
account the greater possibility of false alarms if one is looking
for "virus-like" signature strings.  This is a problem that generic
virus detectors face--how to tell whether or not a piece of code or
action is legitimate or the result of a virus.

>I would strongly advise McAfee Associates to fix the small buglet that

Small buglet logged and noted for fixing in the next release of VIRUSCAN.

>forces you to use the /A option, in order to achieve reliable
>detection of Fear and Questo. Any number of normally missed replicants
>will be made available to them on request. Meanwhile, I would advise

Igor Grebert will be at the EICAR meeting this month in Germany.  I 
assume you are going to be there as well, in which case, could
you provide Igor with a copy of the encrypted Groove.B that SCAN V99
did not pick up with the /A switch?  Thank you.

>the users of SCAN to upgrade to version 99 and if they encounter an
>infection with an MtE-based virus, to re-run SCAN with the /A option.
>(It is highly probable that even without this option, at least -some-
>replicants of the virus will be detected, so you will be warned about
>the infection.)

It's always a good idea to run SCAN and CLEAN with the /A option when
dealing with a file-infecting virus, especially if the virus is detected
in overlay files.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR

------------------------------

Date:    Fri, 04 Dec 92 04:52:07 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: ViruScan v99 and OS/2 (OS/2)

Hello Brian Hampson,

Brian_Hampson@f115.n101.z9.virnet.bad.se (Brian Hampson) writes:
>There is an apparent problem with SCAN 9.0V99 running in a DOS session
>under OS/2 using HPFS file system
[...description of problem with SCAN not running in a DOS session deleted...]

Thank you for the report.  We're looking into the problem now.  In the
meantime, you may wish to download the beta test version of SCAN for
OS/2 from the mcafee.COM site.  The program is located in the pub/beta
directory.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    Fri, 04 Dec 92 13:28:40 +0000
From:    storner@diku.dk (Henrik St|rner)
Subject: Re: Not a Stupid OS/2 Question (OS/2)

Kevin_Haney@nihcr31.bitnet writes:

>Ken De Cruyenaere asks
> >"What are people running OS/2 using/running as anti-viral
> >software?

>Speaking of native OS/2 applications, to my knowledge IBM has the only
>shipping OS/2 antiviral product available. 
[...]
>   Dr. Solomon was supposed to have an OS/2 version of his product
>available some time ago, but I don't think its seen the light of day
>yet (maybe now that they've introduced their Windows version...).

The Solomon product *is* available - I received the first version of it
almost one month ago, and an updated version just this morning.
- --
Henrik Storner (storner@olivetti.dk / storner@diku.dk)
Tech. Support
Olivetti Denmark

------------------------------

Date:    Fri, 04 Dec 92 21:25:01 +0000
From:    mcafee@netcom.com (McAfee Associates)
Subject: Re: ViruScan v99 and OS/2 (OS/2)

Hi Vesslin,

bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev) writes:
>Brian_Hampson@f115.n101.z9.virnet.bad.se (Brian Hampson) writes:
[...Brian's comments about problems with SCAN V99 running in an OS/2
VDM against HPFS partitions deleted for brevity...]

>Seems to me that by removing the "feature" that allowed SCAN 97 to
>work on networked drives, McAfee Associates have removed a bit too
>much... :-) Just kidding, of course, but those two things might be
>indeed related...

Our programmers are looking into this now and should have it fixed
shortly.  Apparently there's some kind of conflict if SCAN accesses
the boot sector of the same drive the OS/2 swap file is on while the
swap file is being accessed.

Again, we're looking into this and should know more shortly.  In the
meantime, a beta-version of SCAN for OS/2 is available by anonymous
ftp from the mcafee.COM site.  Look for it in the pub/antivirus
directory.

Regards,

Aryeh Goretsky
Technical Support

- -- 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
McAfee Associates, Inc.  | Voice (408) 988-3832 | INTERNET:
3350 Scott Blvd, Bldg 14 | FAX   (408) 970-9727 | mcafee@netcom.COM
Santa Clara, California  | BBS   (408) 988-4004 | CompuServe ID: 76702,1714
95054-3107  USA          | USR HST Courier DS   | or GO MCAFEE
Support for SENTRY/SCAN/NETSCAN/VSHIELD/CLEAN/WSCAN/NETSHIELD/TARGET/CONFIG MGR


------------------------------

Date:    Thu, 03 Dec 92 21:52:44 -0500
From:    Fritz Schneider <71043.1117@compuserve.com>
Subject: Second generation problems (Philosophy)

On Tue, 01 Dec 92, padgett@tccslr.dnet.mmc.com (A. Padgett Peterson)
wrote:

>Second generation problems are the ones that only become apparent when
>a "fix" for the first generation problem is applied e.g. Some BIOSes
>allow selection of C: as the boot drive. Sometimes you *want* to boot
>from A: (to remove disk cacheing so that disk defragmentation can take
>place) but do not want to change the CMOS & boot several times to do
>so.

...

>But it brings up a third generation problem: If this is done, is the
>original reason for selecting the C: drive in the first place negated
>since we have just reopened a window for infection OR does this
>provide an avenue for those who have not utilized the CMOS boot
>redirection because of an occasional need to boot from floppy to use
>the additional protection ?

As Padgett points out, the fact that it takes an overt action to boot
from the floppy means that the user WANTS to boot from the floppy. By
making it easier for the user to use the CMOS setting that goes
directly to C:, you are making the
"inadvertent-boot-from-an-infected-floppy" problem much less likely,
and therefore increasing security.

The idea that "friendly" code gains control from the MBR before the
floppy boot sector is given control, however, makes me greedy: What sort
of verification can be applied to the floppy boot sector before giving it
control of the machine? Could the MBR refuse to boot from a floppy whose
format is suspect? You could still force the issue by changing the CMOS
in order to boot from a new type of UNIX or some other unfamiliar system,
but maybe the "friendly" code could add one more layer of protection
against the most common boot sector infectors?

In any case, making it easier for the user to live with the CMOS set to
bypass the floppy boot is a worthwhile addition to overall security.

Fritz.

------------------------------

Date:    04 Dec 92 21:16:52 +0000
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: CHRISTMA: The "Card"!(CVP)

ISCDEC@uccvma.ucop.edu (Dennis Clouse) writes:

> >The CHRISTMA exec did NOT destroy itself after sending copies.  I
> >erased several from our users minidisks.

>  The last line of the one I got was "ERASE CHRISTMA EXEC", but that only
> removed the file saved to disk (as the exec completed it's run).
> Some users saw that line and disabled it before they ran it.
> Others received the file, but did not run it.
> In those cases, it remained on user disks.

Obviously, there have been two versions of the beast. The last four
lines of the one that we have here are (with the letter case
preserved):

	DROPBUF
	END
	end
	end

There is no ERASE command.

Regards,
Vesselin
- -- 
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.0 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Fri, 04 Dec 92 12:45:05 -0800
From:    rslade@sfu.ca
Subject: CHRISTMA EXEC Wannabes (CVP)

HISVIRL.CVP   921022
 
                      CHRISTMA EXEC Wannabes
 
The CHRISTMA EXEC was extremely prolific, not only in terms of the
number of copies produced during the 1987 infestation, but also with
respect to the number of its "descendants".  Many "worms" owe their
"spiritual" origin, at least, to this program.  The code, of course,
was widely distributed by the action of the worm itself.  Anyone who
received a copy, and who knew what it was a didn't run it, could
have kept a copy, since it carried its own source code.  (A number
of those who received it would have been able to keep copies even if
they didn't know what it was and tried to run it.  The mailings were
not confined to IBM VM systems.)  The code was also published in
Burger's first book in 1988.  (I don't know how complete his copy
was: I never did get a copy of his first book, and it is fortunately
now out of print.)
 
In October of 1988, a program called MOIN EXEC was reported to be
"loose" on the "net(s)".  Although the wording of the warning seems
to indicate a viral type of activity, the description of MOIN
appears to be more consistent with a trojan horse program.  It
purported to be a type of CHAT program and to provide the user who
ran it with an email "answering machine" capability (answering mail
while the user was away), but also allowed an outside "caller" to
submit commands to be run on the user's account.
 
The most famous network worm of recent times is, of course, the
Internet/UNIX worm created and released by Robert Tappan Morris in
November of 1988.  Although the Morris worm was considerably more
sophisticated, involved much greater coding and ran on the Internet
protocols and UNIX operating systems, a number of conceptual
features from the CHRISTMA EXEC were also found in the Morris worm. 
(I will be dealing with the Morris worm in future columns.)
 
In December of 1988, another infestation of the CHRISTMA EXEC
occurred, although with greatly reduced impact.  By this time there
were filters in place at major Bitnet backbone sites "watching" for
the CHRISTMA file, and preventing its spread.  Thus, although the
EXEC was able to post itself, on any invocation, it would tend to be
restricted in distribution to "local" sites.  One noteworthy
occurrence, though, was the fact that the operation of CHRISTMA on
this run posted itself to the GAMES-L distribution list.
 
(to be continued ...)
 
copyright Robert M. Slade, 1992   HISVIRL.CVP   921022


------------------------------

End of VIRUS-L Digest [Volume 5 Issue 197]
******************************************
