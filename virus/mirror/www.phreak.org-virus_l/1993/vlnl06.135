VIRUS-L Digest   Friday, 15 Oct 1993    Volume 6 : Issue 135

Today's Topics:

Virus Conference Procedings
Re: Please respond -- law/ethics/viruses
Parasitic?
Novell Virus (Novell)
Re: Virus scanning for Unix (UNIX)
Re: Virus scanning for UNIX (UNIX)
Re: Virus scanning for Unix (UNIX)
What is "Generic Boot" vrus (PC)
Re: A few questions... (PC)
Re: Monkey virus info request (PC)
Virus on Nov. 17?? (PC)
PD Virus Checker (PC)
Re: tsr's and messages (PC)
Re: More troble with F-prot 2.09d and FORM (PC)
Re: NAV 3.0 vs. MtE (PC)
info about ANTIX (PC)
Re: NAV 3.0 vs. MTE (PC)
Stealthed MBR, was: new variant of Stoned (PC)
Latest versions? (PC)
Re: Stoned virus , need disinfector (PC)
Re: New Variant of Stoned (PC)
Re: "Stone virus problem" (PC)
Re: Companion (or spawning) viral programs (CVP)
Re[2]: Companion (or spawning) viral programs (C
Re: Companion (or spawning) viral programs (CVP)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Wed, 13 Oct 93 17:19:18 -0400
From:    kev@inel.gov (Kevin Hemsley)
Subject: Virus Conference Procedings

I never did receive my Proceedings from the '93 Virus Conference.  Did anyone
else ever get theirs?  While I'm on the subject, are plans still proceeding
for a new conference?  Dr. Brunnstein announced something a while back.  I
just wondered if plans are still progressing.  If a location has not been
selected yet, I vote for someplace near Padgett's neighborhood. 8-)

 --
 Kevin Hemsley                             |
 Senior Engineer                           |       This space intentionally
 Idaho National Engineering Laboratory     |              left blank.
 (208) 526-9322                            |
 kev@inel.gov                              |
 KB7TYA                                    |

------------------------------

Date:    Wed, 13 Oct 93 14:50:36 +0000
From:    worden@silver.ucs.indiana.edu (elizabeth worden)
Subject: Re: Please respond -- law/ethics/viruses

SGordon@DOCKMASTER.NCSC.MIL (Sara Gordon) writes:
>These questions are being asked to help document how different people
>perceive various aspects of the virus problem. Any and all responses
>will be appreciated. It is not necessary to include any identifying
>information, but you can if you wish. Affiliation/Position would be
>appreciated, such as Virus Writer, Virus Exchange BBS Sysop, Virus
>Collector, Professor of Law, Student of Psychology, etc.
>
>I've asked these general questions before, so if you responded then, I
>would still appreciate another response now. People change their ideas
>on all of this from time to time, so I'm trying to get a current
>perspective :)
>
>Responses can be e-mailed via Fidonet 1:227/190, Internet vfr@netcom.com
>or SGordon@Dockmaster.ncsc.mil, or Virnet 9:10/0. Paper mail responses
>are also appreciated, at the address P.O. Box 11417 South Bend, Indiana
>46624. You may directly upload your answers via modem, if you wish, to
>219-273-2431; logon survey , password survey.
>
>Thank you very much for the continued assistance so many of you have
>given in the past!

Sara, It may just be my inability to read clearly, but I fail to
see in your posting any discussion of WHY you need this information,
and for WHAT PURPOSE you plan to use this information.  I suspect
that were you to specify, you would gain for your project the
legitimacy it may need in the minds of readers, and potential
respondents.

------------------------------

Date:    Wed, 13 Oct 93 14:15:51 -0400
From:    patrickp@netcom.com (Patrick Pfadenhauer)
Subject: Parasitic?

        I was looking through Patricia Hoffman's VSum, and I realized
that I had never heard the word "parasitic" used when talking about
viruses. VSum is the only place I had ever seen the word used. What
does it mean, and why does nobody else use it?
        Thanks...

- -=- Patrick Pfadenhauer -=-
    patrickp@netcom.com
    Costa Mesa, CA, USA

------------------------------

Date:    Wed, 13 Oct 93 14:16:42 -0400
From:    fzoufaly@lapa.cic.itcr.ac.cr
Subject: Novell Virus (Novell)

Hello,

I have to write a little research about virus and Novell.  I would
like to know if there are any electronically published paper that I
can get on the internet.  I know that there have been a lot of
discussion about novell virus in the forum, but at that point I was
not interested in it.  Does someone has some follow up?

I appreciate very much your cooperation.

Federico Zoufaly.

------------------------------

Date:    Mon, 04 Oct 93 13:23:26 -0000
From:    pdb@cdc.demon.co.uk (Peter Burnett)
Subject: Re: Virus scanning for Unix (UNIX)

bmok@netcom.com (Bert K. Mok) writes:

>I need to implement virus protection on our Unix machines.  Can
>someone suggest a common mechanism for doing that?  A coworker
>suggested getting a Workstation to pre-scan software of files about to
>be uploaded.  Is this a good approach?  What's the most bullet proof
>approach to doing this?  Right now our operator only scans the files
>on the PC before the upload.  I just don't think that makes sense
>because that doesn't guarantee the files don't contain "Virus for our
>HP/UX".  Please help.  Please reply by email as much as possible.

I could be interested in hearing of protection methods for Unix and
VMS machines. I have not knowledgable about this two platforms so
excuse for appearing dunb, but I have a couple of questions that
relate to these two systems ( ie, Unix and VMS boxes ).

1. How widespread are virus's on these two platforms. This includes
   real virus as well as worms and trojans ?.

2. If there is such a thing as a virus on either of these two platforms,
   where can I obtain relevant information and seek advice on a good
   preventative system.... ( E-mail will do in the first instance ).

Regards,
peter.

- --
 +----------------------------------------------------+
 | Peter Burnett                                      |
 | Computing Devices Ltd, Hastings, Uk                |
 | Tel: 44-(0)424-853481        Fax: 44-(0)424-851520 |
 +----------------------------------------------------+

------------------------------

Date:    Wed, 13 Oct 93 14:21:21 -0400
From:    cpresson@jido.b30.ingr.com (Craig Presson)
Subject: Re: Virus scanning for UNIX (UNIX)

In V6 #131, "David M. Chess" writes:
|> >From:    "Tom Zmudzinski" <zmudzint@cc.ims.disa.mil>
|> >                               UNIX is not exactly a fertile field
|> >for virus propagation (no vector for propagation beyond the local
|> >environment).
|>
|> That seems to be true at the moment; not clear how long it'll
|> remain true, though.  Distribution in binary format is
|> becoming somewhat more common, I hear, and that's one of
|> the relevant vectors.  There's no technical feature of
|> Unix and related operating systems that keeps them from
|> getting viruses; it's just cultural features (less binary
|> virus exchange, apparently less people with both a UNIX
|> system and the proper sorts of brain-damage to want to
|> spread a virus, etc).            DC

Certainly the lack of compatibility among Unix variants and the
instruction sets of the platforms they run on has afforded a lot of
protection over the years.  It's no accident that the first
widely-known if not widely-spread Unix virus attached itself to Bourne
shell scripts, as this was the LCD across all platforms. However, the
gap is narrowing -- there are enough Sun and Intel Unix machines out
there to support a modest "wild" population, surely, and Grand Unified
Unix is not far off. At latest, when shrinkwrapped Unix applications
show up at Wal-Mart, they will likely be greeted with a Unix virus
scare.

However, it's also true that the total lack of protection mechanisms
in DOS, coupled with wide use and availability of the machines, was
what made the DOS PC the only significant virus breeding ground, and
makes the prospect of virus creation on Unix and Windows NT
considerably more daunting. At the very least it cuts out lots of
marginal bad guys, for want of the higher-end hardware and time,
skill, and opportunity to study considerably more complex OSes for
holes.  ("whaddya mean I have to break superuser before I can patch
the syscall table through /dev/kmem? No fair!")

- --  ******************************************************
    ** Craig Presson              cpresson@ingr.com     **
    ** Intergraph Corporation             MS GD3005     **
    ** Huntsville, AL 35894-0001     (205) 730-3885     **
    ****************************FAX: (205) 730-3038*******

------------------------------

Date:    Tue, 12 Oct 93 11:58:21 -0000
From:    gw@startech.demon.co.uk (Greg Watson)
Subject: Re: Virus scanning for Unix (UNIX)

bontchev@news.informatik.uni-hamburg.de writes:
>What virus on Unix? A PC virus on Unix? Well, it doesn't do any
>damage, because it doesn't run - usually it can be only stored on a
>Unix machine that acts as a file server for a network of PCs. One
>exception is if you have a PC emulator on Unix - but then the virus
>can run and cause damage only within the emulated environment - and
>even then there are some restrictions.

What about booting an Intel-based UNIX machine with an infected floppy
?  If the floppy contains a boot-sector virus it will run just as it
would on a DOS PC. If it is an immediate-acting virus it can do its
damage immediately and trash the hard disk. The only chance of
catching it is to run a virus checker inside UNIX which scans the boot
sector and looks for anomalies. (Or to avoid booting with strange
floppies !!)  Such boot sector scanners are commercially available. We
have one for SCO.
- --
+------------------------------------+----------------------------------+
| Greg Watson                        |    Star Technologies (UK) Ltd    |
|                                    |   Passfield Enterprise Centre    |
| Internet : gw@startech.demon.co.uk |            Liphook               |
| Voice    : 0428 751091             |             Hants                |
| Fax      : 0428 751117             |           GU30 7SB               |
+------------------------------------+----------------------------------+

------------------------------

Date:    Mon, 11 Oct 93 19:05:46 +0000
From:    bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: What is "Generic Boot" vrus (PC)

Hello, everybody!

Since questions like "what does the Generic Boot virus do?" keep being
asked, I decided to compile a list of all boot sector viruses known to
me, which McAfee's SCAN (v108) reports as either "Generic Boot" or
"Generic MBR". (The wildcard scan string used in both cases is one and
the same, but the report depends on whether the scan string has been
detected in the DBS or in the MBR.)

The following is a list of the full standard CARO names of all viruses
reported as "Generic Boot" by SCAN 108:

Abs-3		Joshi.B 		Stoned.Duran		Stoned.Volga.A
AntiCMOS	KeyDrop.A		Stoned.Empire.Monkey.B	Stoned.Volga.B
B1		KeyDrop.B		Stoned.Face		Stoned.Volga.C
B2		Malaga			Stoned.Gullion		Stoned.Volga.D
BootEXE.451	MPHTI.A 		Stoned.HiDOS		Stoned.Volga.E
BootEXE.452	MPHTI.B 		Stoned.Leszoptad.B	Stoned.Volga.F
Brasil		MPHTI.C 		Stoned.LoveChild	Stoned.Volga.G
Crazy_Eddie	NOPs			Stoned.LZR		Stoned.Volga.H
Den_Zuko.3.D	Pilgrim 		Stoned.Manitoba 	Stoned.Volga.I
Den_Zuko.4	Revolution		Stoned.Michelangelo.H	Strange
Eko_Terror	Rm			Stoned.Murgas		Tequila
Flip.2153	Screaming_Fist.Nu-Way.A Stoned.Scale		Tiso
Flip.2365	Silly			Stoned.Spook.A		Tony_Boot.A
Gena		Smile			Stoned.Spook.B		Tony_Boot.B
Hex		Stoned.Anti-Bas 	Stoned.Standard.K	X-Boot
JKTK		Stoned.Clock		Stoned.Stonehenge

It is obvious that many completely different viruses are reported with
this name, so there's no sense to ask "what does the Genric Boot virus
do?". Several of the above viruses are multi-partite (e.g., Tequila),
and the report is about their DBS or MBR component.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sun, 10 Oct 93 18:48:10 +0000
From:    bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: A few questions... (PC)

Patrick Pfadenhauer (patrickp@netcom.com) writes:

>    Also, after D/Ling the Faerie virus, I renamed it to .CO!, then scanned it

> with SCAN.EXE. Then I fired up F-Prot to see what it would say, and it said
> that Faerie was in memory! The only three things I had done after downloading

> the virus was - PKUNZIPped it, renamed it from .COM to CO!, and scanned it
> with SCAN.EXE. Why did F-Prot find it in memory? I rebooted it, and everythin
g
> seems fine now...

This is a typical example of a ghost positive - the first scanner
reads the infected in memory, in order to scan it, and the second
scanner finds a scan string from the virus body left in memory. See
the FAQ for more information on ghost positives.

An interesting question is which scanner is guilty for that. I would
say - probably both. One basic rule when designing a scanner is that
you must keep your scan strings encrypted, otherwise other scanners
will detect them and cause false positives. Almost all scanners
(including SCAN) do that. I think, CPAV is the only exception (and
they are moving in the right direction in the latest versions).

The second basic rule when designing a scanner is that you must clean
up after yourself. That is, if you decrypt your scan strings in memory
(which is not really necessary), you must clean (fill with zeroes) the
part of memory (usually some kind of array) used to hold the decrypted
scan strings. You have also to clean (fill with zeroes) and buffers
used to read the files that are scanned. Maybe SCAN doesn't do that -
I'm not sure.

The third basic rule is that you must look for viruses in memory only
in places where they are likely to be. For instance, it's useless (and
harmful) to look for Stoned in the low memory or in the DOS buffers.
Likewise, Jerusalem will be always at addresses lower than the PSP of
your program and Tiny will always reside in the interrupt table.
Reporting the virus if you detect it at a place where it obviously
cannot be is a mistake. F-Prot makes this mistake - actually, it is
rather paranoid when scanning memory.

So, in your case the ghost positive is probably caused by the
interaction of two design flaws in the two scanners.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sun, 10 Oct 93 18:33:14 +0000
From:    bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Monkey virus info request (PC)

Markus Wischerath (mw@spinfo.uni-koeln.de) writes:

> Does it not find it or does it not properly identify it? Some weeks
> ago, we found what F-Prot 2.09 called "new variant of Stoned" on one
> of our PCs. I forwarded a copy to Frisk, but then I got curious and
> tried several other scanners available on the net, *all* of which
> identified this virus as Monkey (B), while F-Prot 2.09d still calls it
> a Stoned variant.

I just tried F-Prot 2.09f on all the sample of Stoned.Empire.Monkey.*
that I have. It correctly identified all the three samples of variant
A. It identified correctly one of the two samples of variant .B. For
the other sample it said that:

"This is not an ordinary Boot Sector.  It might contain some security
program or possibly be infected with an unknown virus.  Please contact
Frisk Software International to check if this is a known false alarm
or send us a copy for analysis."

The virus is encrypted and I guess that Frisk has some bug in the maps
for variant B.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Mon, 11 Oct 93 14:11:31 +0000
From:    worsh825@piratesarmstrong.edu (Virus)
Subject: Virus on Nov. 17?? (PC)

Does anyone know of a virus via Internet that is supposed to strike on
Nov. 17? I heard it is supposed to be a real bad one. Please send
E-Mail or reply, please. Thanks.

					-- Michael

==================

Michael A. Worsham	Worsh825@Pirates.Armstrong.EDU

Huh? What are you looking at!?! Just trying to be friendly...
Guess I can't be that anymore. Too bad. *Giggle* ;)

=================

------------------------------

Date:    Thu, 07 Oct 93 13:22:50 -0000
From:    amaynard@dust.demon.co.uk (Andrew Maynard)
Subject: PD Virus Checker (PC)

Is there any equivalent of Disinfectant 3.x (Mac) available for PC's?

Any information will be gladly recieved at Amaynard@dust.demon.co.uk
- --
Andrew Maynard

------------------------------

Date:    Tue, 12 Oct 93 12:15:51 -0400
From:    vfreak@aol.com
Subject: Re: tsr's and messages (PC)

From:    frisk@complex.is (Fridrik Skulason)
>Read the warning in the CPAV manual - they basically admit their product is
>not compatible with other anti-virus packages.   I just made one minor
>change to F-PROT - it will check for the CPAV TSR in memory, and skip the
>memory scan, and just display a warning message if it is found ....I am
>getting too tired of those false alarms.

I wish the people at CPAV would encrypt the virus signatures in VSAFE and
VWATCH.

We wouldn't be having this problem.

Last week, I was contacted by a paranoid user of Scan, and CPAV. Her computer
reportedly had the filler virus.

I drove over and removed VSAFE from the CONFIG.SYS, and naturaly the virus
was not present after re-booting the computer.

Bill

------------------------------

Date:    Tue, 12 Oct 93 13:16:26 -0400
From:    doug@viper.ELP.CWRU.Edu (Douglas Bell)
Subject: Re: More troble with F-prot 2.09d and FORM (PC)

Jim Baltaxe (maven@kauri.vuw.ac.nz) wrote:
>|At this point I decided to stop playing around and I backed up the
>|computer, repartitioned the hard drive and restored the data.  F-prot
>|still could not open the files on the hard drive if and only if I
>|booted from my clean disk.
>|
>|Can anyone help me with this one?
>|
>|p.s. I'm using MS-DOS 5.0.

>Are you sure that you are running the same version of mushDOS on the
>floppy? Earlier versions of MSDOS can have trouble with the
>modifications to the file system introduced with version 5.

This is not the problem.

------------------------------

Date:    Tue, 12 Oct 93 16:42:24 +0000
From:    bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: NAV 3.0 vs. MtE (PC)

Jeff Rice - Pomona College, Claremont, CA. (jrice@pomona.claremont.e) writes:

> 	I saw the post about NAV 2.1's hopelessness against MtE based
> viruses, but does v3.0 do any better?  I like Norton as a product, but
> I'm certainly not going to buy an upgrade for a product labeled as
> "hopeless"!

:-). Well, that label was used in my report of MtE detection tests
that we performed here. I still maintain it - the version of NAV that
we tested (2.1 with virus definitions of Decemeber 1992) -is- hopeless
in detecting the MtE-based viruses.

As soon as we get version 3.0, I'll test it and will publish the
results.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 13 Oct 93 14:26:41 -0400
From:    m-hl7341@harpo.cs.nyu.edu (Horng Li)
Subject: info about ANTIX (PC)

Hi,

Has anybody heard a PC virus called "ANTIX" ?
My friend's company got affected by this virus, sadly
on the file server of a network.  He urgently needs
help.  Any information is appreciated.

Please reply by e-mail to m-hl7341@doc.cs.nyu.edu.

Thanks,

Horng Li

------------------------------

Date:    Wed, 13 Oct 93 14:15:16 -0400
From:    "Jimmy Kuo" <cjkuo@symantec.com>
Subject: Re: NAV 3.0 vs. MTE (PC)

Jeff Rice writes:
>I saw the post about NAV 2.1's hopelessness against MtE based
>viruses, but does v3.0 do any better?  I like Norton as a product, but
>I'm certainly not going to buy an upgrade for a product labeled as
>"hopeless"!

In creating NAV 3.0, we threw away that hopeless MtE detector.  Instead,
we incorporated one of those Vesselin tested that showed 100% detection.
You can probably figure out which one since all but one was already in a
product.

Jimmy Kuo                                       cjkuo@symantec.com
Norton AntiVirus Research

------------------------------

Date:    Wed, 13 Oct 93 14:15:23 -0400
From:    "Jimmy Kuo" <cjkuo@symantec.com>
Subject: Stealthed MBR, was: new variant of Stoned (PC)

>David M. Chess writes:
>> From:    econz@vax.ox.ac.uk (Jurgen Doornik)

>> When booting from a clean floppy there is no harddisk
>> (typing "c:" gives "invalid drive"). However, when booting from an
>> infected floppy, the harddisk is present as normal.

>> How is this possible? And what is the best way to proceed?

>It means that the virus is stealthed, and the master boot
>record doesn't contain a valid partition table.  When you
>boot from an infected hard disk or diskette, the virus's
>stealth code shows everyone (including DOS) the original
>MBR, including the PT.  But when you boot clean, the virus
>MBR, with no PT, is all you can see.   Solutions:

>  - Get an anti-virus program that knows about this virus,
>    and can find and restore the original MBR (with PT),

>  - Do it yourself, by analyzing the viral MBR, finding where
>    it's stashed the original, and putting the original back
>    (or have your local guru do it).

Here's an easier way.  On the infected system, copy the MBR to a file
as a data file.  Put this file onto a diskette.  Boot up clean.  Plop
this MBR where it ought to be.

This is the only nice thing about a stealthed MBR infector.  While it's
active, the MBR "is right where it's supposed to be."  So, grab a copy of
it at that time!

Jimmy Kuo                                       cjkuo@symantec.com
Norton AntiVirus Research

------------------------------

Date:    Wed, 13 Oct 93 14:22:14 -0400
From:    mad19@keele.ac.uk (Andy Daley)
Subject: Latest versions? (PC)

Hi,

Would someone be so kind as to inform me of the up to date versions of
McAfee's scan/clean, and f-prot please.

I've been away from usenet access and ftp for a long time, and I am
wondering if I've missed any releases.

All help will be appreciated.

Thanks,
Andy.

P.S. Please reply to this newsgroup if possible, as a new machine is
being installed at Keele, and the mailer has gone skew whif.

Cheers.

------------------------------

Date:    Wed, 13 Oct 93 14:21:29 -0400
From:    mikko.hypponen@df.elma.fi
Subject: Re: Stoned virus , need disinfector (PC)

Steve Bonds (sbonds@jarthur.claremont.edu) writes about VIRSTOP:

> Under Windows, or other programs that interpret the critical
> error handler in strange ways, the warning message may cause the
> system to hang.

A quick side-note about this: the version of F-PROT Professional
that is distributed by Data Fellows works correctly also under
Microsoft Windows. If an infected floppy is used or an infected
file is executed/copied, this version of VIRSTOP will bring up a
fullscreen warning and prevent the infection.

Unfortunately this functionability is not included in the shareware
version.
- --
         Mikko Hypponen // mikko.hypponen@df.elma.fi // Finland
   Data Fellows Ltd's F-PROT Professional Support: f-prot@df.elma.fi
              PGP 2.3a public key available, ask by e-mail

------------------------------

Date:    Wed, 13 Oct 93 16:31:30 -0400
From:    "Jeff Rice - Pomona College, Claremont, CA." <jrice@pomona.claremont.e
	  du>
Subject: Re: New Variant of Stoned (PC)

bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev) writes:
>Jurgen Doornik (econz@vax.ox.ac.uk) writes:
>
>>              New Variant of Stoned
>
>> On a floppy this was removed by sys a:.
>> Naively I thought that this could be removed from the harddisk by
>> sys c:
>
>SYS will NOT remove ANY variant of Stoned from the hard disk.
>
>> and maybe fdisk /mbr (after booting from a clean floppy).
>
>As opposed to it, FDISK/MBR usually works.
>
>> When booting from a clean floppy there is no harddisk
>> (typing "c:" gives "invalid drive"). However, when booting from an
>> infected floppy, the harddisk is present as normal.
>
>> How is this possible?
>
>Simple. The virus occupies the whole MBR, overwriting the partition
>table. When the virus is active in memory, it probably stealths the
>MBR, so that DOS sees the original PT and is able to recognize the
>partitions. When you boot from a floppy, the virus is no longer
>present in memory, so DOS can't see the original PT and therefore
>recognize the logical partitions.
>
>> And what is the best way to proceed?
>
>The best way is to find a scanner that can remove this virus.
>
>Something to try is McAfee's CLEAN, used in the following way:
>
>	clean c: [genp]
>
>This is unlikely to succeed, however.
>
>Another idea is to use Norton Disk Editor (or a similar tool) when the
>machine is booted from the infected disk (and therefore the virus is
>in memory); to read Side 0, Cylinder 0, Sector 1, and to save it on a
>floppy as a file. Then boot from a non-infected write protected system
>diskette (NOT the one on which you have saved the sector as a file,
>because it is probably already infected), to start DE, read the file
>containing the sector, and write it as physical sector 0/0/1 on the
>first physical hard disk. However, this operation should be performed
>by somebody knowledgeable - if you are not completely certain about
>what you are doing in any of the above steps - don't even try it.
>
>Regards,
>Vesselin
>- --
>Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
>Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
>< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
>e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

	I had the same problem.  I copied Norton's DE and NDD from a clean
computer to a bootable disk, then booted the infected computer from that disk,
and proceded as above.  It works like a charm!  I was a bit nervous about it,
since I have never wiped out a MBR before, but this took off the virus that had
been eluding me for hours!

				Jeff

------------------------------

Date:    Tue, 12 Oct 93 10:49:30 -0400
From:    ksaj@pcscav.com (OS R & D)
Subject: Re: "Stone virus problem" (PC)

frisk@complex.is (Fridrik Skulason) writes:

>
> Please check your facts before making claims about what a particular virus
> does or doesn't do.

Obviously I should have gone further with what I was saying.  This virus
that I was referring to is not necessarily the first STONED varient
written, ie: the one you are presently referring too.  It is a virus
which scans as being the STONED virus, and for obvious reasons.

It infects drive C: as an MBR, and anthing else as a boot sector.  What
happened was we did FDISK/MBR d: or something similar.  D: has no MBR,
because it wasn't a separate drive.  FDISK wiped the partition.

And, the only reason why I posted that is because this person who I was
replying too, was suggesting that his D: partition was infected, or
something like that.

He was flamed.  I was defending.   A: B: and C: are not the only drives
which can be infected, although they are the only ones that are usefull
for that end.

End of story, I hope.

                        karsten johansson

- ---
ksaj@pcscav.com (OS R & D)
  PC Scavenger -- Computer Virus Research, Toronto CANADA (416)463-8384
  Free services: send EMAIL to info@pcscav.com or virus.list@pcscav.com

------------------------------

Date:    Wed, 13 Oct 93 14:17:08 -0400
From:    Bruce.P.Burrell@um.cc.umich.edu
Subject: Re: Companion (or spawning) viral programs (CVP)

In VIRUS-L V6 #131 Mikko Hyponnen writes:
>Robert Slade (roberts@decus.ca) writes:
>
>> Thus, under MS-DOS, no program named DIR.COM will ever be run.
>> (Alright, unless you specify the full file name.  Don't be picky.)
>
>Gotcha! Didn't test this, did you? MS-DOS parses the internal
>commands first, just as you described, but it will execute
>the internal commands even if they are entered on the command
>line with any extension whatsoever.

   I'm sure Rob can speak for himself, but I believe what he *meant*
to say was "(Alright, unless you specify the full PATH name....)"
Try, for instance, \DIR and you'll get either Bad command or file
name, or the specified .COM, .EXE, or .BAT will run (if one exists in the
specified subdirectory) instead of the internal command.

   Interesting aside: when I tried this by creating DIR.BAT, I first
tried executing it by preceding it with a blank, e.g C:\> DIR.BAT  and
much to my surprise, I got a listing of all the .BAT files.  Similarly
without the blank, so that C:\>dir.zip gives a directory listing of all
the zipfiles.  Kind of handy for lazy typists like me.  You too, perhaps.

------------------------------

Date:    Wed, 13 Oct 93 14:15:05 -0400
From:    "Jimmy Kuo" <cjkuo@symantec.com>
Subject: Re[2]: Companion (or spawning) viral programs (CVP)

Mikko Hypponen wrote:
>Robert Slade (roberts@decus.ca) writes:

>> Thus, under MS-DOS, no program named DIR.COM will ever be run.
>> (Alright, unless you specify the full file name.  Don't be picky.)

>Gotcha! Didn't test this, did you? MS-DOS parses the internal
>commands first, just as you described, but it will execute
>the internal commands even if they are entered on the command
>line with any extension whatsoever.

Mikko, you are so agressive to prove people wrong!  Anyway, Robert Slade
is correct.  "full file name" is ".\DIR.COM".  Not, as you presume,
"DIR.COM".  And if you type ".\DIR.COM" that file will run.

Jimmy Kuo                                       cjkuo@symantec.com
Norton AntiVirus Research

------------------------------

Date:    Wed, 13 Oct 93 14:21:17 -0400
From:    KDT@newton.npl.co.uk (K D TART CSU BLDG. 93)
Subject: Re: Companion (or spawning) viral programs (CVP)

> > Thus, under MS-DOS, no program named DIR.COM will ever be run.
> > (Alright, unless you specify the full file name.  Don't be picky.)
>
> Gotcha! Didn't test this, did you? MS-DOS parses the internal
> commands first, just as you described, but it will execute
> the internal commands even if they are entered on the command
> line with any extension whatsoever.
>
> So, even if you have DIR.COM in the current directory, command
> "DIR.COM" will execute the internal DIR. Same goes for EXE, BAT,
> TXT, TMP or anything else (actually it's quite strange that internal
> commands entered with a non-executable extension work).

Under MS-DOS 5, if you specify the whole path of the file,
eg C:\UTILS\DIR.COM, DIR.COM will execute, and not the internal DIR
command. I've not tested this under MS-DOS 6, though.

Kingsley.

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 135]
******************************************

