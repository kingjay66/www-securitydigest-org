VIRUS-L Digest   Wednesday, 12 May 1993    Volume 6 : Issue 78

Today's Topics:

Re: Virus in a .GIF file?
Re: YAEMA! (Yet Another Errant Magazine Article)
Write Protecting Harddrives (add on HW/SW)
Re: YAEMA! (Yet Another Errant Magazine Article)
Re: Should viral tricks be publicized?
Tremor under control (PC)
Re: Can a virus infect NOVELL? (PC)
Re: DOS 6.0 and Virus Functionality (PC)
Port Writes (PC)
NetShield (NLM) bugs? (PC)
Re: Viruses that cost $$$ (PC)
virstop and smc packet driver (PC)
Re: "DIR" infection, or "Can internal commands infect" (PC)
Re: Is "Untouchable" (V-ANALYST) Effective (PC)
Re: novi says infected, McAfee does not (PC)
Re: NAV Updates (was Central Point Anti-Virus Update (PC)
Re: novi says infected mcafee says not? (PC)
Can virus infect a hard drive that one cannot access (PC)
Generic Stealth Detector (PC)
Re: MSAV and text-files (PC)
Cure against Tremor available? (PC)
Cansu or V-Sign virus (PC)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a non-digested Usenet counterpart.
Discussions are not limited to any one hardware/software platform -
diversity is welcomed.  Contributions should be relevant, concise,
polite, etc.  (The complete set of posting guidelines is available by
FTP on cert.org or upon request.) Please sign submissions with your
real name.  Send contributions to VIRUS-L@LEHIGH.EDU.  Information on
accessing anti-virus, documentation, and back-issue archives is
distributed periodically on the list.  A FAQ (Frequently Asked
Questions) document and all of the back-issues are available by
anonymous FTP on cert.org (192.88.209.5).  Administrative mail
(comments, suggestions, and so forth) should be sent to me at:
<krvw@FIRST.ORG>.

   Ken van Wyk, krvw@first.org

----------------------------------------------------------------------

Date:    Mon, 10 May 93 16:15:04 -0400
From:    AMN@UBIK.DEMON.CO.UK
Subject: Re: Virus in a .GIF file?

David Barber, <dbarber@crash.cts.com>, wrote:

>While reading alt.supermodels (if you have to ask why, *don't)
>there was a discussion about someone finding a virus in a .GIF
>file.  ...

It is unlikely that a virus is really present in any .GIF file.

The fault is in the anti-virus software used, combined with the "examine
all files" option.  A number of poor quality (IMHO) virus 'scanners'
simply search files for short segments of each 'known' virus.  If the
product is limited to scanning executable files this may be acceptable,
as the segments can be selected for their rarity in non-infected files.

Compressed files and those containing similarly 'random' data, such as
graphics or sounds samples, can contain almost any data sequence,
(depending on the particular data storage algorithim).  It is inevitable
that some of these data files will include a segment used by such
scanners.

Reputable producers of anti-virus products are moving away from relying
on this detection method.  Either using an 'algorithmic' method of
detection, or requiring further evidence of virus infection in addition
to the presence of the virus segment.


Hope this helps,
Anthony Naggs                 Email:                  Paper mail:
 Software/Electronics Engineer amn@ubik.demon.co.uk    P O Box 1080, Peacehaven
 & Computer Virus Researcher   [or xa329@city.ac.uk]   East Sussex  BN10 8PZ
 Phone: +44 273 589701                                 Great Britain

------------------------------

Date:    Tue, 11 May 93 10:39:33 -0400
From:    frisk@complex.is (Fridrik Skulason)
Subject: Re: YAEMA! (Yet Another Errant Magazine Article)

>scanner - MSAV. Let's look carefully... It detects... ehm... 1 (one!)
>replicant of the few dozens that I have here... That much about quality...

Detection of only one replicant of a polymorphic virus can, IMHO mean one
of two things:

  1) The programmer is basically incompetent and did not realize the virus
     is polymorphic.

  2) This particular sample was included in a virus collection (such as NCSA,
     AVPD,TCESH), which was available to the author, and a signature for that
     particular sample was included to get a better score in some particular
     review which used that collection.

- -frisk

- --
Fridrik Skulason      Frisk Software International     phone: +354-1-694749
Author of F-PROT      E-mail: frisk@complex.is         fax:   +354-1-28801

------------------------------

Date:    Tue, 11 May 93 16:49:31 -0400
From:    mark@CS.MsState.EDU (Mark Rauschkolb)
Subject: Write Protecting Harddrives (add on HW/SW)

     I have been asked to investigate the "state of the art" in
write protecting old harddrives (ones without a write protect switch).

I know that a software only solution isa not perfect, but is there
something that is better than most?

I was asked specificaly about "Ironclad" - I know nothing about it
except that there is supposed to be a new version (and it is supposed
be a "harddisk writeprotection package"

Thanks
Mark

mark@cs.msstate.edu

------------------------------

Date:    Tue, 11 May 93 19:17:31 +0000
From:    bontchev@rzsun2.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: YAEMA! (Yet Another Errant Magazine Article)

Ivar Snaaijer (v922340@laqueur.si.hhs.nl) writes:

> I have heard about a hardware scanner by ESaSS for as far as i know this thing
> doesn't have mutch limitations (there must be a limit to limitations), as far
> as i know it's plug'n'play. It's said that it catches all write actions and
> BIOS redirections, and works without OS. (I'll seekout a test report i found
> somewere ...)

Do you mean ThunderByte, by chance? It is not a "hardware scanner";
it's a behavior blocker. It's not just "plug'n'play"; there are at
least two different way to install it (one of them is more secure than
the other); it uses a small TSR program for different purposes, etc.
It is, of course, better than any software-only behaviour blocker
(they are also called "monitoring programs"), but it -is- possible to
bypass it. I think that a couple of the existing viruses are able to
do that, although I have not checked with the latest version of the
product.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.2 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Wed, 12 May 93 10:55:09 -0400
From:    Y. Radai <RADAI@vms.huji.ac.il>
Subject: Re: Should viral tricks be publicized?

  Vesselin writes concerning Inbar Raz:
>Not that he
>wouldn't be able to write a virus, but this doesn't look like his
>favorite pastime. My guess is that he is interested in viruses mainly
>as a source of tricks he could use in his main areas of interest.

Maybe so, maybe not.  In any case, I never said that Inbar was a virus
writer.  In fact, the only person I know of who raised that possibili-
ty publicly was Inbar himself, when he submitted a posting with the
subject "Is Inbar Raz a virus writer?"  My main claim was that his
intention in posting his article seemed to be to *help* the virus
writers (for evidence, see below).

>Second, may I remind you that the discussed controversial article in
>40-Hex begins with the following preamble:
>
>> I picked this up in a collection of clips from the Fidonet 80xxx echo,
>> figured it might interest someone.
>>                                        --Hawkmoon
>
>That is, the article is not published there by him, it is picked by
>somebody who uses the handle "Hawkmoon" from some Fido conference.

I'm well aware of that; I mentioned it explicitly at least twice.
What are you trying to prove?

>Third, even my articles have been published in 40-Hex - without any
>permission from my side, of course. Several of them have been picked
>from Virus-L/comp.virus just like Inbar's article has been picked from
>somewhere else. Does this imply that I am a virus writer?

Of course not.  But I never said that the fact that Inbar's article
was published there implies that *he* is a virus writer!

>Fourth, I disagree that his article teaches the virus writers how to
>do something. His article mainly teaches how to try to block the
>attempts of somebody to debug or disassemble your program. This is
>mainly used for copy protection purposes, although of course is used
>both by the virus writers and the authors of anti-virus programs.

I beg to differ.  His article begins:
>                            Anti Debugging Tricks
>                                     By:
>                                  Inbar Raz
                                     .....
>Most [anti]debugging tricks, as for today, are used within viruses, in order to
>avoid dis-assembly of the virus, as it will be exampled later in this file.
>Another big part of anti debugging tricks is found with software protection
>programs, what use them in order to make the cracking of the protection
>harder.

As I read this, his primary interest is in avoiding disassembly of
viruses by AV people; copy protection comes only in second place.  But
even if we ignore the implied ranking, the very fact that he is aware
that the tricks he has published can be used to defeat AV techniques
(even if only among other things) says a lot, as far as I'm concerned.

  Let me put it this way: Would *you* think of posting an article of
the type which he wrote (which includes code) in a public forum?  More
important, would you be proud of being "ON BOTH SIDES", as Inbar
describes himself??  When you say that you're defending Inbar, is that
really the type of person or position you want to defend?

                                     Y. Radai
                                     Hebrew Univ. of Jerusalem, Israel
                                     RADAI@HUJIVMS.BITNET
                                     RADAI@VMS.HUJI.AC.IL

------------------------------

Date:    Tue, 11 May 93 08:20:26 -0400
From:    zut@rz.uni-jena.de (Udo Toedter)
Subject: Tremor under control (PC)

Hi Netter,

Last week i posted an article with the subject : Need help on Tremor.
Many thanks to all who gave me hints and information about this little bastard.
The virus is now under control.
Thanks to Pascal Pochol from lifl.fr . He wrote in some days a fine tremor clea
ner.
Udo

**************************************************************************
** zut@rz.uni-jena.de    | Udo Toedter Rechenzentrum FSU Jena (zwischen **
**                       | Nervenklinik und Friedhof ;-))))             **
** ----------------------|--------------------------------------------- **
** Immer wenn man denkt, es koennte unmoeglich noch schlechter werden,  **
** tuts genau das.      (Marvin)                                        **
**************************************************************************

------------------------------

Date:    Tue, 11 May 93 09:24:24 -0400
From:    Garry J Scobie Ext 3360 <GSCOBIE@ml0.ucs.edinburgh.ac.uk>
Subject: Re: Can a virus infect NOVELL? (PC)

> From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
>
> GSCOBIE@ml0.ucs.edinburgh.ac.uk (Garry J Scobie Ext 3360) writes:
>
> > Indeed below 3.11 all that is needed is to enable intruder detection
> > and knock.exe will lockout the account straightaway.
>
> No, it is not! Even if you enable intruder detection, it is possible
> to use the method used by the KNOCK program to crack into an account -
> and the logs show nothing! This is described in an addendum of the
> November issues of "Virus News International", I think.

You say that it is 'possible to use the method used by the KNOCK
program...' It possibly is, but that is different from using the
knock.exe program itself surely :-) However, as for 3.11, I haven't
seen knock.exe work successfully (though I have tested it out). As for
earlier versions of netware, I thought it was due to a bug that X
thousand attempts at login by supervisor would let you in with a nul
password. Surely intruder detection enabled to 1 or 2 attempts would
effectively foil this? However, if you know different I'll certainly
bear it mind :-)

> > However, accepting the supervisor issue, it is possible to infect a
> > volume where all user accounts have been set to read and filescan
> > permission only, on a 3.11 novell server?
>
> It depends... <grin> On 3.11 one could try the method used by the
> program HACK to spoof a user who is currently logged in. If this user
> has supervisor rights... well you get it.

Indeed I do :-) though I believe Novell's security patches should
help get around this - or will this depend again? :-)

> However, supposing than no user with supervisor rights is logged in,
> I cannot figure out a way to spread an infection across the user
accounts.

That's reassuring, though I'll keep watching this space...

> Regards,
> Vesselin

Cheers

Garry Scobie LAN Support Officer Edinburgh University Computing
Services Scotland e-mail:g.j.scobie@ed.ac.uk

------------------------------

Date:    Tue, 11 May 93 11:51:48 -0400
From:    padgett@tccslr.dnet.mmc.com (A. PADGETT PETERSON)
Subject: Re: DOS 6.0 and Virus Functionality (PC)

>From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)

>What actually causes troubles in DOS 5.0 loaded high is the "dirty"
>way it installs its INT 21h handler (first sets an IV handler, then
>moves itself high, then "fixes" only the segment part of the IV), and
>the fact that many offsets in the handler are different from the
>previous versions...

In defense of Microsoft (oh my), this mechanism is not really "dirty"
since the operative code is present in low memory at this point. After
the copy to high memory, all that is necessary to change is the
segment.  At no point does the handler point to anything other than
the correct handler code. The MOVS command does not delete the
original in memory unless the new location overwrites the old (then
you have to be careful 8*) which it does not in this case. At no time
does the vector point to something other than the handler.

>Well, don't forget that one of the "tools" is a disk compression
>device driver a la Stacker. This already causes a lot of mess when a
>virus is present - either the virus doesn't work properly, or damages
>the compressed volume, or other messy things... :-)

What we are finding is that the DOS 6.0 upgrade automatically loads
SMARTDRV with write-cacheing enabled if the system can support it.
This *seems* to be causing most of the problems not DBLSPACE per se.
However if you mix DBLSPACE and SMARTDRV write-cacheing it seems to be
a time bomb.  I *never* allow write-cacheing and haven't had any
problems so far.

However, I did finally receive the 11 360k disks for the XT (with new
disks 1 & 2 in almost the same post) and DBLSPACE still blows up on
installation (reboot generates "Divide Overflow" lockup - still have
not been able to reach Microsoft Technical Support but think it is
related to the fact that MSD reports 20+ MB of extended memory on the
same XT).

Also, having just tried to ressurrect a 330 MB drive that had been
DBLSPACEd, I can say that the available tools are not up to the task
(NDD 7.0 did recognize the drive and tried but locked up as did CHKDSK
and DBLSPACE /CHKDSK. The system started with the CVF error and
examination revealed a corrupt root directory, cross-linked files,
files pointing to nonexistant clusters, etc. etc. etc. All troubles
related to the compressed drive.

>Again - could please somebody who has MS-DOS 6.0 verify whether the
>FDISK/MBR trick still works? Please?

It does seem to work and the CHKDSK problem is also corrected. MOVE is
nice and MEM is now page oriented. IMHO, it is really DOS 5.1 not 6.0
but then it is obvious that the marketeers are now in control at
Microsoft.

					Warmly,
						Padgett

ps for those who persist - while the normal DBLSPACE setup makes the
uncompressed drive (original C:) H:, the "custom setup" permits drive
selection. Keep pushing the up arrow and eventually you will find that
D: is a selection option. Some disk tools do not recognise
non-contiguous drive letters.

------------------------------

Date:    Tue, 11 May 93 12:05:13 -0400
From:    padgett@tccslr.dnet.mmc.com (A. PADGETT PETERSON)
Subject: Port Writes (PC)

>From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)

>There are still a lot of MFMs around there... But you are right - a
>program that controls IDEs and SCSIs through the ports might be
>portable enough.

Vesselin as usual is correct, but you have to wonder what is the point of a
port write when a FAR CALL to the proper location will do the same thing
and is independant of drive type.

The problem a virus has is not being able to write to the disk but in
being able to spread. This requires that the virus be executed whether
as part of a program or as an intercept. If it is going to use port calls
for stealthy reasons, then it must capture the interrupt so that it knows
when to use its "stealth". This capture is detectable if a program knows
what to look for.

Therefore, IMHO it is possible to use direct port calls to bypass both
DOS and the BIOS to reach the disk provided you know what calls to use
for a particular disk but it really does not buy anything that a FAR CALL
to the BIOS cannot do. To intercept the verification for this might make
some sense but any a-v program that can check this can also check the
validity of the intercept & detect if it has already been captured -
Turing again.
					Warmly,
						Padgett

------------------------------

Date:    Tue, 11 May 93 12:22:46 -0400
From:    Sue Forslev <sforslev@well.sf.ca.us>
Subject: NetShield (NLM) bugs? (PC)

W. D. Finley writes:

>has anyone else installed the latest version of McAfee NetShield (104---150)
>on their Novell File Servers and noticed a problem with the "On-Access"
>scanning options.  I configured it with "in-coming only" on-access scanning,
>yet the display indicated all files were being scanned (out-going as well).
>Has anyone else noticed this???  Is it a bug with the NLM???

>It also appear to eat up much more utilization than the previous versions of
>NetShield.

Yes, I just installed Netshield today on one of our'ine servers and
noticed the same thing.  The server utilization isn't a problem for us
since we have plenty of excess capacity.  We have 32Mb of RAM on a
Compaq Systempro server, so I prefer this to the previous version which
would not scan on access at all.  We use Scan to check the workstation
memory on login, where even a supervisor can't contaminate the server, but
I've been worried about Jerusalem showing up after login.  This scheme
has sure killed off the Stoned and Michelangelo viruses at our site
with minimal leg work on my part, so I'm one happy customer anyway :-).

Sue Forslev (Consultant at the Illinois Dept. of Employment Security)

*************************************************************************
Newcomb's Law of the Information Center:  If you're nice to them, they'll
                 Sj                       just call back!
*************************************************************************

------------------------------

Date:    Tue, 11 May 93 12:47:27 -0400
From:    Fabio Esquivel <FESQUIVE@ucrvm2.bitnet>
Subject: Re: Viruses that cost $$$ (PC)

Hi Vesselin,
>Jeroen.Donkers@mi.rulimburg.nl writes:
>
>> I remember to have destroyed a EGA Color monitor by installing MS-DOS
>> version 4.0 on a Sperry HT (a XT from 1986). (I was able to repeat it
>> with another machine of the same type, but managed to switch it off
>> quick enough...)
>
>No, the example you gave means only that hardware can be really buggy
>- - just like software... :-)
>
>I've seen several other messages of the form "once something like that
>happened to me" or "I've been told that it's possible to do it that
>way". Sorry, but I don't believe that. Just as I don't believe that a
>particular virus exists until I have a copy of it, I won't believe
>that it is possible to destroy hardware (I mean a contemporary,
>working hardware, not ancient buggy one) in software. If anybody wants
>to convince me in the opposite, they must send me a particular program
>that does it. We have enough test systems here, so we'll be able to
>try it. Until I see such a program (and that it actually works), I'll
>continue to claim that hardware damage in software is not possible.

I wrote a little assembly routine some time ago that switched the
monitor from text mode to graphics mode and switch back to text mode
in a very fast loop with CX = 0FFFFh.  Some monitors support such a
quality proof, but some others not.  Those of less quality will
eventually burn out.

The program is very little and if you are interested I can send you it
via e-mail, but it is as simple as you imagine and maybe you can
program it.

Hope your monitors support fast graphic-text switching 8^),
;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Data SEGMENT PARA PUBLIC
      name DB 'Fabio Esquivel Chacon'    ; That's me... 8^)
       job DB 'Computer Science student' ; But I'll graduate soon
      site DB 'University of Costa Rica' ;
    bitnet DB 'fesquive@ucrvm2.bitnet'   ; Office hours, please.
  internet DB 'fesquive@ucrvm2.ucr.cr'   ;
Data ENDS


------------------------------

Date:    Tue, 11 May 93 13:02:49 -0400
From:    Gene Shackmanb <GS6206@UACSC2.ALBANY.EDU>
Subject: virstop and smc packet driver (PC)

Hello,

  I have a problem with virstop, from f-prot 2.08, and SMC's
8003 packet driver.
  I load Virstop and 8003pkdr in autoexec.bat, in a student
users lab.  All programs are accessed through a menu, automenu
47, and when students go to use a program, they must have
a disk in either drive a: or b:.  We then have f-prot check
the disks for virus's, before starting any program, using a
command line of: f-prot a: (or f-prot b:).  This worked fine
until I upgraded to f-prot 2.08.  What happens now is that
f-prot loads, and then cannot read the disk.  I get a
message

Error: disk error on drive a:
enter - retry     esc - abort

  If I take virstop out of the autoexec.bat, or use the version
that came with f-prot 2.07, we have no problem and the disks
are scanned successfully.
  Has anyone seen this, or have any suggestions?
  Thanks in advance.

   Gene Shackman
   Computer Consultant
   College of Social and Behavioral Sciences
   SUNY-Albany

------------------------------

Date:    Tue, 11 May 93 19:09:07 +0000
From:    bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: "DIR" infection, or "Can internal commands infect" (PC)

Amir Netiv (Amir_Netiv@f120.n9721.z9.virnet.bad.se) writes:

> Yeh, like any other program theat does something before it
> runs (SMARTDRV for example will do several things before a program you've
> called is loaded) but the result is the same.

I don't see how this is relevant to our argument. Besides, no program
does ANYTHING before it runs - not even SMARTDRV.

> >From most common user's point of view the PC operation is transparent, and
> when he is executing commands (or maybe
> selecting options from a menu) Its the same thing for him.

Well, there are even users who don't know what "DIR" is - they are
running pre-installed menu systems... Uh, did I hear somebody saying
"Windows"? :-) However, the fact that something looks in some way for
such users does not make it true. For instance, Joshi can fool the
unsuspecting user and remain active even after a Ctrl-Alt-Del - does
this mean that surviving warm reboot is possible in general? No, of
course. The EXE_Bug virus even seems to survive a "cold" reboot - so
what? On the other side, for the class of users mentioned above, a
blank formatted floppy cannot be a source of infection - after all, it
contains no files, right? Whaddya mean if I boot from it - I told you
it has no DOS on it... :-))

We must -educate- such users by stating the things exactly as they are
- - not by spreading rumors for programs damaging the hardware, viruses
surviving the reboot, getting infected by a DIR, printer viruses,
etc.

> Do you know how common is the question: "Can a write
> protected floppy be infected ?"

Yes, I do. (Why is it not in the FAQ, BTW? Maybe we've thought that
the answer is so well known that there's no need to include this
question... Maybe we should re-consider...)

> what do you think ?

That it cannot, of course. And don't tell me about old drives, faulty
controllers, weird write-protection tabs, light-colored diskettes,
malicious users plugging the hole of the 3.5" diskettes or doctoring
their drives to write to write protected floppies, etc. - I know all
that too. It all goes with the detailled answer of the question. But
an answer like "sometimes viruses are able to infect write-protected
floppies" is NOT a valid answer, because it only spreads a false
rumor.

> What's important is the result. If a theoretical possibility of doing
> something that might be interperted as a simple DIR by a user exists, some
> users will cosider it so.

Yes, that is exactly why it is necessary to educate them, explain them
what DIR does, what their system does, that DIR cannot cause the
infection of a clean system, but some other things (running external
programs, shelling to DOS, etc.) can, tell them about the ghost
positives, etc. Telling them "Sometimes you -can- catch a virus by
simply doing a DIR on an infected floppy" is doing them a disservice,
IMHO.

So, would you agree with the following addition to the FAQ:

Q: Is it possible to infect a virus-free computer by just executing
the DIR command on an infected diskette?

A: The only way to infect a computer with a virus is to execute
(transfer control to) the virus code. The DIR command reads various
parts of the disk(ette)s, but does not execute anything. Therefore, it
is not possible to catch a virus by simply doing a DIR on an infected
diskette. There are a few caveats, however.

First, some systems have a special device driver loaded. This driver
is called ANSI.SYS and its purpose is to provide ANSI terminal like
compatibility. Unfortunately, one of its features is that it allows
the keys of the keyboard to be reprogramed by sending special codes
("escape sequences") to the screen. These codes can be contained in a
text file - simply displaying the contents of this file will cause one
or more keys to be reprogrammed.

It is possible to create a diskette, the directory of which contains
files with "names" that consist of such escape sequences. Executing
DIR on such a diskette will cause the contents of its directory to be
displayed, and therefore one or more keys to be reprogrammed. The
result could be that the next time you press one of those keys, you
could get unexpected results - files deleted, some program from the
diskette executed, etc. Since this could result in execution of an
external code, it means that it is (theoretically) possible to catch a
virus this way.

The solution is to disable the ANSI.SYS driver completely, or at
least its keyboard programming capability. There are several free
programs that allow you to do this (PKSFANSI is one of them). As an
alternative, you could use a different ANSI dirver instead of the one
that comes with DOS - and select one that does not have the keyboard
reprogrammability feature or that at least has means to disable it.

Second, while the DIR command alone will not execute any external
code, for many users it is equivalent to "display the contents of a
particular directory". Unfortunately, some sites might have installed
more elaborated front-ends of DOS - shell programs which provide an
easy and convenient way to use the services of the operating system.
In particular, the function "display the contents of a directory" of
such systems might be implemented in a complex way and might not be a
simple DIR. It may load new copies of the command interpreter, execute
external programs, etc. All these actions involve the execution of
external code, which in some cases may cause a virus to be executed.

Finally, the DIR command causes various parts of the examined disk(s)
to be read in memory, and in particular - the boot sector. If this
boot sector contains a virus, the virus code will be read in memory -
but will remain inactive, since control is never passed to it.
However, if the user now executes a scanner which plainly scans the
whole memory for some virus scan strings, it may detect the virus
code. If the scanner is not intelligent enough to figure out that this
particular boot sector virus just cannot reside at that place of
memory and be active, then it will incorrectly report that there is an
active virus in the computer's memory. This is often called a "ghost
positive alert" or simply a "ghost positive", see question C8. It DOES
NOT mean that the computer is really infected.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.2 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Tue, 11 May 93 19:13:18 +0000
From:    bontchev@news.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Is "Untouchable" (V-ANALYST) Effective (PC)

Schwartz Gabriel (Schwartz_Gabriel@f101.n9721.z9.virnet.bad.se) writes:

> BTW: V-Analyst isn't as good as you mentioned it. It can't find lots of
> known viruses....

You obviously mean the -scanner- part of the V-Analyst package. First,
the scanner has been improved a lot recently. Second, the scanner is
only a part of the package, and not the most important part. The
really strong part of Untouchable/V-Analyst is its integrity checker.
Do you know many viruses that the integrity checker will not be able
to detect? I know a few (they will be probably caught by the scanner,
but this is irrelevant), but they have great difficulties to spread in
the first place.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.2 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Tue, 11 May 93 15:50:34 -0400
From:    cjkuo@symantec.com (Jimmy Kuo)
Subject: Re: novi says infected, McAfee does not (PC)

Michael Bannister writes:
>I just installed Borland's Turbo C++ for Windows.  Went Novi runs it
>says the C++ exe file is infected with Plastique.  It can not remove
>it.  Howerver Mcafee's scan does not detect the virus.  Not
>surprisingly, clean won't remove the virus.  Vsum says that both Novi
>and Scan will detect Plastique.

>Could someone enlighten me about what this means and what I should do.

This is a false id.  I will contact you directly.
Jimmy Kuo					cjkuo@symantec.com
Norton AntiVirus Research

------------------------------

Date:    Tue, 11 May 93 19:29:51 +0000
From:    bontchev@rzsun2.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: NAV Updates (was Central Point Anti-Virus Updates) (PC)

Yi Hong (yh1@Isis.MsState.Edu) writes:

> 	I wonder what is the best anti-virus scanner/remover/shield
> package.

FAQ, question D1. In short, the answer is: none.

> I have f-prot and mcafee's scan/vshield/clean, but I wonder
> which is better

Define what do you mean by "better". By my definition (detects more
viruses, smaller, faster, better virus identification, better virus
removal, better virus classification, better user interface), F-Prot
is "better". However, I am not able to load the resident scanner
(VirStop) high under DR-DOS 6.0 and this might be critical in your
case; I don't know.

> or newer

Huh? Both are updated monthly.

> or have more virus database.  One of my

F-Prot detects slightly more viruses that the SCAN suite, but the
difference is insignificant to the general user. When run on our virus
collection, F-Prot usually scores about 98-99%, while SCAN scores
90-92%. The difference may be caused by the fact the the author of
F-Prot has access to the viruses that we have.

> friend also have NAV, and I don't know much about it.  CAn you

Again, it depends on what you are interested in. NAV has a
significantly lower virus detection rate when compared with F-Prot
(something about 70%; don't have recent results). On the other side,
NAV has features that the shareware version of F-Prot lacks, for
instance, integrity checking.

> guys tell me about the best or some of the best anti-virus software
> avaliable by 1. shareware 2. commercial software,etc.

Again, it depends on what you need. Please, read the FAQ.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.2 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Tue, 11 May 93 19:33:59 +0000
From:    bontchev@rzsun2.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: novi says infected mcafee says not? (PC)

Michael Bannister (lyaa270@emx.cc.utexas.edu) writes:

> I just installed Borland's Turbo C++ for Windows.  Went Novi runs it
> says the C++ exe file is infected with Plastique.  It can not remove
> it.  Howerver Mcafee's scan does not detect the virus.  Not

In my tests SCAN was able to detect Plastique (actually, all
Jerusalem.AntiCAD.* variants, to be exact) reliably. I don't have
Novi, but it is quite possible that it is a false positive. I suggest
you to contact your local Symantec technical support.

> surprisingly, clean won't remove the virus.  Vsum says that both Novi
> and Scan will detect Plastique.

Well, it doesn't say that any of the products does not detect as
viruses programs that are not, does it? Yeah, false positives can be
annying...

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.2 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany

------------------------------

Date:    Tue, 11 May 93 20:17:03 -0400
From:    yh1@Isis.MsState.Edu (Yi Hong)
Subject: Can virus infect a hard drive that one cannot access? (PC)

	If I had a hard drive in my computer, but I reconfigured
the ROM set up and put that there is no hard drive, and i boot
from a floppy, so that i won't be able to access the C: drive.
Can a virus affect the C: drive if there is no partition to link
to it?  I don't think so, but I am justing trying to make sure..

------------------------------

Date:    Wed, 12 May 93 05:12:56 -0400
From:    trimm@netcom.com (Trimm Industries)
Subject: Generic Stealth Detector (PC)

Generic Steath Detector
Pseudocode Summary
Gary M. Watson
FWIW, donated to the public domain.
3 May 1993  version

Summary: a typical stealth virus, if present and active in RAM, atttempts
to evade detection by av software by intercepting int 21 or int 13 file
open or block read services, and presenting the requestor with the simulated
image of an uninfected file or block.  The routine proposed below attempts
to take advantage of this fact to expose the virus.  The method used
involves comparing the results of obtaining the physical disk image
of an item on disk (by directly manipulating the hardware ports on the
disk controller to force block reads into the av program's private
buffer), with the (possibly tainted) results obtained by int 13 and int
21 calls to bios and dos respectively.  Any difference reveals some kind
of data translation, which must be accounted for.  Differences could be
caused by mapping software, Stacker, Double Disk, Dos 6 compression, or
other non-malicious software, but these cases can be compensated for.
Any remaining translation is therefore suspicious and merits further
study.

Method:

1. Save timer int vect, change to our code, mask all other interrupts, count
ticks within our program (we will update bios when we are done)

2. Verify program integrity.  Check to see if disk controller is compatible
with WD 1003 style command set.  If not, see if any special disk hw
handling drivers are available (e.g. SCSI etc)

3. Set standard video mode, clear screen, put up title with users name
obtained when s/w was ordered (prevents spoofing attacks)

4. Set kbd int to our handler, unmask this interrupt

5. Ask user which physical disks to check

6. For each block on the disk:

	a) do int 13 read into buffer 'x'
	b) do secure block read into buffer 'y' (secure
	   read is defined later in this document)
	c) do another int 13 read into buffer 'z'
	d) if x=y=z then ok, else, print error info
	   or attempt to use special code to interpret
	   Stacker, Dos 6, or Double Disk partn

7. If step 6 went ok, then inform user that no int 13 level
translation or stealth virus was present

8. For each file on disk:

	a) do secure file read of fat, directory, and file into buff 'x'
	b) do int 21 read of file into buffer 'y'
	c) do secure read of file into buffer 'z'
	d) if x=y=z then all is well, else stealth virus or
	   fast infector is present, in which case side by side
	   comparison of x, y and z will yield the virus object code

9. If step 8 went ok, then tell user all is well, option to test
more stuff, or restore video, interrupts, vectors, see how
many timer ticks have happened and update bios accordingly, and
exit.

Secure Sector Read:

1. Be sure IRQ for disk is disabled

2. Load up disk controller regs @ 1f0 thru 1f8 with cyl, track,
sector, per IDE (ATA) ANSI spec or WD1003 spec, then load up pc's
dma controller with memory buffer address, then fire off read using
disk controller command register.

3. Either user dma as indicated, or use pio to handshake bytes out
of the disk controller.  Poll disk done status, as interrupts are
disabled.


Secure File Read:

1. Use Secure Sector Read to find FAT, to find Directory Entry, and
finally to find the file data itself.  Do not use any dos or bios
calls.


As noted earlier, disk compression programs will prevent the
simple-minded approach above from working.  I would suggest that
someone considering writing a program to do what I described
contact the authors of these compression programs and ask them
to compile for you read-only versions of their programs that
use your secure block read routine instead of INT 13h.  For
experimental purposes, it might be possible simply to hack
their disk driver, and include it within your anti-virus program.


The ANSI X3T9.2 AT-Attach (ATA or sometimes called IDE)
specification is available from the NCR SCSI BBS, sysop's
name is John Lohmeyer, chairman of X3T9.2 (sometimes simply
called the SCSI committee, but they do more than just SCSI.)
SnailMail or NetMail me if you need to get this file.  I'll be
happy to ftp it (~120K) to anyone who wants it.

Gary M. Watson
Trimm Industries
North Hollywood, CA
internet: trimm@netcom.com
fido 1:202/204 Programmers Workshop

------------------------------

Date:    Wed, 12 May 93 07:06:13 -0400
From:    David_Conrad@MTS.cc.Wayne.edu
Subject: Re: MSAV and text-files (PC)

In VIRUS-L v6i75 frisk@complex.is (Fridrik Skulason) writes:
>v922340@herzberg.si.hhs.nl (Ivar Snaaijer) writes:
>>an other thin about MS (CP) AV is that it default scans ALL files on disk.
>>(this takes a lot of time on a 213Mb HDD). Is this realy neccesery or
>>is huristic scanning stupid ? ....
>
>Uh, I don't understand what you mean...CPAV/MSAV does not do any heuristic
>scanning at all.

I think what is meant is scanning only executables.  Selecting only
executable files is smarter than scanning them all, and Ivar is correct
in calling it 'heuristic', but this is not what is generally meant by
'heuristic' scanning, hence Frisk's confusion.

So Ivar's question (I think) becomes, "Is scanning all files really
necessary, that is, is heuristic selection of files to scan stupid?"

I'll leave the question of whether something can be both "heuristic" and
"stupid" to the pedants, and simply recite the conventional wisdom:

Scanning only executables is fine, and yields a performance win, but
you may want to scan all files after a virus has been detected in an
executable.

>One note about MSAV - The May 93 Virus Bulletin just reviewed it - and one
>interesting observation is that it performed much worse than the CPAV scanner
>which was tested in January - missed more than twice as many viruses from
>the "small" set.

Ha!  This surprises me not at all.  Thank Frisk for F-Prot!

David R. Conrad        "No his mind is not for rent/To any god or government"
dave@michigan.com      "Non sunt multiplicanda entia sine necesitatum."
David_Conrad@mts.cc.wayne.edu      -- Rush and William of Ockham, resp.

------------------------------

Date:    Wed, 12 May 93 07:48:27 -0400
From:    "Dr. Martin Erdelen" <HRZ090@VM.HRZ.UNI-ESSEN.DE>
Subject: Cure against Tremor available? (PC)

Hello,
is there any new development re: disinfection of the Tremor virus? Are
there antiviral programs by now which can handle this beast?
Thanks for any info.
MArtin
    (~  , ,
   (___/__/__-_
Dr. Martin Erdelen     EARN/BITNET: HRZ090@DE0HRZ1A.BITNET
- -Computing Centre-        Internet: erdelen at hrz.uni-essen.de
University of Essen           Tel.: +49 201 183-2998
 Schuetzenbahn 70              FAX: +49 201 183-3960
  D-4300 Essen 1            Binary: .  .-.  -..  .  .-..  .  --      (~~
      Germany                                                    (()~~
+-----------------------+    Smoke:       ())))   ((()))~~~ ())~~~
|      Remarkably       |               ())))) ~~~
|      remarkless       |        (())()~(())())
|         room          |     (())())
+-----------------------+   ((()()())))

------------------------------

Date:    Wed, 12 May 93 09:58:09 -0400
From:    (georgia deakin) <gj9@prism.gatech.edu>
Subject: Cansu or V-Sign virus (PC)

We have a computer here that was giving us problems and I suspected a
virus.  I checked the computer with F-Prot 2.08a and got a message
that the boot sector was infected with the V-Sign virus.  F-prot could
not disinfect the virus, so I ran McAfee.  McAfee detected the Cansu
virus.  I think McAfee finally cleaned the virus, but I am trying to
find out anything I can about either or both of these viruses.  Did I
have both or just one?  What do they do and where did they come from?
Any information I can get will be greatly appreciated.

BTW, thanks to all who responded to my previous problem with Stoned
and F-Prot.  Thanks also to Frisk, who has fixed my problem by
releasing an updated version.

Georgia Deakin
Director of Technology Training and Services
Georgia Tech Alumni Association
853-0751

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 78]
*****************************************

