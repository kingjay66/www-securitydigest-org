VIRUS-L Digest   Tuesday,  9 Nov 1993    Volume 6 : Issue 145

Today's Topics:

Re: Draft Swiss AntiVirus regulation
Re: Draft Swiss AntiVirus regulation
Re: Virus scanning for UNIX (UNIX)
Advice sought re scanning procedures (PC)
Re: FORM virus--IBM (PC)
Re: Rosenthal again.. (PC)
Re: of interest (PC)
*HELP*--Possible Virus? (PC)
Re: Rosenthal again.. (PC)
Re: Rosenthal again.. (PC)
Re: Filler Virus (PC)
Re: Removing Boot Sector Virus from Floppies (PC)
Re: How to clean Empire.Monkey.B (PC)
Re: New stoned? (PC)
Re: FORM virus--IBM (PC)
Re: S-Bug again (was Virus Alert) (PC)_
Day of the week program (PC)
Re:Why should a scanner HAVE to open a file? (PC)
Re: FORM virus on IBM PC (PC)
Re: Information requested on "youth" virus on MS-DOS machines (PC)
Re: Commercial Virus Scanners in the dark??? (PC)
Re: Removing Boot Sector Virus from Floppies (PC)
NAV updates available via ftp (PC)
The price is right (CVP)
1.1 - Power (CVP)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Fri, 05 Nov 93 07:02:00 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Draft Swiss AntiVirus regulation

Fernando Bonsembiante (fernando@ubik.satlink.net) writes:

>     To quote Mark Ludwig, we can use computer viruses to do research
> about artificial life.

It seems to me that Mr. Mark Ludwig has no real idea of what
"artificial life" is. The "organizms" in those experiments exist in a
very restricted emulated environment and have nothing to do with the
real viruses that infect real programs. Everybody is welcome to do
such experiments in such restricted environments. It's writing viruses
for the real computers that we label as malicious, unethical, and
criminal.

>     Ok, but a virus author may argue he wrote his virus only for
> investigation purposes, and it escaped... So "intent" isn't enough...

In such cases the author could be prosecuted for criminal negligeance
- - for letting his "creature" escape.

Look, here is an analogy that Dr. Alan Solomon told me once. Suppose I
want to keep a pet tiger. I consider myself knwoledgeable enough to
handle it, keep it strictly in my house and all that. Should I be
forbidden to do it? Of course not (ignore for a moment the more
delicate issues of protected species, etc.). However, suppose that one
day the tiger escapes and causes some damage. For instance, eats my
neiborgh's mother-in-law. (Hmm, is this a damage or a favor? <grin>)
Is it my fault and should I be hold responsible for it? Of course!

I don't think that virus creation should be forbidden per se. But I do
think that if a virus is found somewhere where it is unwanted, the
author of the virus should share the responsability, even if he has
not introduced the virus into that system.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 14:21:44 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Draft Swiss AntiVirus regulation

Fernando Bonsembiante <fernando@ubik.satlink.net> wrote:
>Martes 26 de Octubre de 1993, Vesselin Bontchev writes to All:
>
>    That's what we must care, if the law is too restrictive it can
>even make A-V investigation illegal... I't would be funny if all
>anti-virus researchers have to go underground, it wolud be no
>difference between an anti virus researcher and a virus author... Not
>to mention we should find another work :-)

I don't think that would be very funny.

Have you ever heard of something called, "ethics" or "morals"?  I don't
think that there would, "be no difference".

>
> >> The point is: what is the difference betwen Microsoft for making
> >> format.com and Dark Avenger for making his viruses? We should take
>
> VB> The main difference is intent, IMHO.
>
>    Ok, but a virus author may argue he wrote his virus only for
>investigation purposes, and it escaped... So "intent" isn't enough...
>

This is why most AV people advocate there is no such thing as a good
virus, and that to write a virus, no matter what you say it's for,
you have malicious intent.  The current idea is to label the definition
of a virus as malignant programs, so that the intent can get ruled out.
(IMHO)

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Thu, 04 Nov 93 20:42:13 -0500
From:    valdis@black-ice.cc.vt.edu (Valdis Kletnieks)
Subject: Re: Virus scanning for UNIX (UNIX)

gmckee@cloudnine.com (Gary McKee) writes:
>In any event, if you have access to a UNIX machine, you probably are
>too busy doing something interesting to have time for virus writing.

In my personal opinion, the only reason we haven't seen more Unix
viruses is because those anti-social people who have access to Unix
systems have been writing *other* varieties of malware (such as
the ISS package posted recently, the regrettable incident at a
certain public-access Unix site with a packet sniffer, and so on).

If all the people who are currently out there poking at Sendmail
holes decided to write viruses for Unix systems, we're all going
to be in a *lot* of trouble...

Be Afraid. Be Very Afraid. ;)

				Valdis Kletnieks
				Computer Systems Engineer
				Virginia Tech

------------------------------

Date:    Thu, 04 Nov 93 20:01:34 -0500
From:    bmorris@netcom.com (Bob MorrisG)
Subject: Advice sought re scanning procedures (PC)

Would it be reasonable to assume that weekly use of SCAN and F-PROT, plus
NAV ( resident, with executables scanned ) would be a generally safe way
to avoid most detectable viruses?

Are there any major gaps/holes in the above?  Any advice?  Any FAQs I
could be directed to?

I'm not trying to start a Holy War, but am interested in what you
obvious professionals here think would be the best lines of defense
against viruses on PCs.

Is there any way to protect against new strains?  What got me thinking
about that was learning that a BBS I know of, run by seasoned pros who
were taking lots of protections, just got clobbered by a new strain that,
apparently, even the researchers hadn't seen yet...  The BBS recovered
quickly, something I suspect the normal user would not be able to do.

------------------------------

Date:    Fri, 05 Nov 93 02:16:27 -0500
From:    seto@rop2.hitachi-cable.co.jp (Koichiro Seto)
Subject: Re: FORM virus--IBM (PC)

c2mxcla@fre.fsu.umd.edu (John M. Clark) writes:
>  The IBM lab in my school has recently been plagued by a virus identified by
>the student newspaper as "FORM."
>   Does anyone have any information on this virus?

We had the same virus.  Please post to this news group.  I too would
like to know about it.  Thank you.

seto
seto@show.rop2.hitachi-cable.co.jp

------------------------------

Date:    Fri, 05 Nov 93 02:47:47 -0500
From:    frisk@complex.is (Fridrik Skulason)
Subject: Re: Rosenthal again.. (PC)

datadec@ucrengr.ucr.edu (kevin marcus) writes:

>Fridrik Skulason <frisk@complex.is> wrote:
>>Well - I received 280 brand new viruses recently - every single one which
>>had been patched to avoid being detected by a particular set of search
>>strings that had been "published".
>>
>>That is common enough for me......

>I find that very hard to believe.

Believe whatever you want, but accusing me of lying does not exactly make me
want to take you seriously.

>Do you have every published string
>memorized?  As soon as you see a new virus, you can immediately know if
>it was an attempt to avoid a string?  I don't think you would have checked
>each one as soon as you got it.

I never said I had checked every single one - I said they had all been
modified to avoid a particular scanner.  The reason is simple - that scanner
(let's call it "Scanner X") did not detect a single one of them, but several
other scanners detected the vast majority of the viruses.   I don't need
no know which signatures scanner X uses - I could find out (I guess), but
as it detects the original viruses, and not the modified ones, and no other
scanner fails in the same way, it is pretty obvious that the viruses - all 280
of them - were modified by pathing the area containing the signature used
by scanner X.

- -frisk

------------------------------

Date:    Fri, 05 Nov 93 02:51:31 -0500
From:    frisk@complex.is (Fridrik Skulason)
Subject: Re: of interest (PC)

bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev) writes:

>TBAV has -many- things that F-Prot doesn't have.

Eh...that only applies to the shareware version.  The "Pro" version includes
an off-line integrity checker, a resident integrity checker and a generic
disinfector.

- -frisk

------------------------------

Date:    Fri, 05 Nov 93 04:05:17 -0500
From:    marc.tolbert@tfd.coplex.com (Marc Tolbert)
Subject: *HELP*--Possible Virus? (PC)

I would agree that the problem is either a bad bios or a flaky power
supply.  If the post check will happen even without a hard or floppy
drive attached.  The 2-3 seconds of hard drive access you hear when
powering up are the power up sequences for the hard drive and are
normal.

If you are having problems with the hard drive,  it could be that you
are not giving the post enough time to come up with a hard drive error.
The hard drive error can take a few minutes to come up even on some of
the fastest machines.

You mighy try TBAV or F-Prot for scanning.  They tend to be more
reliable and better behaved than CPAV and MSAV - basically the same
engines.  I am not familiar with Hydro.  Can you post information on
this program?

Marc Tolbert
Director of Virus Research
H.I. Industries

------------------------------

Date:    Fri, 05 Nov 93 06:23:19 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Rosenthal again.. (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> Fridrik Skulason <frisk@complex.is> wrote:
> >Well - I received 280 brand new viruses recently - every single one which
> >had been patched to avoid being detected by a particular set of search
> >strings that had been "published".

> I find that very hard to believe.

I can confirm it, if you believe me more... :-) I have seen the
collection in question.

> Do you have every published string
> memorized?

Note that Frisk said "to avoid being detected by a PARTICULAR set of
search strings". He meant the scan strings used in a particular, very
popular scanner, that have been "published" in an underground
magazine.

> As soon as you see a new virus, you can immediately know if
> it was an attempt to avoid a string?  I don't think you would have checked
> each one as soon as you got it.

> How recently is that?

Simple. When the scanner in question is run on the collection, it
detects NONE of the viruses in it. Almost every other scanner tried
detects most of the viruses or says that they are new variants. The
conclusions are obvious.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 06:34:02 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Rosenthal again.. (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> against all AV products.  Most Virus people, I would speculate, realize
> SCAN is not on the cutting edge of technology or virus detection/removal.
> Take a looksee through some viruses for the text strings!  You will
> see all sorts of rude messages based towards SCAN, or towards McAfee
> in general.

Oh, those attacks are mostly because the product is so popular and
widespread. In the future we'll see probably the same kind and amount
of attacks against MSAV...

> I would imagine quite a few more than you would see with your name in
> it, or Frisks, or Alan, or anyone.

As a matter of fact, I don't recall to have seen Frisk's name in a
virus. Maybe the virus writers respect him more, because he offers an
excellent product essentially for free... :-)

> This is because there is a large percentage of people who use (or,
> at least did) use SCAN for their system.

Yes, I think that this is the main reason; not the bad quality of SCAN
(there are anti-virus products that are significantly worse).

> They feel that if they can keep a virus from being detected by SCAN,
> that most people will be able to be infected with their viruses.

And often this is a correct assumption, because for most people
anti-virus program and SCAN are synonyms... :-( Fortunately, their
viruses are usually too buggy and can't spread at all, or at least not
as fast as the anti-virus producers can update their products to
become able to handle those viruses.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 06:47:47 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Filler Virus (PC)

Steve Bonds (007) (sbonds%jarthur@uunet.uu.net) writes:

> Maybe frisk should add a message "This machine is infected with MSAV.
> Remove? (Y/N):"  ;-)

That would be perceived as unethical competition. Maybe the
CPS/Microsoft folks could even sue him.

> Seriously, it might be a good idea for frisk's
> software to disable VSAFE in memory while it is running.  Not only would
> this eliminate the false positives, but it would demonstrate the inherent
> security weakness in any TSR scanner that can be disabled through software.

No, it won't work. The problem occurs, because VSAFE contains
unencrypted scan strings in memory. If you disable, or even remove it,
a copy of the strings will still remain there. The only solution would
be to remove it and to wipe the freed memory block, but that's too
dangerous and could crash the machine in some cases. Besides,
sometimes VSAFE can't be removed - for instance, if you use the CPAV
version and install it as a device driver.

No, what Frisk is doing now is the most correct thing he could do -
warn the people that VSAFE is present in memory and that there is a
danger of false positives.

> Additionally I suggested that the CMOS be set up so the computers only boot
> from the hard disk to prevent infection should a real virus make its way in

Yes, that's an excellent idea. Everybody whose machine can be set up
in this way should do the same.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 07:02:17 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Removing Boot Sector Virus from Floppies (PC)

Ted Wong (tmw5@cornell.edu) writes:

> Run SYS with the infected floppy as the target. This is equally effective
> at clearing boot-sector viruses from floppies as it is at clearing HDs. This
> worked for clearing the Form virus (a boot-sector virus doing the rounds

I would just like to point out that SYS is effective only for removing
DOS Boot Sector infectors from the hard disk. Form is such a virus,
but Stoned, for instance, isn't and cannot be disinfected (from the
hard disk) in this way. Also, SYSing a floppy sometimes is not
possible, due to lack of free disk space for the hidden files. I would
like very much to have some kind of undocumented switch, that causes
SYS to overwrite only the boot sector - just like FDISK /MBR replaces
only the Master Boot Sector code. But, nah, Microsoft ain't that
smart. Instead, they gave you a (bad) scanner...

> This behavior is unusual. Non-boot disk operations (DIR, COPY) do not access
> the boot sector.

The operations mentioned above -do- access the boot sector. DOS needs
to read the BIOS Parameter Block from it, in order to figure out the
parameters of the floppy (size, location of the root directory, etc.).

> F-PROT is probably getting a ghost positive of some sort.

Yes, it does - exactly because DOS reads the boot sector in memory.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 07:45:03 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: How to clean Empire.Monkey.B (PC)

Ted Wong (tmw5@cornell.edu) writes:

> I tried something a little less daring with Norton Disk Doctor. Monkey
> appears to hide the original partition table somewhere else on disk, and

Yes, on cylinder 0, head 0, sector 3.

> subsequently scrambles the original location.

Is it XORed with 2E.

> 2. Use SYS to write a clean boot sector to the HD.

> Could an expert verify step 2?

As any "expert" will be able to tell you, it won't work - at least,
not with Monkey on a hard disk.

> I had an attack of Form at the same time
> I had Monkey, so I can't tell if 2 is the correct means of removing Monkey.
> However, the HD I used this method on is now clean.

However, Monkey is not Form. From is a DOS Boot Sector (DBS) infector
and can be removed with SYS both from the hard disk and from the
floppies. Monkey is a Master Boot Record (MBR) infector. It can be
removed with SYS from the floppies only. To remove such a virus from
the hard disk usually requires using FDISK /MBR (from MS-DOS 5.0 or
above).

However, with this particular virus even this will not work, because
it doesn't preserve the Partition Table (PT) information in the MBR.
The best solution is to use an anti-virus program which can identify
the virus and remove it.

And beware of the advices from self-appointed experts, or the cure
might be worse than the disease... :-)

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 07:52:04 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: New stoned? (PC)

Bill Hayes (IANR012@UNLVM.UNL.EDU) writes:

> We've encountered a new variant of STONED which totally corrupted the hard
> drive's partition table in a very short time.  F-Prot identified the virus
> as "a new variant of STONED."

What did F-Prot report exactly? You see, when it says "Infection:
<virus>" about a boot sector virus, it's pretty reliable (because it
does exact identification in this case). When it says "New or modified
variant of <virus>", this is a pretty good guess and it is usually
right, but it won't attempt to disinfect the virus (because it's a new
variant that it doesn't know). At least, when it says "Possibly a new
or modified variant of", this is a wild guess and it is right only
sometimes, by chance. (I mean, right about which virus it is. That it
is a virus, it is almost always right.) In this case it will also
refuse to disinfect - because the virus only remotedly resembles to
something it knows about.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 07:55:52 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: FORM virus--IBM (PC)

John M. Clark (c2mxcla@fre.fsu.umd.edu) writes:

> The IBM lab in my school has recently been plagued by a virus identified by
> the student newspaper as "FORM."
>    Does anyone have any information on this virus?

Yes, someone does. For instance, it is described in our Computer Virus
Catalog. Read the FAQ for more information about how to obtain it and
about other sources of such information.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 08:13:43 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: S-Bug again (was Virus Alert) (PC)

A. Padgett Peterson (padgett@tccslr.dnet.mmc.com) writes:

> >That's true, and one of the reasons is that it is encrypted in memory,
> >so detecting that it is active is not that trivial.

> Afraid I disagree here. The S-Bug screws up the memory allocation at the
> TOM (see FAQ) & takes 9-10 k doing it. At present it is the *only* virus
> I know of that has this easily-discernable characteristic so when active
> it is *very* easy to detect.

No way I can agree with the above. The amount of missing memory is a
pretty unreliable indication of which virus is present. For instance,
the Phoenix viruses "steal" 8 Kb. How would you distinguish between
S-Bug and Phonix plus some of the many boot sector viruses that use
only 1 Kb of memory? And what will happen with your method tomorrow,
when a dozen viruses appear that use the same amount of memory like
S-Bug??

As I said and I repeat, your method is a pretty good heuristic
indication that -something- is in memory. It should not be relied
upon, however, to determine -what- exactly is in memory. And, in the
particular case of S-Bug, identifying that exactly this virus is
present in memory (and not, say, some variant of it, or a combination
of other viruses, or a completely new virus) is far from trivial,
because the virus keeps itself encrypted even in memory.

> Next, it uses an appending technique that is easy to spot heuristically
> (albeit with the possiblity of a few false positives but if you have the
> S-Bug, I doubt that this is going to bother anyone - so long as a similar
> "immunizer" was not globaly applied previously - yet another reason they
> are not a good idea).

Yes, recgonizing the virus in a file is easier.

> True, removal is a bit more difficult but the next patch of "fast-update"

You probably mean - difficult with "standard means"? Because, if the
anti-virus program has recognized it, it shouldn't be too difficult to
apply its own decryption algorithm to decrypt the part of the virus
body where the original information about the infected file is saved.

> I have said it before & will continue to say it: The most important thing
> is to know that *something* has happened. *What* can come later.

True. But "what" is still important and my point is that answering
this question about this particular virus is not as trivial as you
seem to imply. Of course, it is far from impossible; it's just
difficult.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 08:41:47 -0500
From:    padgett@tccslr.dnet.mmc.com (A. Padgett Peterson)
Subject: Day of the week program (PC)

Well, if you are using MS-DOS, try using DEBUG to make a little .COM file:

MOV AH,2A
INT 21
MOV AH,4C
INT 21

and the day of the week will be returned as an ERRORLEVEL.
Call the eight byte program "DOTW.COM".
Then if you put the following in AUTOEXEC.BAT:

DOTW
IF ERRORLEVEL 4 IF NOT ERRORLEVEL 5 SCAN C: /CHKHI /A /M

SCAN will run every Thursday (take a long coffee break)

					Warmly,
						Padgett

Think my commercial problem is that all of my programs are so small
 that people find it hard to take them seriously. DiskSec2.exe is only
 5k (compressed) but represents over 2200 lines of code. Now if I wrote
 it in Clipper, it would be over 500k long and wouldn't work as expected
 just like many other programs...

------------------------------

Date:    Fri, 05 Nov 93 09:15:31 -0500
From:    Eric_N._Florack.cru-mc@xerox.com
Subject: Re:Why should a scanner HAVE to open a file? (PC)

A number of responses, from #144 on my original question about why should a
scanner HAVE to open a file.... Instead of posting three responses, I`ll post
one.

bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev) Says:

>>Second, most scanners nowadays don't scan plainly the whole file.
Instead, they look only at particular offsets from the file entry
point - where the virus is likely to be. And, in order to figure out
the file entry point, you'll have to open the file.<<

I would think that this is not altogether correct, though I`d have to do some
work on it. In theory, DIR and FAT info should tell you where a file starts,
and you should also be able to use that information, and mathmatics, to move to
a particular offset, to look for your string. I grant you, this would be
slow.... at least slower than opening the files. Perhaps it would be better not
to bother looking for the offset; by the time you get done doing the offset in
the manner I suggest, you could have just gone ahead and scanned the whole
file....

>>And this will
give you only the answer to the question whether the cluster
containing the sector belongs to a file. Even it does, this does not
necessarily mean that the sector belongs to the file - it could be
part of the unused space in the last cluster. In order to determine
that, you'll have to read also the directory information for that file
and to interpret it. In short, the solution will be rather slow and
your users are likely to select your competitor's scanner, which is
much faster... :-)<<

I guess that depends if you are, or are not interested in a scanner that won`t
make an existing virus problem worse, in the process of looking for such
problems.

>>Note that your analogy with NDD is not very exact, because it doesn't
do exactly that. Yes, it does have to solve the "reverse" task, but
only from time to time, when a sector is found to be bad, which
doesn't happen often. <<

Quite true. But, I would hope that the scanner wouldn`t find a `hit` very
often, and therefore wouldn`t need to sample FAT info very often, either.

>>Compare this with a heavily infected system
where each executable is infected.<<

I guess I attribute this to a different design philosophy. Why would one
continue to use a scanner, allowing it to run, once a problem is found? Forgive
me, but I was of the impression that the purpose of a scanner was to find if
there was a problem anywhere on the disk, to alert the user. The clean-up
proceedure (Ex: CLEAN.EXE) would be called in at the first sign of trouble....
which would then go through the whole disk and clean up any occurrance of the
virus.

Granted, that looking up all the pertanent FAT  and DIR information would be a
slow task. But one would hope that the need for that proceedure would be
mecifully small; that the string scanner would see a HIT only a few times, over
the life of the computer.

>>There is a different idea, however, which -can- be used (and is used
by e.g., TbScan) and which does improve system performance and reduces
the threat of having an active fast infector in memory to infect all
files that are being scanned. The idea consists of not opening the
files using the normal DOS function calls, but interpretting the
FAT/directory information for them "manually", determining which
sectors they occupy (this is fast as opposed to the reverse task) and
then scan only those sectors.<<

Only problem here is future virus development; is it possible we`ll see a virus
that will break the rules of DOS, and hide a file somewhere on the disk, or
mark a sector as bad, and then use it to stick itself into?

frisk@complex.is (Fridrik Skulason) writes:

>>Well, the answer is "yes and no".  Some scanners do indeed work like this,
but there are problems in "non-standard" situations:

   * when running under OS/2<<

Heh. Yeah, that would be a problem, particularly with HPFS. You see, I always
tend to gavitate toward DOS solutions, forgetting that other iron requires
other solutuions.

>>* when running in a DOS emulation on UNIX machines<<

Granted.
>> * when scanning compressed disks<<

Don`t get me started on THAT subject. (grin)

  >> * when scanning network drives<<

Yes. You`re suggesting that I`m limited to standard solutions because of the
non-standard iron in use, and to a large degree, you`re correct. THere`s too
many variables to discuss them here, I guess. Then again, non-standard iron,
and OS`s tend to foul quite a few viruses, too, so I suppose there`s some
equity, there. (grin)

maloned@itdsrv1.ul.ie (Declan Malone) says:

>>you'll have to consider the possibility of a virus signature (I take
it you're talking about a sig scanner) straddling a sector boundary.<<

Sure, I`d thought of that. The logic I`m working on now, is to read the disk in
half-sector incriments,feeding a full sector wide window in RAM, and scanning
that window fully, on each read. IN that way, sector boundries would be right
in the middle of the RAM buffer. Nothing gets missed. Now, I have to speed it
up somehow. (Always the problem, isn`t it?) Still, in all, I`d rather take the
extra time, rather than spread the virus I`m looking for. Does that make me an
exception?

> Yes, you can do it without opening a file, but why bother?<<

Here it is: To avoid the scanner infecting the uninfected files on the disk, in
the process of the scan.

REgards,
/E

------------------------------

Date:    Fri, 05 Nov 93 13:12:59 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: FORM virus on IBM PC (PC)

John M. Clark (c2mxcla@fre.fsu.umd.edu) writes:

>    The IBM clones at my college were recently hit by the "Form" virus.
> Does anyone have any information on what this virus does?

On the 18th of every month makes your keyboard "click" if you machine
supports INT 1Ah (most ATs and above do).

> Is it a boot-sector
> virus, .com or .exe infector, etc?

It is a DOS boot sector infector.

> Does it actually destroy or just replicate?

It is not intentionally destructive. However, it may cause damage due
to bugs - for instance, if the last cluster of your hard disk DOS
partition is occupied by a file, it will be corrupted. I have also
heard that it causes some problems to the OS/2 Boot Manager, but I am
not competent in this matter.

> I would appreciate any and all information.

For more information see our Computer Virus Catalog. For information
how to get it, see the FAQ list of Virus-L/comp.virus.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 13:16:45 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Information requested on "youth" virus on MS-DOS machines (PC)

EBERHARDY PETER - S93 (eberh_p@cowley.uwlax.edu) writes:

> I have heard of a small outbreak of the "youth" virus on my
> university campus.  It is not any kind of epidemic (yet)(thank god).

Could you please specify which scanner reported that name? (Also,
specify the particular version of the scanner.) There are at least
five different variants of a virus called Youth, but you might be
talking about something completely different.

> I have not been able to confirm any information I have received but
> have been told is is quite a bit nastier than "stoned" or "monkey".

Well, both Stoned and Monkey are MBR infectors. Youth (at least the
variants I have here under this name) is a COM infector.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 13:51:03 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Commercial Virus Scanners in the dark??? (PC)

Chris Atkinson (disruptor@pcscav.com) writes:

> What I SHOULD have said was "Heuristics in combination with string
> searching".

An even better expression would be "Heuristics in combination with
other anti-virus methods".

> I don't find that wildcards are that effective (As I virus
> writer, I know this first hand) Wildcards are ok for a few cases of
> viruses, but when you have variable length decryptors or variable length
> code, wildcards don't really serve much of a purpose;

Well, you are wrong. First, the vast majority of viruses can be
detected with a simple scan string - even with no wildcards. Most
virus writers are incredibly stupid and incompetent, believe it or
not, and can't write a sophisticated virus. That's why we keep seeing
zillions of Jerusalem and Vienna hacks. If a scanner can use wildcard
scan strings too (most of the contemporary scanners can), then it is
able to handle even more viruses. If the wildcard language it
reasonably sophisticated (e.g., allows the expression "skip an unknown
amount of bytes"), then it will be able to handle even some
polymorphic viruses. At last, if full regular expressions or even more
powerful language is used, it will be able to handle even such things
like V2Px.V2P1 (but not V2Px.V2P6.Z or the MtE- or TPE-based viruses).

Second, I never said that wildcards equals heuristics. Just one
heuristic is to use a particular wildcard string that often matches
boot sector viruses. I could say even "constant (non-wildcard) string"
and it would be again a heuristic.

Third, as I explained in my previous message, many products do use
different kinds of heuritsics, although not necessarily the same as in
F-Prot and TbScan and don't necessarily call them "heuristics".

>         AA BB CC DD ** FF GG HH II
>  This would mean that all code is the same except for the wildcard **
> which could be any value..

>  What if the had relocatable code;

>         BB GG II AA ** FF HH CC DD

>  It wouldn't find a hit because everything has been re-arranged.

Yes, but there are not many viruses like that. Probably only a few
dozens. Compare that with the total number of about 3,200 existing
ones. You are correct, however, that the number of sophisticated
viruses is increasing, and that the problem needs a more general
solution. Keep on reading. :-)

>  Mind you, if you have multiple wildcard searches as with the Whale (28
> different patterns if memory serves correct...), then it WILL be
> effective in finding 28 different mutations of the code.

Memory doesn't serve you correctly, methinks... There are two variants
of Whale, each using 30 different decryptors, but there is a lot of
overlaping, so the total amount of different decryptors is 34. All of
them can be matched by a constant scan string; even no need to use
wildcards.

>  What I think has to happen is that, as with FProt and Thunderbyte, there
> has to be a trend towards tighter integration between traditional pattern
> matching and heuristics.

Well, as I and several others mentioned, there are already several
products that use some kind of heuristics to improve their detection
rate.

> developed may come one day soon. How would a scanner pick up a virus that
> can reside either as a parasite on a file or resides in the boot sector
> or fat, has a mutation engine that makes sure no two bytes of code are
> the same in each mutation, has variable length code between 1500 and 4000
> bytes, uses file pointer manipulation, controls INT 13h and 21h at
> boot-time, is totally stealth beyond DIR_II, 4096, and Pakistani Brain
> methods, (Insert your own worst nightmare here), and yet allows your
> system to function totally normally.

First, the beast described above would be picked without problems by a
reasonably good integrity checker. Second, so much sophistication will
probably make it slow and unable to spread (remember Whale?). Third, I
have yet to see a virus with such a level of sophistication that
allows the system to function "totally normally" - the virus writers
are usually bad programmers and tend to make all kinds of bugs in
their viruses. Fourth, of the tricks described, only the polymorphism
represents some problem to the scanners (well and also stealth, to
some extent). Fifth, I have yet to see a virus that resides in the
FAT. Sixth, even a virus like the described above can be handled by a
scanner, and even without the usage of the kind of heuristics you are
talking about.

>  All you virus authorities out there might agree with me that the day
> when the "Supervirus" is developed may not be that far away. In the last

The more features a virus has, the less likely it is to spread.

> 2 years, the virus world has seen many a nasty creation that were
> unthought of 4 years ago... What nasty tricks will some hacker find next?

May I remind you that during all those years the anti-virus products
have succeeded to handle each one of the new nasty tricks invented by
the virus writers?

>  I was a virus author, but decided that it was boring because, well,

Agreed, it is.

> maybe it was just a stage. I know my stuff, and I have used my progamming
> knowledge in the past (Everything's relative ... :)  ) to try and give
> you virus authorities a hard-time and you

"Programming knowledge"? "Hard time"? Hm. Didn't you mention RABID
somewhere? I can't recall a virus produced by anybody from this group
that was reasonably sophisticated or that has given the anti-virus
people a "hard time"... Maybe you can help?

>  The bottom line is, you've done a good job in playing catch up, but then
> again, that's always been the case with you researchers. You're active

Ah, thanks for the compliment...

> Where would you be without new virus being released
> everyday.

Probably - doing something much more useful, instead of wasting our
time dealing with your nasty creations.

>  Why can't you be proactive as well? Heuristics is a step in the right
> direction and I'm looking forward to seeing even further developments.

It is. One of the steps. As we told you, it is being used more and
more widely nowadays.

It's not the only step in the right direction, however. You are
correct, in general, that the polymorphic viruses (I mean, the
*really* polymorphic ones, not the junk) represent the most serious
problem to the scanners. Using heuristics helps, but is not the only
way to solve the problem, and even not necessarily the best way.

For instance, Frisk developped something that he calls something like
"generic detector of decryption routines". It analyses the code in the
file, tries to figure out whether it looks like it is decrypting
something, then tries to find out the decryption method used and the
particular key. The key is then used to decrypt the rest of the file
and the standard scan string methods are applied to the decrypted
stuff. I've heard that it has been so successful, that once it has
detected the decryption routine used by some anti-virus product to
decrypt its scan strings, which has caused false positives... :-)

Another solution (a better one, IMHO) is Dr. Solomon's Generic
Decryption Engine. It uses the decryption algorithm in the virus, to
decrypt the rest of  it. It can handle only known viruses, but adding
a new polymorphic (of the MtE class) virus to the scanner becomes just
a matter of minutes.

And so on. The anti-virus researcher are certainly not giving up,
don't worry. :-)

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 05 Nov 93 14:25:27 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Removing Boot Sector Virus from Floppies (PC)

Ted Wong <tmw5@cornell.edu> wrote:
>aminzade@moose.uvm.edu (Russell Aminzade) writes:
>
>>We cleaned it up fairly easily (after reading the FAQs here and asking
>>around) with FDISK /MBR, and restoring with SYS.  This was easy --
>>we're all DOS 5 in the lab where the infection happened.  I hate to
>>think of the hassles if it gets around campus where we have a lot of
>>different varieties of DOS!
>
>>Here is the problem, and I'd appreciate any help from the nets.  I
>>don't see how to clean off floppy disks since the boot sector remains.

I am not sure which virus you are talking about, but if you toasted
it with FDISK /MBR, then it is unnecessary to SYS it, currently.  I do not
believe there are any MBR and boot sector viruses.
FDISK /MBR takes care of the MBR virus.
SYS takes care of the boot sector.

>
>Run SYS with the infected floppy as the target. This is equally effective
>at clearing boot-sector viruses from floppies as it is at clearing HDs. This
>worked for clearing the Form virus (a boot-sector virus doing the rounds
>here). Of course, it means that the floppy will now be bootable; I'm not
>sure how to get around this one, except by deleting the hidden system files.

Yes.  Actually, you couldn't fdisk /mbr a floppy disk, as they have no
MBR in the first place, only a boot sector.

Hard drives canhave a lot of boot sectors (one per partition), and all this
partition information is stored in the MBR.  This is where a large quantity
of viruses will stick themselves (more so than a hard drive boot sector)

>There has been a long discussion is comp.sys.ibm.pc.misc about ways of
>locking out the A: drive during boot-up. Posting an article there should
>elicit some good advice.

Most AMI BIOS's allow an option to boot drive C:, then A:, or to totally
lock out a boot from drive A:.

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Thu, 04 Nov 93 14:40:11 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: NAV updates available via ftp (PC)

Hello, everybody!

I have received directly from Symantec and made available (with their
permission) on our ftp site the latest virus definitions updates for
NAV 2.1 and 3.0. The full references of the two archives are

ftp.informatik.uni-hamburg.de:/pub/virus/progs/nav21upd.zip
ftp.informatik.uni-hamburg.de:/pub/virus/progs/nav30upd.zip

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Tue, 02 Nov 93 16:59:20 -0500
From:    "Rob Slade" <roberts@decus.ca>
Subject: The price is right (CVP)

PRTAVSI.CVP  931005

                        The Price is Right

Price is always a consideration when purchasing anything, and
antiviral software is no exception.  However, in the case of
antiviral software, there is an additional consideration:  how much
is charged to other people, not just yourself.  Some antiviral
software is free to individuals, or provides or sponsors free
versions for the general public.  These should be supported.

Well, you may say, that is all very well, and it's nice to see
public-spirited companies and all that, but I have my own troubles.
It's great that they are altruistic, but why should I be altruistic,
too?

Ah, you misunderstand me.  I am *not* asking you to support free
software out of the goodness of your heart.  I am telling you to
support it out of self defence.

The current situation with regard to computer "hygiene" is terrible.
Thousands of people are "carriers" of computer viral infections -
and don't know it.  This is not through any malice on their part, it
is simply that too few people understand the problem.  During the
months leading up to March of 1992, no less than fifteen different
companies, all reputable (some major), all sent out products
infected with the Michelangelo virus.  Computer retail and repair
stores are, as of this writing, a major vector for the spread of
computer viral programs.  Just because you know how to put a
computer together, or take it apart and fix it, does not mean you
know how to keep yourself, and your customers, virus free.

Anything, therefore, that helps to eliminate any viral programs,
will help the "hygiene" of the computer environment as a whole.  If
a company, or individual, provides materials that help keep the
numbers of viral infections down, then regardless of whether you or
your company actually use that service or product, it is helping to
keep you safe.  It is, therefore, in your own interest to support
all such services.

F-Prot, in the MS-DOS world, is currently free for individual, non-
commercial use.  This means that you can legitimately give it to all
employees for their home computers.  (The fact that it is also
arguably the cheapest and most accurate scanner is interesting.)
For the Macintosh, Disinfectant always has been free.  Padgett
Peterson, author of DISKSECURE, also provides the free FixUTIL
package.  Thunderbyte Scan and VIRx used to be free promotional
packages for their respective commercial products, unfortunately
both are now shareware instead.  Two very widely promoted commercial
antiviral packages brought out free "special editions" prior to
March of 1992 to search for Michelangelo.  I do *not* consider these
to have been beneficial since, while they *appeared* to check the
whole disk, they only searched for that one specific virus (and, in
one case, for "Maltese Amoeba").  The Norton Antivirus did release a
free NAVSCAN at one point; to the best of my knowledge it has never
been updated.

copyright Robert M. Slade, 1993   PRTAVSI.CVP  931005

==============
Vancouver      ROBERTS@decus.ca    | This message contains not less
Institute for  Robert_Slade@sfu.ca | than 70% post consumer electrons
Research into  rslade@cue.bc.ca    | and not less than 80% post
User           p1@CyberStore.ca    | harangue opinions.
Security       Canada V7K 2G6      | Please recycle.  Thank you.

------------------------------

Date:    Fri, 05 Nov 93 13:09:16 -0500
From:    "Rob Slade" <roberts@decus.ca>
Subject: 1.1 - Power (CVP)

BEGPAN2.CVP   931015

                            1.1  Power

Let us assume the worst possible case.  You have reason (maybe good,
maybe bad, we'll cover that later) to believe you have a virus. What
do you do first?

Most people would tell you to immediately shut the power off.  That
*might* be a good idea - but it might not.  Shutting the power off
will definitely keep a virus from operating.  If the power already
*is* off, don't turn it back on - at least not until you're a bit
more comfortable with what might be going on.  However, if the power
is on and the virus is active, what is it going to do?  Infect your
computer?  It's already done that.  Erase files?  Format your disk?
Well, yes.  There are viral programs that will do that.  You
probably don't have to worry about that happening, though.

With some few, possibly debatable, exceptions, no virus is
beneficial.  You don't need anything randomly adding itself to
programs, you don't need to lose the extra disk space and you don't
need to lose the memory and interrupts.  Most common viral programs,
though, are termed "benign".  This means that they carry no overtly
damaging code, and that any damage they do is unintentional.
"Malicious" code tends to draw attention to itself, and thus be
destroyed, or to destroy itself when it formats the drive to erase
everything else.  Therefore, the odds are in your favour that if you
do have a virus, it won't be doing any damage.

If you *do* happen to have an infection by one of the malicious
viral breeds, you still might not be in trouble.  Most malicious
payloads require some sort of trigger event.  Sometimes this can be
a specific time of day, but not very often.  The Michelangelo virus,
for example, triggers on March 6th - but only when the computer is
booted up on March 6th.  If you leave the computer on all day March
6th, nothing will happen.  (This is not to say that leaving the
computer on all day on March 6th will avoid Michelangelo.  There is
too much risk of an accidental reset, and far better ways of dealing
with the infection.)  Therefore, your chance of any damage happening
while the computer is on is reduced further.

If, of course, you have just seen, "Ha, ha!  I, the Disk Head Crash
Virus have just erased your disk," then you're in trouble.  You
probably won't, however, get into any more trouble by leaving the
computer on.  In fact, if you don't panic, and calmly leave the
machine on, there can be a better chance of recovering something.
Some of the system information is still in memory, and if that can
be written back to the disk the chances of recovery may be improved.

To conclude, then:  if it's off, leave it off.  If it's on, leave it
on.  If, of course, the printer is going nuts, there is one too
bright dot in the middle of the monitor and the disk drive is in a
constant spin cycle while making rattling noises - turn it off.

copyright Robert M. Slade, 1993   BEGPAN2.CVP  931015

==============
Vancouver      ROBERTS@decus.ca    | "Hey, when *you* have the
Institute for  Robert_Slade@sfu.ca |  box, *then* you can give
Research into  rslade@cue.bc.ca    |  us geography lessons.
User           p1@CyberStore.ca    |  Until then, Tahiti is in
Security       Canada V7K 2G6      |  Europe."    - Sneakers

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 145]
******************************************

