VIRUS-L Digest   Tuesday, 23 Nov 1993    Volume 6 : Issue 149

Today's Topics:

Tales about viri
Re: Draft Swiss AntiVirus regulation
Why should a scanner HAVE to open a file? (PC)
F-prot Rules! (almost) (PC)
Re: Horror of Horrors! (PC)
Day of the week program (PC)
Sorry, I need more RAM memory (PC)
Automated Virus Scan Every n days (PC)
Re: How to clean Empire.Monkey.B (PC)
Re: Rosenthal again.. (PC)
Re: Automated virus scan every n days ? (PC)
Re: Commercial Virus Scanners in the dark??? (PC)
Re: Removing Boot Sector Virus from Floppies (PC)
Re: New Virus? (PC)
Re: Monkey is not cute! (PC)
Re: Horror of Horrors! (PC)
Removing the Moctezuma virus (PC)
Re: Full version of AVP 1.07 available (PC)
Re: Automated virus scan every n days ? (PC)
Re: [Q] Cross-linked files => virus? (PC)
Re: [Q] Cross-linked files => virus? (PC)
Frisk's name in a virus (PC)
Hiding viruses in documents (PC)
Re: Automated virus scan every n days ? (PC)
November 1993 LAT (PC)
Save all you can (CVP)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Sat, 13 Nov 93 09:08:47 -0500
From:    jmerelo@casip.ugr.es
Subject: Tales about viri

Hi, this is JJ Merelo, from Granada, Spain. I gotta give a short talk
to non-techie users, and would like to add some spicy stories about
funny mistakes about viri/outright catastrophes caused by them/and any
other anecdote that may make some laughs (or some Oooohs) in a
conference.

Please answer by e-mail directly to me. If enough anwers come by, I'll post
them and make them available by ftp.

Thanks

				JJ
___________________________________________________

JJ Merelo
Grupo Geneura
Depto. Electronica y Tecnologia de Computadores
Ftad. de Ciencias
Campus Fuentenueva, s/n
18071- Granada (Spain)
Phone: 34-58-243162; (Home) 34-58-133373
Fax:   34-58-243230
___________________________________________________

------------------------------

Date:    Sat, 13 Nov 93 15:44:16 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Draft Swiss AntiVirus regulation

 <vfreak@aol.com> wrote:
>>such experiments in such restricted environments. It's writing viruses
>>for the real computers that we label as malicious, unethical, and
>>criminal.
>
>I disagree. I have no problems with people writing viruses. Releasing these
>viruses into the wild to computers of unsuspecting users is what I consider
>malicious, and unethical.
>
>As long as the virus is kept under controled condition, it is none of my
>business if Joe user down the street write a virus.

Well ,if it were in a controlled condition, then you would never have
known that Joe wrote a virus.

Clearly, however, Joe does release his viruses, or they "escape" where they
are supposed to be.  Who is to be the judge of who can or can't write
viruses?  Who is the one to say who is more responsible than someone else?

Indeed, it is malicious to allow a virus to spread to unsuspecting
users, but it is pretty unethical to write the virus in the first
place.  Why would you want to write one?  What benefit's can you
receive from keeping a virus isolated and never let anyone see it?  To
study it?  If you wrote it, you sure as hell knowwhat it will be
doing.

>
>>I don't think that virus creation should be forbidden per se. But I do
>>think that if a virus is found somewhere where it is unwanted, the
>>author of the virus should share the responsability, even if he has
>>not introduced the virus into that system.
>
>I agree with this 100%

Even if it were forbidden, how effective do you think any of the laws
which state that would be?  Murder is unethical and malicious, by society's
standards today, it also has a lot of legislation against it.  But, it
still happens.

Virus writing would be a very difficult thing to enforce.


- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Fri, 12 Nov 93 17:20:07 -0500
From:    duck@nuustak.csir.co.za (Paul Ducklin)
Subject: Why should a scanner HAVE to open a file? (PC)

>I would think that this is not altogether correct, though I`d have to do some
>work on it. In theory, DIR and FAT info should tell you where a file starts,
>and you should also be able to use that information, and mathmatics, to move t
o
>a particular offset, to look for your string. I grant you, this would be
>slow.... at least slower than opening the files.

Well, how do you suppose DOS manages its filing system? If well-written,
code to give read-only access to a DOS drive without using DOS is likely
to be much *faster* than DOS. There's a lot less work to be done, and much
less housekeeping -- no writes to worry about, for a start.

Sure, it would be incompatible with all the not-straight-DOS implementations
of DOS drives around (emulators, compressed drives, networks...). So, in
those cases, use the regular DOS calls to talk to the filing system.

Paul

    /\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
    \  Paul Ducklin                         duck@nuustak.csir.co.za  /
    /  CSIR Computer Virus Lab + Box 395 + Pretoria + 0001 S Africa  \
    \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/

------------------------------

Date:    Fri, 12 Nov 93 21:02:20 -0500
From:    al026@yfn.ysu.edu (Joe Norton)
Subject: F-prot Rules! (almost) (PC)

It's nice to see that you beat out McAfee's ScanV in the Vsum
certifications in VSUMX310.ZIP!!!  It's about time that Patti's
test results got close to reality.  Maybe the results are
getting better since only NAV 3.0 paid her to be tested this
version.  If AV product developers refuse pay for an invalid
test on an invalid sample collection her "interesting" test
procedures might improve?  We can hope.

A small problem that I've noticed in 2.09f is that it doesn't
detect Butterfly Crusades on DOS 6.0 EMM386.EXE.
This was from the sample included in sport21c?.zip on the
CD-ROM Nightowl 10 in the MODEM&BBS file area.  I just ran it's
install, and it changed to my C:\DOS directory and infected a
few files.  F-Prot was able to detect all (5?) infections except
for that one.  It did say that one of the infections was a
"new or modified" and wouldn't clean it, so maybe that explains
what happened.  If you need a sample holler.  I'll uuencode the
original and zap it to your site.

P.S.  I've seen posts about Memory Lapse virus on the above
CD-ROM, but not Butterfly Crusades.  It has both.  I've got it
here to play with.
                                        Joe


------------------------------

Date:    Fri, 12 Nov 93 21:19:15 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Horror of Horrors! (PC)

jenny.m.abar <mvjma2@cbnewsb.cb.att.com> wrote:
>it is still under warranty (Not sure about if it is not) or "allow"
>you to upgrade to NAV 3.0 for $29, whoppee!

this product normally costs $129 or so.
I am sure that if you were to call up Symantec and fuss enough, you could

>Are any of the Untouchable people still out there?  What will become
>of these programs?  Is Symantec going to incorporate some of their
>features into NAV or are they just going to let it die out?  Please
>let us know so I can tell my husband to get a refund, we don`t want
>to be stuck with NAV.

I detect some anger towards NAV?

NAV 3.0 is quiet unlike 2.1, (or less), so if you have had bad experiences
with NAV int he past, you should not anymore (unless you have a processor
under an 80286... :().

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Fri, 12 Nov 93 22:49:54 -0500
From:    jaf@jaflrn.morse.net (Jon Freivald)
Subject: Day of the week program (PC)

This (and a bit more) is the purpose of my VirusCheck program.
Available via mail-server@jaflrn.Morse.Net -- send a message with the
text "get dos/virus/vck31.zip" and it will get sent to you in uuencoded
pieces.

Jon

PS - only works with McAfee's ViruScan.

padgett@tccslr.dnet.mmc.com (A. Padgett Peterson) writes:

> Well, if you are using MS-DOS, try using DEBUG to make a little .COM file:
>
> MOV AH,2A
> INT 21
> MOV AH,4C
> INT 21
>
> and the day of the week will be returned as an ERRORLEVEL.
> Call the eight byte program "DOTW.COM".
> Then if you put the following in AUTOEXEC.BAT:
>
> DOTW
> IF ERRORLEVEL 4 IF NOT ERRORLEVEL 5 SCAN C: /CHKHI /A /M
>
> SCAN will run every Thursday (take a long coffee break)
>
> 					Warmly,
> 						Padgett
>
> Think my commercial problem is that all of my programs are so small
>  that people find it hard to take them seriously. DiskSec2.exe is only
>  5k (compressed) but represents over 2200 lines of code. Now if I wrote
>  it in Clipper, it would be over 500k long and wouldn't work as expected
>  just like many other programs...

=============================================================================
		     Jon Freivald ( jaf@jaflrn.Morse.Net )
	   22A829/40 DA 9E 8E C0 A1 59 B2  46 3B 73 81 2B 7B 83 1F
		    PGP V2 public key available on request
	 Nothing is impossible for the man who doesn't have to do it.
=============================================================================

------------------------------

Date:    Sat, 13 Nov 93 00:44:04 -0500
From:    vfreak@aol.com
Subject: Sorry, I need more RAM memory (PC)

From:    byng@solomon.technet.sg (Ng Bee Yong)
>  Sorry, I need more RAM memory
>  390 kbytes should be enough
>Is it some kind of bug in SCAN?  I am quite sure I have more than 500 kbytes
>of conventional memory before running SCAN.  It happened when I scanned some
>standalone machines, and also when I tried to scan the network.

Yes: this is a known bug in Scan 108. It is caused by using the /A
parameter to scan all files. This bug happens after scanning
approximately 1,000 files.  Stop using the /A parameter, and tyhe bug
will stop occuring.

Bill lambdin

------------------------------

Date:    Sat, 13 Nov 93 08:01:42 -0500
From:    "P.D.Ellett" <P.D.Ellett@sheffield.ac.uk>
Subject: Automated Virus Scan Every n days (PC)

   My friend Stephen Baines has recently written a small program to
do automated virus scanning.  The current version can scan either
daily or once every 6 days by the use of two batch files that the
program can call up.  A new version is under development with more
options including the ability to scan your machine on the trigger
dates of the 20 most common virii. If you would like a copy of the
program please mail me at any of the addresses below (preferably not
Sunc) and I will send you a UUencoded copy.
   Currently the program is free for individual private use and a
commercial site licence is available.

   Yours Phil.
  *****************************************************************
  *   Phil Ellett   Mechanical Engineering Student                *
  *                     University of Sheffield                   *
  *                                                               *
  *   E-mail     UK     : P.D.Ellett@sheffield.ac.uk              *
  *              UK (2) : me3pde@sunc.shef.ac.uk (emergency only) *
  *          Canada     : phil2@softwords.bc.ca                   *
  *             USA     : phil@m-net.ann-arbor.mit.us             *
  *                                                               *
  *****************************************************************

------------------------------

Date:    Sat, 13 Nov 93 12:44:50 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: How to clean Empire.Monkey.B (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> >And beware of the advices from self-appointed experts, or the cure
> >might be worse than the disease... :-)

> Can you tell us which is which?

I'll leave that to you to guess... :-)

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 12:48:25 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Rosenthal again.. (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> >As a matter of fact, I don't recall to have seen Frisk's name in a
> >virus. Maybe the virus writers respect him more, because he offers an
> >excellent product essentially for free... :-)

> I believe I saw a mention  of one in out great and reliable (ahem)
> VSUM program.  check the most recent "update" to the virus database.  It
> was a "new" virus, and not a hack.  (according to Hoffman)

Could you provide some more hints? I just checked VSUM 9309 for the
string 'fridrik'. Found several occurances of the type "this virus
first discovered by Fridrik Skulason" (a couple of which were wrong),
but nowhere it said that this string is in a virus. Maybe I should
search for something else? Or check the latest version - I've heard
that 9310 is out?

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 12:55:15 -0500
From:    k_ford@unhh.unh.edu (lubberland@unh.edu)
Subject: Re: Automated virus scan every n days ? (PC)

conn0060@maroon.tc.umn.edu (Michael F Conners-1) writes...
>>FPROT on my system. What I am looking for is a program/autoexec code
>>that will execute F-PROT and SCAN only once on say Thursday and then ignore
>>all other boots until the following week, etc. I had some code from
>>PC Magazine's USER-TO-USER (I think) from last year but it did not
>>work properly. Is there such a beast out there? Please mail all repsonses
>>to jlaw@irus.rri.uwo.ca.
>
>I am also looking for a way to do this.  My e-mail address is

No, no! Put it on the net, please!

------------------------------

Date:    Sat, 13 Nov 93 13:05:24 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Commercial Virus Scanners in the dark??? (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> >The more features a virus has, the less likely it is to spread.

> Are you sure about that?  Form?  Dir_II?  Tequila?  Monkey?  They have
> "features" beyond a simple infect one file in a directory .COM appender...

Yes, I am sure about that. Form? A pretty lame and buggy DBS infector.
Dir_II? Lightning fast and full of tricks, indeed, but unfit for the
contemporary environment of DOS 5.0+, compressed volumes, networks,
etc. It's quite widespread in Bulgaria, but doesn't seem to make it in
the rest of the world. Approximately the same can be said about the
Number of the Beast - elegant and full of tricks, but doesn't seem to
spread well - not everybody seems to be running DOS 3.3. I've heard
that it is relatively common in Argentina, but only because some
software company has distributed it with their software. Tequila? It
"got lucky" because a large shareware vendor (the virus author's
father) distributed it with infected software. Monkey? What's so
special about it? OK, it has a couple of tricks, but most MBR
infectors that fit in a single sector are pretty limited. And, as you
should know, Stoned.Empire.Monkey.B that is currently doing the rounds
is just one of almost two dozens variants of the Stoned.Empire.* group
- - so why are not the other variants (most of which use similar tricks)
as widespread as it?

Obviously, the most important factor for a virus to spread
successfully is its initial distribution. If it "gets lucky", it will
become common, regardless of whether it is sophisticated or not. Of
course, if it is yet another overwriter, it won't go too far. But even
such stupid thing as Butterfly is counted in the wild, because it was
widely disseminated with a popular communications package.

The real disaster is when a virus which is already well written,
sophisticated and viable, gets widely disseminated by some mistake.

> Dir_II...  And Tremor isn't even that great from what I've been hearing
> lately)

Well, it has its share of tricks... But it is common only in Europe
and mainly in Germany, because, guess why, yes, it has been widely
disseminated here. Not because it is sophisticated. Same goes about
Parity_Boot.B - Germany is full of it. Not because it is stealth or
survives warm reboot (which it is and does), no - because some large
warehouse has distributed it on the computers they sold. And so on.

> >>  I was a virus author, but decided that it was boring because, well,
> >
> >Agreed, it is.

> Er...?  How do you know if it is or isn't until you've done it?

I am using my brains to figure it out. Don't you?

> >stuff. I've heard that it has been so successful, that once it has
> >detected the decryption routine used by some anti-virus product to
> >decrypt its scan strings, which has caused false positives... :-)

> I wouldn't call anything that gets false positives, "so successful".

Maybe you shouldn't judge something that you don't know. But, of
course, doing something "too successfully" is sometimes a flaw. Which
is why it has been corrected, as far as I understand.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 13:08:58 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Removing Boot Sector Virus from Floppies (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> >The operations mentioned above -do- access the boot sector. DOS needs
> >to read the BIOS Parameter Block from it, in order to figure out the
> >parameters of the floppy (size, location of the root directory, etc.).

> Er... While true, keep in mind that this is treated as data, and not
> code - it is not executed.

I obviously know that, because I have emphasized it several times
here. Which part of my message lead you to believe that I don't?

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 13:15:54 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: New Virus? (PC)

Corey Lawson (csl@stein3.u.washington.edu) writes:

> 1.  When trying to load windows, we get this funky error message in summary
> saying the HD's address has been changed and consequently, the 32-bit
> disk driver won't work.  But Windows will run, with 16-bit HD access.

> So, I get to thinking, maybe it's a virus.

Indeed, 32-bit disk access becoming suddenly unavailable to Windows
3.1 is often a symptom of a virus infection - usually a boot sector
virus.

> 2.  try to run F-prot.  No reboot.  I stick in my usual
> write-protected boot disk with F-PROT on it.  Whirr whirr goes the
> disk drive.  Eventually I get the Abort, Retry, Ignore, Fail error
> message.

> 3.  Boot from f-prot disk.  WhirWhirWhir.  Can't boot from floppy.

> 4.  Boot from system disk w/o f-prot on it.  No problem.

> 4a.  Stick in f-prot disk to copy f-prot onto HD.  Copy bombs on f-prot.exe.
> INT 24.

This makes me think that your "usual write-protected boot disk" might
be corrupted. Yes, with time the floppies can fail, just like that.
Try copying the file on a clean machine. If it bombs again, it's a
certain indication that the floppy is physically corrupted.

> Oh...and doing disk access from other disks takes awhile (i.e., it sure
> seems like it's looking for a virus checker).

Try formatting a diskette on a machine that is known to be clean and
not to have these problems. Then write-protect it, put it in drive A:
of the suspected machine and do a DIR. Listen carefully to the drive,
does it do the characteristic whirr-whirr? Repeat the experiment on a
clean machine - does it happen there? If not, it's almost certainly a
virus. (An alternative explanation could be that the floppy disk drive
of the suspected machine is out of order.)

> Umm...Write-protect can't be overridden with clever DOS system calls, can it

No, it cannot. This is even explained in the FAQ of this newsgroup.
However, sometimes the write protection can faild due to hardware
problems, not due to clever programming. In order to test this, try to
copy a file to the write protected diskette. If you can't, then no
amount of clever programming will be able to do it on that machine.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 13:39:27 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Monkey is not cute! (PC)

sullivan@cobra.uni.edu (sullivan@cobra.uni.edu) writes:

> I also got KillMonk version 1.1.

The latest version of KillMonk is 3.0. Available from our ftp site.

> Vshield reports the infection as the [Mon] virus.  F-Prot calls it
> a new variant of Stoned.  Norton reports it as Stoned.Empire.Monkey.
> KillMonk says that the diskette is infected with Monkey.

F-Prot is wrong (except that Monkey is indeed a variant of Stoned),
the others are right.

> version 6.01 rebuild.  Earlier versions of NDD, FDisk /MBR, FixMBR
> didn't work and, in fact, I ended up destroying a 250 MB loaded hard
> drive in the process.

Yes, Monkey is one of the MBR infectors that CANNOT be removed with
FDISK /MBR. Even worse, using this approach with such viruses could
(and usually does) lead to data loss and a knowledgeable technical
person should be consulted to repair the damage.

It is easy to check whether the MBR infector you want to remove is of
this type. When you boot from your MS-DOS 5.0+ floppy, do a DIR on the
hard disk. If DOS is still able to recognize the volume, FDISK/MBR
will work. If you get "Invalid drive C:" or something like that, don't
use FDISK/MBR.

> before it goes active.  VIRSTOP isn't, even when I use the /boot
> parameter.  I have tried it with and without the /disk parameter, so

The /disk option has nothing to do with this, but I am surprised that
VirStop doesn't find it with the /boot option or doesn't lock the
system booted from an infected hard disk. Even when unable to
recognize the virus, it used to be able to report something about the
interrupt vectors being changed, or the possible presence of a boot
sector virus in memory, or something like that. Maybe Frisk could
comment on this?

> same sort of protection.  Second, we already have people pushing the
> edge of the 640K envelope and 50K for the VShield TSR is not a welcome
> addition.

With VShield you could use the /SWAP option - it is roughly equivalent
to VirStop's /disk and reduces the memory used by the program to only
a few Kb - for the price of some slowdown.

> NAV is just plain too expensive for most of our people.

And doesn't run on XTs. :-)

> We've tried forcing a scan with F-Prot each time a diskette drive is
> chosen, but on anything less than a 386 it's just too time consuming.

Just curious, how did you achieve this? With 4DOS (or something like
that) and "a:" aliased to some command?

> At the moment we are forcing a scan of all hard drives every time they
> reboot and locking the keyboard if an error code is returned, but we'd
> like a better solution.

If you are concerned only about this particular virus, and if the
price is a considerable issue to you, use KillMonk - it is free, as
far as I recall, and deals with this virus (and with a related one -
INT_10) pretty well.

Another good idea is to install some kind of program that
automatically restores the boot sector(s) if they are modified.
DiskSecure II is a pretty good solution. If you are not happy with
protections that install themselves in your MBR, there are other
alternatives, like ShrDog (doesn't work under DR-DOS) and HS, both
available from our ftp site. Another similar program comes with the
TBAV package. All they save a copy of the clean boot sectors, and if a
change is detected, restore the modified with the clean ones and
reboot the machine. Some of them are more secure than others. For
instance, Jack_the_Ripper virus (and probably INT_10 too) passes
through this kind of boot sector protection in CPAV (called BootSafe)
like a hot knife through butter.

> make more ;-} so I could provide them.  Has anyone encountered this and
> sent it to Frisk?

Yes. Even the virus has been analysed and the proper map for it has
been created.

> Can you tell me how to encode the virus so that I
> can send it to him?

Usually programs like TeleDisk are used for this kind of task. In the
worst case, you could infect a blank, formatted diskette, copy the
whole of it in a file with Norton Disk Editor, ZIP the file (it will
compress very well, because the diskette is formatted), uuencode the
archive and e-mail it.

> Is there a chance this would be included in version
> 2.10?

Yes.

> Is there a better way for us to plug security holes in our
> student computer centers?

See above the discussion of ways to protect yourself from boot sector
infectors. Also, if the computers can be forced to always boot from
the hard disk (instead of from the floppy), this will help a lot.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 13:56:17 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Horror of Horrors! (PC)

jenny.m.abar (mvjma2@cbnewsb.cb.att.com) writes:

> told that as of Nov. 1 Untouchable is discontinued!!

> It appears that Symantec has bought Fifth Generation and will no
> longer offer Untouchable or S & D.  They will refund your money if
> it is still under warranty (Not sure about if it is not) or "allow"
> you to upgrade to NAV 3.0 for $29, whoppee!

Yes, I can confirm that. I knew earlier (since the beginning of
September) that Symantec has bought Fifth Generation Systems. However,
it was my understanding that they will use the best of the technology
in the Untouchable in their NAV. Now I read in the latest issue of
"Virus Bulletin" that they have decided to discontinue Untouchable.

Too bad. There was certainly a lot NAV could learn from Untouchable.
It could at last learn how to do integrity checking right. It could
also learn a lot from the excellent scanner. The equivalent parts in
NAV 3.0 are no match of those in Untouchable. A pity.

Personally, I am really quite disappointed by what Symantec has done
with several pretty good products. Notron Utilities was an excellent
tool for system hackers when produced by Peter Norton. Symantec bought
Peter Norton Computing and produced version 6.0 of NU - a dinosaur.
>From what I've heard about version 7.0, I even don't want to look at
it. I still keep copies of the disk editor and the directory sorter
from version 4.5, to cope with the bugs and misfeatures of those in
version 6.0.

4DOS was (and is) and excellent product. Until Symantec bought version
3.3 (I think) and released it as "NDOS" - together with several bugs
in it - in Norton Utilities 6.0. Fortunately, JPSoftware still exists,
so one can throw NDOS away and get the real thing.

I don't remember any more when NAV 1.0 was released - but I have the
impression that it was about the time when Symantec aquired PNC. By
all means, NAV 1.0 was a sorry product anyway. It certainly has
improved with the next releases (actually, it was difficult to make it
worse), but not as much as I would like.

I have never seen NOVI, so I don't know whether it has really helped
to improve NAV 3.0, or the fact that Symantec has bought Certus has
caused the death of a good product, so I won't comment on that.

Now, the story with Untouchable. A shame, really. :-(

> of these programs?  Is Symantec going to incorporate some of their
> features into NAV or are they just going to let it die out?  Please

It was my understanding that they at least intended to do so. I wish
to hope that they will reconsider dropping the excellent technology
that is in their hands.

> let us know so I can tell my husband to get a refund, we don`t want
> to be stuck with NAV.

That's a wise solution. BTW, you can still use the integrity checker
from Untouchable. Just combine it with another scanner - F-Prot is
almost free. (Actually, it -is- free for individual use.) The good
thing with the integrity checkers is that they almost don't need
updating... And the integrity checker in Untouchable is the best and
most secure I have ever seen.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Sat, 13 Nov 93 14:13:18 -0500
From:    manas <SANYALM@CNSVAX.UWEC.EDU>
Subject: Removing the Moctezuma virus (PC)

I was trying to get rid of the Moctezuma virus. The virus infected just the
three .exe files on the disk.
It was not deteted by VPCScan V2.2.
CLEAN 9.17 V106 couldn't remove it.
I used Norton AntiVirus V2.2 and that wouldn't remove it either.
What can I use to get rid of the virus without having to delete the files?

Thanks,
Manas Sanyal <sanyalm@cnsvax.uwec.edu>

------------------------------

Date:    Sat, 13 Nov 93 17:01:36 -0500
From:    int877w@lindblat.cc.monash.edu.au (William Fang)
Subject: Re: Full version of AVP 1.07 available (PC)

Vesselin Bontchev (bontchev@fbihh.informatik.uni-hamburg.de) wrote:
: Hello, everybody!

: I have received from the Russian anti-virus researcher Eugene
: Kaspersky the full (professional) version of his package AVP 1.07 and
: have made it available on our ftp site. The older versions of the
: package have been deteleted. The full reference of the achive that
: contains the package is

I've downloaded the file, did a scan using scan 9.19 v108 and
f-prot 2.09f just to make sure I didn't bring any viruses with
the latest batch of downloads (no offence, I got a whole heap
of junk, not just your files ;-)

Anyway, started the program on the Temp partition and it asked
for V_930915.-VB which I assumed was the database it was complaining
about.  I renamed the V_931105.-VB file and it seemed to work.
Should I have V_930915.-VB or does renaming the new (? I guess) file
work.  Or is there a switch I'm meant to be using to use the newer
database?

I've done a quick look through the manual, but didn't stumble
across on anything on the name of the database, just how to do
fancy stuff using the pro version, and as a non-programmer, had
no idea what it was about.

= Jim

------------------------------

Date:    Sat, 13 Nov 93 22:43:41 -0500
From:    bmorris@netcom.com (Bob MorrisG)
Subject: Re: Automated virus scan every n days ? (PC)

Jeff Lawrence (jlaw@irus.rri.uwo.ca) wrote:
: What I am looking for is a program/autoexec code
: that will execute F-PROT and SCAN only once on say Thursday and then ignore

Norton NDOS substitute for COMMAND.COM, among other things, allows for
BAT file commands that can detect Day of Week.  There's a number of other
shareware utils that can also.  Silicon Frog ( strange name, good bat utils)
can do it too.
- --
Bob Morris
bmorris@netcom.com

------------------------------

Date:    Sun, 14 Nov 93 10:46:04 -0500
From:    Jeff Auman <JDA108@PSUVM.PSU.EDU>
Subject: Re: [Q] Cross-linked files => virus? (PC)

wbg@festival.ed.ac.uk (W Geake) says:
>
>I've been trying to sort out a PC with LOTS of cross-linked fiels, using
>utilities such as BNorton Disk Doctor, CHKDSK, etc.  I got rid of them
>all, and left the PC to it's user's tender care.  He used it for a
>couple of days and the cross-linking has returned.
>
>I ran a check with F-Prot 2.09D (August 1993) and it detected no virus,
>or indeed anything suspect - might it have been duped?
>
>The usage of this PC makes it vulnerable to attack - lots of floppies
>from other, public access machines.
>
>Thanks for any advice,
>
>Bill.

Well couple things:

1)  I'm not sure what new viruses it detects, but try getting and scanning
    with the latest version of f-prot (2.09f).

2)  If the system this other person is using has a disk cache installed
    with write caching turned on, he may be inadvertently shutting off
    the computer before the cache has had time to completely write out
    its contents.  This has (for me) caused files to be cross-linked
    in the suspicious manner you mentioned.

3)  You have a hardware problem.  I'd take a closer look at the system tho
    before jumping to this conclusion.  If the problem is intermittent,
    the likelihood of a bad drive/controller goes does.  Good luck.

- -Jeff

------------------------------

Date:    Sun, 14 Nov 93 16:01:01 -0500
From:    Ted.Wong@cornell.edu (Ted Wong)
Subject: Re: [Q] Cross-linked files => virus? (PC)

wbg@festival.ed.ac.uk (W Geake) writes:

>I've been trying to sort out a PC with LOTS of cross-linked fiels, using
>utilities such as BNorton Disk Doctor, CHKDSK, etc.  I got rid of them
>all, and left the PC to it's user's tender care.  He used it for a
>couple of days and the cross-linking has returned.

One of the anti-virus gurus could confirm whether a virus can cause
extensive cross-linking. However, cross-linking can be caused by other
means - I crashed my disk and cross-linked hundreds of files when I tried to
run Wolfenstein 3-D under Windows 3.1. Check to see if some other piece of
software which does low-level disk access isn't scrambling the disk.

Ted Wong
- -----------------------------------------------------------------------------
Ted Wong                                                   <tmw5@cornell.edu>
Cornell University
- -----------------------------------------------------------------------------

------------------------------

Date:    Sun, 14 Nov 93 22:58:00 +0000
From:    l_decar@pavo.concordia.ca (Lucas C. Ferreira)
Subject: Frisk's name in a virus (PC)

Vesselin Bontchev (bontchev@fbihh.informatik.uni-hamburg.de) writes:

>As a matter of fact, I don't recall to have seen Frisk's name in a
>virus. Maybe the virus writers respect him more, because he offers an
>excellent product essentially for free... :-)

In early 1993, in Brazil, we found a new virus that contained the strings:
"Frisk" and "Hi Fridrik!". It was polimorphic and also contained the
string "Freddy 2.1", so we called it freddy 2 or freddy 2.1.

Lucas de Carvalho Ferreira
Comp. Sci. student (undergrad.)
Concordia University - Montreal
E-mail adresses: L_DECAR@pavo.concordia.ca
                 sapao@dcc.ufmg.br         (forward to the other address)

------------------------------

Date:    Mon, 15 Nov 93 04:00:18 -0500
From:    S.M.Baines@sheffield.ac.uk
Subject: Hiding viruses in documents (PC)

I recently found a shareware program (if forget which) that when
unzipped only had a single file. A document file. When opened in Word
for Windows it had about the program and a icon to double click on to
install the program. The program was inside the document. I thought
about whether my virus scanner could scan for viruses inside such a
file and did to scan all. I later thought whether it would be
possible to hide one in it, and not be detected. I tried this by
putting in a file infected with Maltese Amoeba (rife at the
university here) into a document. Packager neatly packaged it inside
the document. On scanning the file no virus was found.

I am now thinking that this method of installation would make it an
easy way to distribute a virus, and scanning the package before
installation would have no effect. Once run it will most likely of
infected most of Windows.

Stephen Baines
======================================================================
| Stephen Baines                     | "If religion is the opium of  |
| e-mail: S.M.BAINES@SHEFFIELD.AC.UK | of the people, then the CofE  |
| Snail Mail: RANMOOR HOUSE,         | must be the Diazepam of the   |
|             SHORE LANE,            | people."                      |
|             SHEFFIELD,             |                               |
|             S10 3AY,               |  Jeremy Hardy. Comedian       |
|             ENGLAND                |                               |
======================================================================

------------------------------

Date:    Mon, 15 Nov 93 04:37:10 -0500
From:    Tim Folkard <tim@not-ihr.mrc.ac.uk>
Subject: Re: Automated virus scan every n days ? (PC)

I use a DOS version of the Unix 'find' utility...

  find \etc -name vircheck.dte -mtime +2 -exec touch {} ; -exec f-prot c: ;

I.e.
 "Look in the \ETC directory for a file called VIRCHECK.DTE that is more
  than two days old; if found, update its time-stamp, then run F-PROT on
  drive C:"

Various PD/shareware versions of 'find' are available, but don't ask me where!

------------------------------

Date:    Fri, 12 Nov 93 18:31:21 -0500
From:    vfreak@aol.com
Subject: November 1993 LAT (PC)

                       LAT 9311   November 12, 1993

 +--------------------------+----------+---------+-----------+-----+
 | SCANNER                  |  COMMON  |  POLY-  |    ZOO    |FLAGS|
 |                          |          | MORPHIC |           |     |
 |                          |          |         |           |     |
 |                          |38        |56       |1518   1470|     |
 +--------------------------+----------+---------+-----------+-----+
 | Integrity Master 211     |38   100% |56  100% |1503  99.0%| GS  |
 | TBAV 608                 |38   100% |55  98.2%|1496  98.6%| GS  |
 | F-Prot 2.09F             |38   100% |56  100% |1481  97.6%| S   |
 |                          |          |         |           |     |
 | VIRx 2.91                |36   94.7%|35  62.5%|1438  94.7%| S   |
 | Scan 108                 |38   100% |52  92.9%|1403  92.4%| S   |
 | Dr Sol A-V toolkit 6.20  |37   97.4%|30  53.6%|1365  89.9%| C   |
 |                          |          |         |           |     |
 | NAV 3.0                  |38   100% |53  94.6%|1332  87.8%| C   |
 | MSAV w/DOS 6.0           |28   75.7%|17  30.4%| 915  62.2%| D   |
 +--------------------------+----------+---------+-----------+-----+

      C- Commercial software

      D- This product does not scan for boot sector viruses inside
         droppers. This is why scanners that detect droppers were tested
         against 1335 viruses. Scanners that fail to detect droppers were
         tested against 1470 viruses. I tried to be fair.

      G- Generic Virus detector. The other utilities with this product may
         detect viruses that this scanner misses, so don't judge this
         product too harshly because the scanner isn't as effective as you
         would like.

      S- Share Ware or Free Ware procuct.

 ========================================================================
      I have tested the following generic products, and
      recommend them.

                                                      FLAGS
                                                     +------+
      F-Prot Professional (Command Software Systems) | IV   |
      Integrity Master (Stiller Research)            |*ISV  |
      PC-cillin (Trend Micro Devices)                | ASV  |
      PC-Rx (Trend Micro Devices)                    | ASV  |
      TBAV (Thunderbyte)                             |*ISV  |
      Untouchable (Fifth Generation Systems)         | ISV  |
      Victor Charlie (Bangkok Security Associates)   |*BEISV|
                                                     +------+
             *-Share ware product
             A-Activity Monitor
             B-Uses Bait files that try to get infected by unknown viruses
             E-extract the signatures for unknown viruses
             I-uses integrity checking
             S-Stores System areas. Boot sector, and Partition table
             V-comes with a Virus scanner.

      I placed the generic virus detectors in alphabetical order. I do not
      recommend one product over another. All of them work differently and
      may not fit the way you use a computer, so request information on
      several before you decide.
 ========================================================================
      I would like to thank most of these companies for providing me with
      evaluation copies of their software to test.

      If your company produces anti-viral software, and would like for me
      to test it in LAT, contact me at either of the addresses below.
 ========================================================================
      These tests were performed on a 33 MHZ 486

                        Bill Lambdin
                        102 Jones Lane
                        P.O. Box 577
                        East Bernstadt, Ky. 40729

                 Internet address> v.freak@aol.com

                 Metaverse BBS Co-SysOp (606) 843-9363

------------------------------

Date:    Sat, 13 Nov 93 21:16:27 -0500
From:    "Rob Slade" <roberts@decus.ca>
Subject: Save all you can (CVP)

BEGPAN3.CVP   931015

                         Save What You Can

OK.  Maybe we don't yet know what is wrong, but if the computer is
still running, we can start some salvage operations.  Let's do a
backup.

You did one just yesterday?  Great!  Let's just check it to make
sure.  Try to "restore" one of the files - a data file, for example
- - preferably to another computer (hopefully one that isn't
infected).  If the operation goes smoothly, and the file checks out
OK once restored, then you can go on to the next section (1.2) on
how to get started with the recovery.

The reason for checking out the backup is that some viral programs,
boot sector infectors especially, can ruin diskettes, or at least
the data on them. Some backup programs, particularly the fancier,
commercial ones, use a proprietary disk format to speed up the
process and cram more stuff onto each disk.  If those specially
formatted disks get infected with a boot sector infector which
expects a standard DOS disk, the backup could be corrupted.

When we do our backup, then, let's not get fancy.  Use a simple
method.  Wherever possible - as simple as copying each file,
individually, if you can.

What?  Copy each individual file for Windows and all your Windows
apps?  No.  Don't bother with the programs.  If it turns out that a
bunch of your programs are infected, the best thing to do, anyways,
is erase and re-install them.  Besides, the programs aren't the
valuable parts.  How much did that really extravagant database
program cost you, anyway?  $500?  Even if you don't have the
original disks to install it again, you can run down to the store
and get another tomorrow.  It's only money.  Ah, but your client
file.  *That* you've been working on for five years; more, if you
count all the time spent on it before you got the computer.  How
many hours would it take you to re-enter all that data?  Do you even
*have* all the bits and pieces written down in other places?  You
can't go down to the store and buy another copy of that file, so
that is what you should be backing up.  It's your data that is
really the valuable part of the system, not the programs.  And,
funnily enough, your data probably takes less time to backup.

If you are on a network, backing up can be as simple as copying all
your data onto the server.  This is especially so if the server is a
different type of machine (eg. you are working on a PC or Mac, and
the server is a VAX).  Don't worry if the system operators yell at
you for exceeding quota:  this is an emergency, and they are always
yelling at somebody, anyway.

Of course, the best solution is to back up both ways.  Redundant
backup, it's called.  Poor choice of words.  If something crashes, a
backup is *never* redundant.

copyright Robert M. Slade, 1993   BEGPAN3.CVP  931015

=============
Vancouver      ROBERTS@decus.ca         | Lotteries are a tax
Institute for  Robert_Slade@sfu.ca      | on the arithmetically
Research into  rslade@cue.bc.ca         | impaired.
User           p1@CyberStore.ca         |
Security       Canada V7K 2G6           |

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 149]
******************************************

