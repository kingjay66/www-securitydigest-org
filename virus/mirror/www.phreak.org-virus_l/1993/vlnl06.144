VIRUS-L Digest   Friday,  5 Nov 1993    Volume 6 : Issue 144

Today's Topics:

New Mac Virus Announcement -- CODE-1, MBDF-B (Mac)
McAFEE Quarterly newsletter
Re: Automated virus scan every n days ? (PC)
Bugs in MS Anti-virus? (PC)
Re: Automated virus scan every n days ? (PC)
FORM virus on IBM PC (PC)
PD version MSDOS.SYS and IO.SYS ? (PC)
Removing Boot Sector Viruses from Floppies (PC)
Re: 1837 bytes 9E 10 16 ... (PC)
PD replacement for MSDOS.SYS and IO.SYS
Re: *HELP*--Possible Virus? (PC)
Re: Looking for Info.:ANNOINT VIRUS (PC)
Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)
Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)
Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)
Information requested on "youth" virus on MS-DOS machines (PC)
Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)
Re: MtE virus...what does it do? (PC)
Infected - 64BLASER.ZIP (PC)
Anti Virus Software (PC)
re: Commercial Virus Scanners in the dark??? (PC)
False Aragon Virus (PC)
current version of F-Prot (PC)
Antiviral popularity contests (CVP)
Re: GS.ZIP availability (PC)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Thu, 04 Nov 93 17:05:04 -0500
From:    spaf@cs.purdue.edu
Subject: New Mac Virus Announcement -- CODE-1, MBDF-B (Mac)

This is NOT an official posting from the PCERT.

	   New Macintosh Viruses Discovered (CODE-1 & MBDF-B)
			      4 Nov 1993

Virus: CODE-1
Damage: Alters applications and system file; may rename hard disk;
	may crash system or damage some files.  See below.
Spread: possibly limited, but has potential to spread quickly
Systems affected: All Apple Macintosh computers, under Systems 6 & 7.

Several sites have reported instances of a new Macintosh virus on
their systems.  This virus spreads to application programs and the
system file.  Its only explicit action, other than spreading, is to
rename the hard disk to "Trent Saburo" if the system is restarted on
October 31 of any year.  However, the virus changes several internal
code pointers that may be set by various extensions and updates.  This
may lead to system failures, failures of applications to run
correctly, and other problems.  Under some conditions the virus may
cause the system to crash.

The virus detected by some virus protection programs on some Macintosh
machines (but no anti-virus program released prior to this date
specifically recognizes this virus).  This behavior depends on the
nature of the hardware and software configuration of the infected
machine.  All current anti-virus programs should be updated to the
versions listed below to ensure that the virus can be found.

Virus: MBDF-B
Damage: minimal, but see below
Spread: probably limited
Systems affected:  Apple Macintosh computers.  The virus spreads on
                   all types of Macs except MacPlus systems and
                   (perhaps) SE systems; it may be present on MacPlus
                   and SE systems and not spread, however.

A new variant of the MBDF-A virus has recently been discovered.  It
seems that a person or persons unknown has modified the original
MBDF-A virus slightly and released it. Like the original, this virus
does not intentionally cause damage, but it may spread widely.

The virus does not necessarily exhibit any symptoms on infected
systems.  Some abnormal behavior has been reported in machines
infected with MBDF-A, involving system crashes and malfunctions in
various programs, which may possibly be traced to the virus.  Some
specific symptoms include:
    * Infected Claris applications will indicate that they have
      been altered
    * The "BeHierarchic" shareware program ceases to work correctly.
    * Some programs will crash if something in the menu
      bar is selected with the mouse.
The MBDF-B virus should behave similarly and will spread under both
System 6 and System 7.

Some Mac anti-virus tools will detect this virus.  However, all
anti-virus tools should be updated so as to properly identify and
remove this virus from infected systems.

The authors of all major Macintosh anti-virus tools are planning
updates to their tools to locate and/or eliminate these viruses. Some
of these are listed below. We recommend that you obtain and use a
CURRENT version of AT LEAST ONE of these programs.

Some specific information on updated Mac anti-virus products follows:

    Tool: Central Point Anti-Virus
    Status: Commercial software
    Revision to be released: 3.0a
    Where to find: Central Point BBS, (503) 690-6650
    When available: November 5, 1993
    Comments: Registered users will receive postcards. Also, users can
	      download the file 'Mac CPAV Antidotes 11/5/93' from the
              usual places to receive the update.

    Tool: Disinfectant
    Status: Free software (courtesy of Northwestern University and
		John Norstad)
    Revision to be released: 3.3
    When available: November 5, 1993
    Where to find: usual archive sites and bulletin boards --
	           ftp.acns.nwu.edu, sumex-aim.stanford.edu,
                   rascal.ics.utexas.edu, AppleLink, America Online,
                   CompuServe, Genie, Calvacom, MacNet, Delphi,
                   comp.binaries.mac

    Tool: Gatekeeper
    Status: Free software (courtesy of Chris Johnson)
    Revision to be released: 1.2.9
    When available: November 8, 1993
    Where to find: usual archive sites and bulletin boards --
	           microlib.cc.utexas.edu, sumex-aim.stanford.edu,
                   rascal.ics.utexas.edu, comp.binaries.mac
    Comments: 1.2.8 is already effective against MBDF-B. Gatekeeper Aid will
              identify it as an "Unknown Strain" of MBDF, but will remove it
              without difficulty.

    Tool: Rival
    Status: Commercial software
    Revision to be released: CODE-1 Vaccine
    When available: Immediately.
    Where to find: AppleLink, America Online, Calvacom, Compuserve, Internet
                   XELPH's Customer Service @ 415/327-9563
    When available: immediately
    Comments: The vaccine will be e-mailed to all registered users.
    Comments: The existing Rival MBDF Vaccine already detects/removes MBDF-B.

    Tool: SAM (Virus Clinic and Intercept)
    Status: Commercial software
    Revision to be released:  3.5.9
    When available: November 5, 1993
    Where to find: CompuServe, America Online, Applelink, Symantec's
                   Customer Service @ 800-441-7234
    Comments: Updates to various versions of SAM to detect and remove
          CODE-1 and MBDF-B are available from the above sources.

    Tool: Virex
    Status: Commercial software
    Revision to be released: 4.1
    Where to find: Datawatch Corporation, (919) 549-0711
    When available: November 5, 1993
    Comments: Datawatch's BBS number is (919) 549-0042
    Comments: Virex currently detects and repairs the MBDF-B virus but
	      identifies it as the MBDF-A virus.
    Comments: UDV for CODE-1 virus; Guide Number = 13656448
	      1:	020A 30FA 7D90 7610	/ 8C
	      2:	00A9 C60C AF00 0A00	/ F1
	      3:	3EA0 0B4E 7581 8090	/ 59

    Tool: VirusDetective
    Status: Shareware
    Revision to be released: 5.0.10
    When available: immediately
    Where to find: various Mac archives
    Comments: VirusDetective is shareware.  Search strings for the CODE-1
           virus will be sent only to registered users via e-mail.
	   Registered users without e-mail access should contact the
	   author for the search string.  The MBDF-B virus is already
	   detected by the MBDF-A search string.

If you discover what you believe to be a virus on your Macintosh
system, please report it to the vendor/author of your anti-virus
software package for analysis.  Such reports make early, informed
warnings like this one possible for the rest of the Mac community.  If
you are otherwise unsure of who to contact, you may send e-mail to
spaf@cs.purdue.edu as an initial point of contact.

Also, be aware that writing and releasing computer viruses is more
than a rude and damaging act of vandalism -- it is also a violation of
many state and Federal laws in the US, and illegal in several other
countries.  If you have *ANY* information concerning the author(s) of
these or any other computer virus, please contact any of the
anti-virus providers listed above.  Several Mac virus authors have
been apprehended thanks to the efforts of the Mac user community, and
some have received criminal convictions for their actions.  This is
yet one more way to help protect your computers.

------------------------------

Date:    Tue, 02 Nov 93 21:48:46 -0500
From:    adamr@netcom.com (Adam Rodgers)
Subject: McAFEE Quarterly newsletter

Does anyone know where I can find past issue's of the Virus newsletter?
Also, is there a mailing list on the internet I can subscribe to?

Thanx,

- ---------------------------------------------------------------------------
Adam Rodgers                              |
Lead Systems Engineer /CNE                | If you don't know the fact's,
Storage Dimensions (408) 954-0710         |     Your just another guy with
adamr@xstor.com   <--- Storage Dimensions |         an opinion....
adamr@netcom.com  <--- Personal Account   |
- ---------------------------------------------------------------------------

------------------------------

Date:    Tue, 02 Nov 93 14:23:30 -0500
From:    <RADAI@vms.huji.ac.il>
Subject: Re: Automated virus scan every n days ? (PC)

> From:    jlaw@irus.rri.uwo.ca (Jeff Lawrence)
>
> I'm trying to solve a problem with my PC. I presently have SCANV and
> FPROT on my system. What I am looking for is a program/autoexec code
> that will execute F-PROT and SCAN only once on say Thursday and then ignore
> all other boots until the following week, etc. I had some code from
> PC Magazine's USER-TO-USER (I think) from last year but it did not
> work properly. Is there such a beast out there? Please mail all repsonses
> to jlaw@irus.rri.uwo.ca.

There's a program called EVERY, which does just that.  It can be
obtained from any Simtel20 mirror, under msdos/batutl/every15.zip .
(I haven't actually used it, but I know the author, and he's very
reliable.)  What I have used in the past is a program called TIMERUN.
It's part of a commercial package, but I have permission from the
authors to distribute this program if someone needs it.

                                     Y. Radai
                                     Hebrew Univ. of Jerusalem, Israel
                                     RADAI@HUJIVMS.BITNET
                                     RADAI@VMS.HUJI.AC.IL

------------------------------

Date:    Tue, 02 Nov 93 20:47:56 -0500
From:    pchen@mtu.edu (CHEN)
Subject: Bugs in MS Anti-virus? (PC)

Hi there,
Recently I decided to upgrade my virus signature file for my MS Anti-virus
for Windows. I downloaded winav.exe from Central Points BBS site.
After unpacking, I moved generated mwavscan.dll and msavirus.lst to
dos directory. Then I ran mwav from within Windows as indicated by
the companion text file. However I got following error message when
mwav scanning a big font file (1.2m)

	Application error
MWAV caused a General Protection Fault
in module MWAVSCAN.DLL at 0001:083E

Since I never had any problem with my old mwav.exe, I am wondering
whether there are bugs in this release.
Any comments?

By the way, my old anti-virus program came with dos6.0, which
was dated Feb. 12, 93. The one I downloaded was dated Aug. 4, 93.

Please reply by e-mail since I am not a regular reader of this group.

pchen@mtu.edu

- --

------------------------------

Date:    Tue, 02 Nov 93 22:22:40 -0500
From:    dbs4331@rigel.tamu.edu (Dan Sline)
Subject: Re: Automated virus scan every n days ? (PC)

jlaw@irus.rri.uwo.ca (Jeff Lawrence) writes...
>I'm trying to solve a problem with my PC. I presently have SCANV and
>FPROT on my system. What I am looking for is a program/autoexec code
>that will execute F-PROT and SCAN only once on say Thursday and then ignore
>all other boots until the following week, etc. I had some code from
>PC Magazine's USER-TO-USER (I think) from last year but it did not
>work properly. Is there such a beast out there? Please mail all repsonses
>to jlaw@irus.rri.uwo.ca.

Jeff,

	I am currently developing a program that will do exactly what you are
looking for.  If you or anyone else on the net would like a beta copy or has
any questions just send me email (Sliner@tamu.edu).

	This program is not written to a particular virus program, so it will
work with Scan, F-prot, and any other anti-virus program (although it was geared
for programs that use command line arguments.

Hope this helps,

Dan Sline

Bitnet:     DBS4331@tamvenus  sliner@drycas (secondary address)
Internet:   sliner@tamu.edu sliner@drycas.club.cc.cmu.edu
Compuserve: 71161,1455
voicenet:  409-693-8730
The opinions expressed above are my own.

------------------------------

Date:    Tue, 02 Nov 93 23:46:59 -0500
From:    "John M. Clark" <c2mxcla@fre.fsu.umd.edu>
Subject: FORM virus on IBM PC (PC)

   The IBM clones at my college were recently hit by the "Form" virus.
Does anyone have any information on what this virus does?  Is it a boot-sector
virus, .com or .exe infector, etc?  Does it actually destroy or just replicate?
I would appreciate any and all information.

John M. Clark
Internet:  c2mxcla@fre.fsu.umd.edu
           71644.3247@compuserve.com

Bitnet:    c2mxcla@towson.edu

------------------------------

Date:    Wed, 03 Nov 93 03:07:06 -0500
From:    linssenf@prl.philips.nl (Frank Linssen)
Subject: PD version MSDOS.SYS and IO.SYS ? (PC)

Hello netters,

Is there a public domain replacement for msdos.sys and io.sys ?
I want to create a bootable floppy for someone without giving away
my legal msdos copy.

Please reply by email to reduce bandwidth

Thanks,

Frank


- --
Frank Linssen     | Philips Research Laboratories
		  | Eindhoven. The Netherlands.
		  | e-mail : linssenf@prl.philips.nl SERI : linssenf:nlwayhp
		  | voice: +31-40-744091 fax: +31-40-744617

------------------------------

Date:    Wed, 03 Nov 93 09:25:48 -0500
From:    padgett@tccslr.dnet.mmc.com (A. Padgett Peterson)
Subject: Removing Boot Sector Viruses from Floppies (PC)

Vesselin replied to a question about boot sector virus removal from floppies:

>> Here is the problem, and I'd appreciate any help from the nets.  I
>> don't see how to clean off floppy disks since the boot sector remains.

>Just copy the files from them somewhere else (file-by-file, using COPY
>or XCOPY, -not- DISKCOPY), format the diskette and copy the files
>back. Or just SYS them, if there is enough space for a copy of DOS.

For some time I have been making available as FreeWare the program FixFBR
(found in the FixUtils along with NoFBoot and FixMBR). This program will
detect is a floppy has an "improper" signature and permits replacement
of the FBR with a custom "anti-viral" one.

It is designed to work about as fast as you can shuffle the floppies in
and out of the drive. If you accidently boot from a floppy it will tell
you and make some heuristic virus checks.

It will automatically detect the floppy type if the BPB is intact and will
ask if it is not (You should be able to tell which of the four main floppy
types you have (360k, 720k, 1.2M, 1.44M). Best of all, it is FreeWare.

Caveat: it defangs viruses by overwriting the FBR, if a virus has corrupted
other parts of the disk such as the directory, FixFBR cannot repair that but
has proven effective for every virus in my collection.

FixUtil6 is now out - look on urvax.urich.edu

					Warmly,
						Padgett

------------------------------

Date:    Wed, 03 Nov 93 09:46:03 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: 1837 bytes 9E 10 16 ... (PC)

Vesselin Bontchev (bontchev@fbihh.informatik.uni-hamburg.de) writes:

> Lutz Marten (marten@ilt.fhg.de) writes:

> > we found a virus (start pattern 9E 10 16 01 74 07 70 00 00 21 06 06
> > 00, length 1837 bytes) with the validate function of MacAfee 10.8 but
> > can't get rid of him with this MacAfee version. So can someone tell me
> > which virus it is and how to blow it out of the infected system ?

> I just scanned my whole virus collection for this scan string and no
> file contained it. It seems to be a new virus. I suggest you to send a
> copy to the anti-virus researchers for analysis.

It has just occured to me that maybe the original poster has simply
made some mistake when picking the scan string. In fact, we recently
received a virus from France, which is exactly 1837 bytes long and is
not detected by the scanners I have tried. (F-Prot's and TbScan's
heuristics detect it; F-Prot calls one of the replicants "possibly a
new or modified variant of PCBB or ARCV", but this is a wild guess,
which has nothing to do with the reality and is even not reliable for
detection - as I said, only one of the replicants is called like
that.)

The virus uses variable encryption, which would explain the problem of
selecting a good scan string. It is not polymorphic, however, so it
*is* possible to select such a string. Could the original poster check
whether the following will detect his samples:

01441D01 441F804C 1A00750C 8B4416A3 00018A44 18A20201 B42ACD21 3B542F75

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 03 Nov 93 10:16:34 -0500
From:    linssenf@prl.philips.nl (Frank Linssen)
Subject: PD replacement for MSDOS.SYS and IO.SYS

Hello netters,

Is there a public domain replacement for msdos.sys and io.sys ?
I want to create a bootable floppy for someone without giving away
my legal msdos copy.

Thanks,

Frank
- --
Frank Linssen     | Philips Research Laboratories
		  | Eindhoven. The Netherlands.
		  | e-mail : linssenf@prl.philips.nl SERI : linssenf:nlwayhp
		  | voice: +31-40-744091 fax: +31-40-744617

------------------------------

Date:    Wed, 03 Nov 93 10:20:16 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: *HELP*--Possible Virus? (PC)

bc1f_067@uwpg02.uwinnipeg.ca (bc1f_067@uwpg02.uwinnipeg.ca) writes:

> I'm using a 496DX2 IBM compatiblerunning MS-DOS 6 with a TVGA89-blah card.
> Occasionally, when i power up,nothing happens on the screen.  The power ligh
> is on, the fan is going, butthere are no Power On Self Tests (memory, drive
> check, ect...).  This is remedied by hard-booting.  I was told that this was
> most likely caused by a bad BIOS chip, but, i can hear my hard disk work for
> approx. 2-3 seconds when i power up.  It is only when this happens that the
> screen blanks.

The above sounds more like a hardware problem to me than like a
problem caused by a virus.

> I've run the three virus checkers that i own, CP Antvir, Manitoba Hydro scan
> and Msav.  Cp hangs, Manitoba Hydro doesn't find my boot record, and Msav
> detects nothing.  Any help would be appreciated.

Can't really help you and even don't know what "Manitoba Hydro scan"
is, but would like to point out that MSAV is just a restricted version
of CPAV, so it is useless to use both scanners.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 03 Nov 93 10:20:27 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Looking for Info.:ANNOINT VIRUS (PC)

thull@skidmore.edu (thull@skidmore.edu) writes:

> Several universities in our area have had a sudden attack of the virus known
> as ANNOINT. Anyone have experience with this virus? Any information

Please read the FAQ for information about how to ask such questions.
In particular, I am not aware of any virus called like that, and since
you have not specified the scanner and its version that has reported
this name, I can't verify whether it calls like that one of the
viruses I have under different names.

The closestly sounding name I can think of is No_INT - this is a
stealth variant of Stoned - but I can't be sure until you provide more
information.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 03 Nov 93 10:37:44 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)

Eric_N._Florack.cru-mc@xerox.com (Eric_N._Florack.cru-mc@xerox.com) writes:

> Ya know, I`ve always been hazy on this point, at least. Why does should a
> scanner /have/ to open a file? Could an effective string serach be done at t
> DISK level, such as what such utils as NDD do? Sector by sector, it would be
> and it would require that the whole disk be done, as opposed to just one fil

There are two problems with the scheme proposed above. First, if the
scan string is found in a sector, the scanner will have to figure out
whether this sector belongs to a file. This is far from a trivial
task, see below.

Second, most scanners nowadays don't scan plainly the whole file.
Instead, they look only at particular offsets from the file entry
point - where the virus is likely to be. And, in order to figure out
the file entry point, you'll have to open the file.

> Sure, the program would have to keep track of what file such and such a sect
> is assigned to, but it should be able to do this by using the FAT as a data
> file, thereby avoiding the opening of ANY files, except the scanning EXE
> itself.

Yes, this is related to the first of the problems I mentioned. The
structure of the FAT is such that it is easy to determine which
sectors belong to a file. However, solving the opposite task -
determining whether a sector belongs to a file and to which file
exactly - cannot be solved in a fast and effective way. It -is-
solvable, but the solution is rather slow, because it involves
scanning the whole FAT (instead of simply indexing it). And this will
give you only the answer to the question whether the cluster
containing the sector belongs to a file. Even it does, this does not
necessarily mean that the sector belongs to the file - it could be
part of the unused space in the last cluster. In order to determine
that, you'll have to read also the directory information for that file
and to interpret it. In short, the solution will be rather slow and
your users are likely to select your competitor's scanner, which is
much faster... :-)

Note that your analogy with NDD is not very exact, because it doesn't
do exactly that. Yes, it does have to solve the "reverse" task, but
only from time to time, when a sector is found to be bad, which
doesn't happen often. Compare this with a heavily infected system
where each executable is infected.

So, in general, your idea is not impossible to implement, but would
not be very effective.

There is a different idea, however, which -can- be used (and is used
by e.g., TbScan) and which does improve system performance and reduces
the threat of having an active fast infector in memory to infect all
files that are being scanned. The idea consists of not opening the
files using the normal DOS function calls, but interpretting the
FAT/directory information for them "manually", determining which
sectors they occupy (this is fast as opposed to the reverse task) and
then scan only those sectors. Of course, this works only on "normal"
disks that support sector access (INT 13h, INT 25h, block device
driver requests - depending on how low are you willing to go) - you
can't use that trick on networked drives, for instance.

> Or am I sideways, here?

More like backwards... :-)

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 03 Nov 93 13:17:59 -0500
From:    frisk@complex.is (Fridrik Skulason)
Subject: Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)

Eric_N._Florack.cru-mc@xerox.com writes:

>Ya know, I`ve always been hazy on this point, at least. Why does should a
>scanner /have/ to open a file? Could an effective string serach be done at the
>DISK level, such as what such utils as NDD do? Sector by sector, it would be;
>and it would require that the whole disk be done, as opposed to just one file.

Well, the answer is "yes and no".  Some scanners do indeed work like this,
but there are problems in "non-standard" situations:

   * when running under OS/2

   * when running in a DOS emulation on UNIX machines

   * when scanning compressed disks

   * when scanning network drives

And finally - A stealth virus can operate at the INT 13H level, instead of
intercepting INT 21H calls.

- -frisk

------------------------------

Date:    Wed, 03 Nov 93 13:45:10 -0500
From:    maloned@itdsrv1.ul.ie (Declan Malone)
Subject: Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)

Eric_N._Florack.cru-mc@xerox.com wrote:
>    Ya know, I`ve always been hazy on this point, at least. Why does
> should a scanner /have/ to open a file? Could an effective string
> serach be done at the DISK level, such as what such utils as NDD do?
> Sector by sector, it would be; and it would require that the whole
> disk be done, as opposed to just one file.
>
>  Sure, the program would have to keep track of what file such and such
> a sector is assigned to, but it should be able to do this by using the
> FAT as a data file, thereby avoiding the opening of ANY files, except
> the scanning EXE itself.

You'd definitely have to do more than just a sector-by-sector search.
As you said, you'll have to access the FAT. More than just keeping
track of which file you're looking at (and you'll need to look at
directory entries as well as just the FAT to find that, wont you?)
you'll have to consider the possibility of a virus signature (I take
it you're talking about a sig scanner) straddling a sector boundary.

What it boils down to is emulating more or less the entire operation
involved in accessing files with handles within DOS. You'll have to
find the start sector of each file & examine each sector in order,
paying attention to signatures that start in one sector and continue
in the next. As for heuristic scanners it wouldn't, IMHO, be practical
to go down to the sector level. You really want to get an image of the
target file, or a window within it. But there's no real advantage
AFAICS in going down to sector level and ignoring the handy (sorry)
handle functions available. In both heuristic and signature searches
you need to know what sector comes after what *before* you start
scanning and use that to guide you in what sector to read next. Yes,
you can do it without opening a file, but why bother?

just MHO,
Declan
- --
- ---
I'm filling in the negative space with positively everything.

------------------------------

Date:    Wed, 03 Nov 93 19:31:28 -0500
From:    EBERHARDY PETER - S93 <eberh_p@cowley.uwlax.edu>
Subject: Information requested on "youth" virus on MS-DOS machines (PC)

I have heard of a small outbreak of the "youth" virus on my
university campus.  It is not any kind of epidemic (yet)(thank god).

I have not been able to confirm any information I have received but
have been told is is quite a bit nastier than "stoned" or "monkey".

As I may eventually become involved in some eradication of this virus
I would like some information about how "youth" works and how to
clean both floppies and hard drives.

Please forgive me if this is a "youth" is a lousy synonym for another
virus, I'm just trying to get information about it ahead of time.

- ---
Peter Eberhardy                  Internet: eberhard@uwlax.edu
129B Sanford Hall              NeXT: eberh_p@cowley.uwlax.edu
U of Wisconsin-La Crosse                Phone: (608) 789-2867

------------------------------

Date:    Wed, 03 Nov 93 20:56:16 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Satan Bug, et al; VIRUS-L Digest V6 #140 (PC)

>Ya know, I`ve always been hazy on this point, at least. Why does should a
>scanner /have/ to open a file? Could an effective string serach be done at the
>DISK level, such as what such utils as NDD do? Sector by sector, it would be;
>and it would require that the whole disk be done, as opposed to just one file.
>
>Sure, the program would have to keep track of what file such and such a sector
>is assigned to, but it should be able to do this by using the FAT as a data
>file, thereby avoiding the opening of ANY files, except the scanning EXE
>itself.
>

This would be a royal pain in the butt.  If a brute force disk scan (NDD
like) was used, then you scan a whole disk, and every sector, inc.
sectors which contain data files. It'd be slow, and you would no doubt
get tons of false id's from scanning bits and pieces of data files, vs.
executable (Such as a graphics image.  Sure, you COULD execute it, but it'd
crtash, and it's def. not made to be executed...)

If you are talking about simply following pointers, interpreting the FAT,
and following all the pointers along the way to where all the file exists,
this is possible, but would be very time consuming to write.  It'd be like
re-writing routines already written for you with DOS... So long as you
don't use the various interrupts to open a file, you wouldn't infect it.

It is still difficult to interpret all of the program.  For example,
when you execute a 2.5K file, the whole cluter the last bits of the prg are
in are read in.  Some virus scanners use the actual file size to go backwards
and scan from a point from the end of the file.  This would not be the case,
unless the filesize was known, and if the filesize was reported and a
stealth virus were active in memory, it would not seek to the
proper point in it's buffer.

Since this conversation came up in Satan Bug discussion -- either
way, the virus is polymorphic and encrypted, it will not help detect the
virus (though it would not spread it when scanning...)

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Wed, 03 Nov 93 21:03:09 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: MtE virus...what does it do? (PC)

>In my tests, the latest versions of McAfee's SCAN were able to detect

Outdated versions of SCAN are unable to detect these reliably.  (well,
reasonably recent ones, but nonetheless..)

>the MtE-based viruses reliably. CPAV also has reasonably good
>detection, although it is not 100% reliable. I don't know what PC
>Virus is, but if you mean PC Vaccine Professional, it is also able to

CPAV's most recent version does not reliably detect MtE based viruses.
Pc Vaccine Prof. didn't reliably detect MtE viruses in outdated versions,
either.

>detect the MtE reliably. As opposed to that, NAV up to and including
>version 2.1 is known to have unreliable detection of the MtE-based
>viruses. The older versions of the virus definitions were also known
>to cause false positives.

And, of course, outdated versions of NAV do not reliably detect MtE
based viruses.  Recent versions, do.

Hell, while we're at the version number game, why not go off on V2Px,
or Whale, or the Vius that hasn't been made yet discussion, eh?

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Thu, 04 Nov 93 03:05:11 -0500
From:    vfreak@aol.com
Subject: Infected - 64BLASER.ZIP (PC)

Brian O'Sullivan uploaded a suspect file to the Metaverse BBS
for me to examine. 64BLASER.ZIP. this was an IBM communication
program when calling BBSs run on the Commodore computers.

The real name for this communication software should be 64BLAZER.

64BLASER.ZIP is infected with a virus. Apparently a new or modified
variant of Math test.

The virus is 1136 bytes in length. A resident infector of .COM and
EXE files. The virus is encrypted So no text is visible in the
infected files. The virus is neither stealth nor polymorphic.

I will be sending a copy of this report, and more importantly, a
copy of the virus to the following A-V developers.

David Chess
Frisk
Wolfgang Stiller

Bill

------------------------------

Date:    Tue, 19 Oct 93 19:19:37 -0400
From:    lucifer@pcscav.com (Chris Boyd)
Subject: Anti Virus Software (PC)

Me and a bunch of guys were sitting around, and thought of something
really odd.

With virus-l, comp.virus, alt.security, and all the other things
around about computer viruses, it should be painfully obvious to the
antivirus manufacturers that a lot of what they keep reselling doesn't
work.  Shareware vendors like Thunderbyte seem to be the only
companies that are really worried about stopping viruses.  How can you
tell?  Products like Scan keep getting fatter and slower, more and
more false alarms, and too finicky about what version of what virus is
there.  Many versions of the same virus can easily use the same clean
method, so it isn't necessary to make the difference.  In fact, scan
sometimes makes a mess and names a virus with two totally different
virus.  It would be interesting to clean those viruses using the name
that is incorrect, and see what happens.  Virex is one of the slowest,
most worthless virus scanners I have ever seen.  Even its
documentation looks like it was written by a 13 year old lamer.
Greenberg seems intent on making everybody think that _wormer_ is a
common used word.  Your a wormer, nya nya nya.  It sounds like a word
from a child's slang vocab.  Besides, a wormer would be someone who
makes worms, not viruses.  What a geek!  He lives off of his claim
that he wrote the first scan string scanner.  Doesn't anyone see that
it has the lowest hit rate, and the slowest scan rate to boot?  What
about CPAV.  More garbage.  Really slow, and a lot of misses.  The
MSAV is identical, so why bother updating it if you have dos 6.  MSAV
will use the CPAV signature files.  It makes me wonder why these
people are still so focussed on scan strings when products like
thunderbyte and Integrity Master prove that scan strings are only good
as a last resort.  FProt has at least addressed this.  It is a good
product, I suppose.  The people at McAfee and at Virex have chosen not
to upgrade their technology.  It is interesting when you call McAfee
on the phone.  They put you on hold.  For an experiment we called it
up, and when on hold, you hear a recording that says (over and over
again) that mcAfee is the leader in virus protection (phooo).  We
counted 47 times in one call!!!  No wonder people believe it.
Brainwash!

                                Lucifer Messiah -- ANARKICK SYSTEMS

- ---
lucifer@pcscav.com (Chris Boyd)
  PC Scavenger -- Computer Virus Research, Toronto CANADA (416)463-8384
  Free services: send EMAIL to info@pcscav.com or virus.list@pcscav.com

------------------------------

Date:    Tue, 02 Nov 93 13:08:11 -0500
From:    disruptor@pcscav.com (Chris Atkinson)
Subject: re: Commercial Virus Scanners in the dark??? (PC)

 Well, perhaps I should have been more precise in stating this opinion.
What I SHOULD have said was "Heuristics in combination with string
searching". I don't find that wildcards are that effective (As I virus
writer, I know this first hand) Wildcards are ok for a few cases of
viruses, but when you have variable length decryptors or variable length
code, wildcards don't really serve much of a purpose;

 Eg:

        AA BB CC DD ** FF GG HH II
 This would mean that all code is the same except for the wildcard **
which could be any value..

 What if the had relocatable code;

        BB GG II AA ** FF HH CC DD

 It wouldn't find a hit because everything has been re-arranged.
 Mind you, if you have multiple wildcard searches as with the Whale (28
different patterns if memory serves correct...), then it WILL be
effective in finding 28 different mutations of the code.

 What I think has to happen is that, as with FProt and Thunderbyte, there
has to be a trend towards tighter integration between traditional pattern
matching and heuristics. Mutation engines are becomming more advanced and
more readily available to the average virus writer and the potential for
the "Lotus 123 of Viruses" (Originally quoted by John Dvorak) to be
developed may come one day soon. How would a scanner pick up a virus that
can reside either as a parasite on a file or resides in the boot sector
or fat, has a mutation engine that makes sure no two bytes of code are
the same in each mutation, has variable length code between 1500 and 4000
bytes, uses file pointer manipulation, controls INT 13h and 21h at
boot-time, is totally stealth beyond DIR_II, 4096, and Pakistani Brain
methods, (Insert your own worst nightmare here), and yet allows your
system to function totally normally.

 All you virus authorities out there might agree with me that the day
when the "Supervirus" is developed may not be that far away. In the last
2 years, the virus world has seen many a nasty creation that were
unthought of 4 years ago... What nasty tricks will some hacker find next?

 I was a virus author, but decided that it was boring because, well,
maybe it was just a stage. I know my stuff, and I have used my progamming
knowledge in the past (Everything's relative ... :)  ) to try and give
you virus authorities a hard-time and you
've done a great job thwarting all my efforts as well as everyones effort
in continuing the spread of virus. Maybe this futility factor is what
made me stop, I don't know. But I have seen the light, and maybe I'm
blathering on mindlessly like this in hopes of helping someone make a
better antivirus product (to make up for all the damage I've caused???)

 The bottom line is, you've done a good job in playing catch up, but then
again, that's always been the case with you researchers. You're active
instead of PROACTIVE. Where would you be without new virus being released
everyday. If there's one thing I've learned in my job, it's being
proactive that really makes a difference and keeps people one step ahead
of the competition.

 Why can't you be proactive as well? Heuristics is a step in the right
direction and I'm looking forward to seeing even further developments.

 Keep up the great work...

 Data Disruptor
 RABID Development

- ---
disruptor@pcscav.com (Chris Atkinson)
  PC Scavenger -- Computer Virus Research, Toronto CANADA (416)463-8384
  Free services: send EMAIL to info@pcscav.com or virus.list@pcscav.com

------------------------------

Date:    Thu, 04 Nov 93 10:57:44 -0500
From:    Dittrich@urz.uni-bamberg.dbp.de (Alexander Dittrich)
Subject: False Aragon Virus (PC)

Lately, our version 108 of McAfee4s SCAN "detected" the ARAGON virus
active in memory during system boot. Since ARAGON happens to be a boot
sector infector, we found it interesting that SCAN could not find it
in the boot sector. We found it VERY interesting, that booting from a
clean diskette rendered the same result: ARAGON active in memory....
As it finally turned out, the "fake" virus report was caused by the
built-in virus protection of our hard disk controller4s additional
ROM. Switching off the ROM via jumper solved this problem - no more
"fake" virus reports.

So, just in case you are desperately searching for ARAGON and can4t
find it, this may solve your problem....

Regards,
Alex

------------------------------

Date:    Thu, 04 Nov 93 13:09:05 -0500
From:    kbutton@rn1.nursing.arizona.edu (Kevin Button)
Subject: current version of F-Prot (PC)

Is the current version of F-Prot 2.09 or has there been a new release?

[Moderator's note: 2.09F is the newest that I've seen on the archives.]

Thanks,

Kevin.
kbutton@con.nursing.arizona.edu

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 Kevin M. Button                 Application Systems Analyst, Senior
 Internet: KButton@rn1.nursing.arizona.edu     University of Arizona
 Bitnet:   KButton@arizvms.bitnet                 College of Nursing
 (602) 626-2377 Fax (602) 626-2211                 Tucson, Az. 85721
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

------------------------------

Date:    Tue, 02 Nov 93 15:00:27 -0500
From:    "Rob Slade" <roberts@decus.ca>
Subject: Antiviral popularity contests (CVP)

PRTAVSH.CVP  931005

                   Antiviral popularity contests

McAfee Associates SCAN program is probably the most widely used
antiviral in the world, and has been for a number of years.  (Note
that I have not said it was the first, or the best, or the most
purchased.)  It should, therefore, come as no surprise that SCAN has
been the subject of many malicious software attacks.  The easiest,
of course, is simply to write a trojan and release it under the SCAN
name.  There have been a number of such trojan versions, so many
that there is no point in keeping track of the pseudo-SCAN version
numbers.  Certain specific viral programs attempt to delete the SCAN
program file itself.

SCAN isn't the only program to have had this problem.  Indeed, it's
almost an indication that you have "made it" in antiviral shareware
to have been hit by a trojan version.  (Commercial software houses,
of course, have pirate copies of their software released as
"shareware" versions.  And then there are those individuals who
decide that they are "national agents" for a particular piece of
software - without telling the authors.)

Some of the attacks are slightly more insidious, such as those which
take a working antiviral version and try to "trojanize" it by
removing the internal integrity checks and infecting it with a
virus.  A number of viral programs try to defeat specific antiviral
software, not only by erasing the program files, themselves, but by
erasing ancillary files such as change detection "image" calculation
databases, or scanner virus signature files.  Thunderbyte's
heuristic cleaning mode was targetted for a time:  one program used
it as a "trigger" to infect all files specified to be cleaned.
(This didn't last long:  within months, at most, Thunderbyte had
eliminated the problem.)

Shareware is definitely not the only target here.  As soon as an
antiviral is released, there are apparent weaknesses that can be
exploited.  This is one reason to choose more than one antiviral
product.  As well as the fact that the weaknesses of one product
should be covered by another, the attacks made against one product
will likely not work against another.  There are, it is true, viral
programs which target more than one antiviral.  One, in fact, tries
to disable no less than fourteen different protective programs.

One commercial antiviral has apparently had a lot more promotion
than development.  It is very widely sold, and also included with
other packages that give it a distribution in the millions.
According to all independent tests, it is a mediocre product at
best.  However, it has some measure of success.  It is targetted by
a lot of viri.  Some erase its files, some disable its resident
portions.  Some viral programs even contain portions of code from
the main programs, probably just to confuse things.  High praise,
indeed.

copyright Robert M. Slade, 1993   PRTAVSH.CVP  931005

==============
Vancouver      ROBERTS@decus.ca    | Ceterum
Institute for  Robert_Slade@sfu.ca | censeo
Research into  rslade@cue.bc.ca    | Datapac
User           p1@CyberStore.ca    | delendam
Security       Canada V7K 2G6      | esse

------------------------------

Date:    Wed, 03 Nov 93 10:51:40 -0500
From:    gesman@io.org (Gleb Esman)
Subject: Re: GS.ZIP availability (PC)

 <HAYES@urvax.urich.edu> wrote:
>Hi fellows.  Announcing a new AV package, GLOBAL SHIELD, just sent my by the
>author, Gleb Esman.
>
>Followin is the description sent by Gleb:
>- ----------------------------------------------------------------------------
- --
>The Global Shield. Full-scale integrity checker with powerful recovery
>capabilities. IBMPC/DOS version. Dedicated against unknown and future viruses.
>Can detect unknown/possible boot viruses and recover boot/partition sector.
>Saves tiny "images" of selected files to be used later for integrity checking
>and recovery of files/disks. Can be used on Networks. Gl.I.Yes.(gesman@io.org)
>- ----------------------------------------------------------------------------
- --
>
>Please note that this is a BETA version, and address all mail directly to Gleb
>Esman at:  gesman@io.org
>
>==========
>Site:       urvax.urich.edu,  [141.166.36.6]    (VAX/VMS using Multinet)
>Directory:  [anonymous.msdos.antivirus]
>
>FTP to urvax.urich.edu with username anonymous and your email address
>as password.  You are in the [anonymous] directory when you connect.
>cd msdos.antivirus, and remember to use binary mode for the zip files.

I just want to announce some more FTP sites, carrying my package:

risc.ua.edu                     /pub/ibm-antivirus/gs.zip
ftp.cso.uiuc.edu                /pc/virus/gs.zip
ftp.informatik.uni-rostock.de   /pub/antivirus/msdos/gs.zip
garbo.uwasa.fi                  /pc/virus/gs.zip

Thanks to all owners/supervisors of above sites for their friendly assistance.

- --------------------------------------------------------------------------
Gleb Esman.
- --------------------------------------------------------------------------

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 144]
******************************************

