VIRUS-L Digest   Friday, 12 Nov 1993    Volume 6 : Issue 147

Today's Topics:

Re: Draft Swiss AntiVirus regulation
Re: DOS Floppy is a Virus Vector for Unix (UNIX)
McAfee Vshield and Windows (bad combination) (PC)
Re: Automated virus scan every n days ? (PC)
Horror of Horrors! (PC)
IBM pc's and viruses (PC)
New Virus? (PC)
Re: Rosenthal again.. (PC)
Re: Rosenthal again.. (PC)
Re: Removing Boot Sector Virus from Floppies (PC)
Re: How to clean Empire.Monkey.B (PC)
Re: Commercial Virus Scanners in the dark??? (PC)
False positive in BRINF126 (PC)
Re: of interest (PC)
Re: Advice sought re scanning procedures (PC)
Re: Why should a scanner HAVE to open a file? (PC)
Anti-tel and VShield problem? (PC)
re: Text File With Portion of Form Code (PC)
Scanning below DOS (PC)
Re: Form virus--IBM (PC)
[Q] Cross-linked files => virus? (PC)
Re: Commercial Virus Scanners in the dark??? (PC)
Monkey is not cute! (PC)
Re: Sorry, I need more RAM memory (PC)
New files / mirror site on risc (PC)
AVP107_B and KILLMNK3 available for FTP (PC)
"Eye of the Storm" (*another* Desert Storm virus? :-)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Wed, 10 Nov 93 15:37:19 -0500
From:    vfreak@aol.com
Subject: Re: Draft Swiss AntiVirus regulation

>such experiments in such restricted environments. It's writing viruses
>for the real computers that we label as malicious, unethical, and
>criminal.

I disagree. I have no problems with people writing viruses. Releasing these
viruses into the wild to computers of unsuspecting users is what I consider
malicious, and unethical.

As long as the virus is kept under controled condition, it is none of my
business if Joe user down the street write a virus.

>I don't think that virus creation should be forbidden per se. But I do
>think that if a virus is found somewhere where it is unwanted, the
>author of the virus should share the responsability, even if he has
>not introduced the virus into that system.

I agree with this 100%

Bill

------------------------------

Date:    Mon, 08 Nov 93 12:27:54 +0000
From:    gw@startech.demon.co.uk (Greg Watson)
Subject: Re: DOS Floppy is a Virus Vector for Unix (UNIX)

radatti@cyber.com writes:

>There are many good and rational reasons for executing DOS on a PC that
>normally executes Unix.  Leave an infected DOS floppy in the drive during
>system reset and a boot virus will overwrite that portion of the disk where
>it expected the DOS boot record to be stored.  The effect on a Unix system
>varies from none observed to a damaged filesystem.

EXACTLY ! That's why all our SCO UNIX boxes run a boot sector virus
checker when they boot up...
- -
+------------------------------------+----------------------------------+
| Greg Watson                        |    Star Technologies (UK) Ltd    |
|                                    |   Passfield Enterprise Centre    |
| Internet : gw@startech.demon.co.uk |            Liphook               |
| Voice    : 0428 751091             |             Hants                |
| Fax      : 0428 751117             |           GU30 7SB               |
+------------------------------------+----------------------------------+

------------------------------

Date:    Wed, 10 Nov 93 11:40:35 -0500
From:    cctb@kudu.ru.ac.za (Tim Bouwer)
Subject: McAfee Vshield and Windows (bad combination) (PC)

Hi

Perhaps others could confirm this:

I have several (3) DOS windows in my startup group.  They start up minimised.

If I have vshield loaded when I start up windows at least two of these
minimised icons start to flash and report that "this application has
violated system integrity etc..."  This happens even if I have only one
DOS window in startup.  If I take them all out of startup and start them
manually I don't get this effect.

I know that it is probably not common to have dos windows like this,
but the problem is repeatable so it must be a bug somewhere.  I want to
start up telbin.exe in server mode, so there is at least one dos window that I
don't want to remove from the startup group.

I contacted our local McAfee rep and sent quite a bit of info (windows
msd info) to support@mcafee.com about 2 months ago and have still not
had any luck or pointers from them.

Could others using vshield confirm this for me?  I am wanting to
implement a new campus wide policy for scanning for viruses and SCAN.EXE
takes far too long to be run at each bootup.  I would prefer to make vshield
a standard means of detection/prevention, but not if it is flaky with
Windows.

I have a 386DX 33Mhz with 8Mb ram, this happens with DOS5 and DOS6.

Any confirmation/denials/suggestions would be appreciated.

- --
| Tim Bouwer, Computing Centre /~~~--~\ Tel +27 [0]461 318233/318279 |
| Rhodes University            \___    \_  FAX: +27 [0]461 25049     |
| PO Box 94, Grahamstown           \    /  Home Tel: 311041          |
| South Africa, 6140                \_*/ Internet:cctb@kudu.ru.ac.za |

------------------------------

Date:    Tue, 09 Nov 93 11:26:34 -0500
From:    "Michael F Conners-1" <conn0060@maroon.tc.umn.edu>
Subject: Re: Automated virus scan every n days ? (PC)

>I'm trying to solve a problem with my PC. I presently have SCANV and
>FPROT on my system. What I am looking for is a program/autoexec code
>that will execute F-PROT and SCAN only once on say Thursday and then ignore
>all other boots until the following week, etc. I had some code from
>PC Magazine's USER-TO-USER (I think) from last year but it did not
>work properly. Is there such a beast out there? Please mail all repsonses
>to jlaw@irus.rri.uwo.ca.

I am also looking for a way to do this.  My e-mail address is
conn0060@maroon.tc.umn.edu.

Thanks!

Mike Conners
Eden Prairie, MN
conn0060@maroon.tc.umn.edu
To see the next message, type Ctrl-Alt-Delete...

------------------------------

Date:    Tue, 09 Nov 93 15:34:03 -0500
From:    mvjma2@cbnewsb.cb.att.com (jenny.m.abar)
Subject: Horror of Horrors! (PC)

My husband uses Untouchable and he thought it was a little overdue
for a virus update so he called Fifth Generation Systems Tech Support
to find out when Untouchable/Search and Destroy updates are due (they
were also supposed to come out with an updated utres.exe).  He was
told that as of Nov. 1 Untouchable is discontinued!!

It appears that Symantec has bought Fifth Generation and will no
longer offer Untouchable or S & D.  They will refund your money if
it is still under warranty (Not sure about if it is not) or "allow"
you to upgrade to NAV 3.0 for $29, whoppee!

Are any of the Untouchable people still out there?  What will become
of these programs?  Is Symantec going to incorporate some of their
features into NAV or are they just going to let it die out?  Please
let us know so I can tell my husband to get a refund, we don`t want
to be stuck with NAV.

Jenny Abar

------------------------------

Date:    Tue, 09 Nov 93 15:44:17 -0500
From:    gt7495b@prism.gatech.edu (Daniel H. Smith)
Subject: IBM pc's and viruses (PC)

I have recently discovered at work that the new IBM pc's have the
capability of catching viruses on the Reference Disk that is stored on
the computer's hard drive.  I discovered this because someone used
an infected options disk in the computer.  I ran NAV 2.1 on the pc
and cleaned every disk the user had.  Then reset some of the configuration
parameters using the reference disk on the hard drive.  The virus then
came back without even putting a disk in the floppy drive.  I just wanted
to see if anyone else has run into this problem.

Daniel Smith
gt7495b@prism.gatech.edu
- --
SMITH,DANIEL H
Georgia Institute of Technology, Atlanta Georgia, 30332
uucp:	  ...!{decvax,hplabs,ncar,purdue,rutgers}!gatech!prism!gt7495b
Internet: gt7495b@prism.gatech.edu

------------------------------

Date:    Tue, 09 Nov 93 15:47:44 -0500
From:    csl@stein3.u.washington.edu (Corey Lawson)
Subject: New Virus? (PC)

System:  Zenith Z-Note 325-slc-120, DOS 5, Windows.

Description of problem:

1.  When trying to load windows, we get this funky error message in summary
saying the HD's address has been changed and consequently, the 32-bit
disk driver won't work.  But Windows will run, with 16-bit HD access.

So, I get to thinking, maybe it's a virus.

2.  try to run F-prot.  No reboot.  I stick in my usual
write-protected boot disk with F-PROT on it.  Whirr whirr goes the
disk drive.  Eventually I get the Abort, Retry, Ignore, Fail error
message.

3.  Boot from f-prot disk.  WhirWhirWhir.  Can't boot from floppy.

4.  Boot from system disk w/o f-prot on it.  No problem.

4a.  Stick in f-prot disk to copy f-prot onto HD.  Copy bombs on f-prot.exe.
INT 24.

5.  This time, power off and reboot.  No can do.

Oh...and doing disk access from other disks takes awhile (i.e., it sure
seems like it's looking for a virus checker).

Umm...Write-protect can't be overridden with clever DOS system calls, can it?

- -Corey Lawson
csl@stein.u.washington.edu

------------------------------

Date:    Tue, 09 Nov 93 20:40:39 -0500
From:    frisk@complex.is (Fridrik Skulason)
Subject: Re: Rosenthal again.. (PC)

bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev) writes:

>As a matter of fact, I don't recall to have seen Frisk's name in a
>virus. Maybe the virus writers respect him more, because he offers an
>excellent product essentially for free... :-)

Oh, it is included in one...I think there is a "Hello Fridrik" message
encrypted inside some virus somewhere...

- -frisk

------------------------------

Date:    Wed, 10 Nov 93 03:34:34 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Rosenthal again.. (PC)

Vesselin Bontchev <bontchev@fbihh.informatik.uni-hamburg.de> wrote:
>kevin marcus (datadec@ucrengr.ucr.edu) writes:
>As a matter of fact, I don't recall to have seen Frisk's name in a
>virus. Maybe the virus writers respect him more, because he offers an
>excellent product essentially for free... :-)

I believe I saw a mention  of one in out great and reliable (ahem)
VSUM program.  check the most recent "update" to the virus database.  It
was a "new" virus, and not a hack.  (according to Hoffman)

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Wed, 10 Nov 93 03:38:07 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Removing Boot Sector Virus from Floppies (PC)

Vesselin Bontchev <bontchev@fbihh.informatik.uni-hamburg.de> wrote:
>Ted Wong (tmw5@cornell.edu) writes:
>> This behavior is unusual. Non-boot disk operations (DIR, COPY) do not access
>> the boot sector.
>
>The operations mentioned above -do- access the boot sector. DOS needs
>to read the BIOS Parameter Block from it, in order to figure out the
>parameters of the floppy (size, location of the root directory, etc.).

Er... While true, keep in mind that this is treated as data, and not
code - it is not executed.  It is stored off in memory, but there is
no attempt to execute this sector, as there is when you try to boot
from a disk - therefore, the virus will not spread (or become active,
for that matter)

>Yes, it does - exactly because DOS reads the boot sector in memory.

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Wed, 10 Nov 93 03:41:34 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: How to clean Empire.Monkey.B (PC)

Vesselin Bontchev <bontchev@fbihh.informatik.uni-hamburg.de> wrote:

>And beware of the advices from self-appointed experts, or the cure
>might be worse than the disease... :-)

Can you tell us which is which?

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Wed, 10 Nov 93 03:55:07 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Commercial Virus Scanners in the dark??? (PC)

Vesselin Bontchev <bontchev@fbihh.informatik.uni-hamburg.de> wrote:
>Chris Atkinson (disruptor@pcscav.com) writes:
>>  All you virus authorities out there might agree with me that the day
>> when the "Supervirus" is developed may not be that far away. In the last
>
>The more features a virus has, the less likely it is to spread.

Are you sure about that?  Form?  Dir_II?  Tequila?  Monkey?  They have
"features" beyond a simple infect one file in a directory .COM appender...

Sure, there are a lot of others on the list of junk that spread (Stoned!),
but clearly the ones which do use more features - even if buggy, do
spread, and if done well, have a damn good chance of spreading.. (Tremor,
Dir_II...  And Tremor isn't even that great from what I've been hearing
lately)

>>  I was a virus author, but decided that it was boring because, well,
>
>Agreed, it is.

Er...?  How do you know if it is or isn't until you've done it?

>something, then tries to find out the decryption method used and the
>particular key. The key is then used to decrypt the rest of the file
>and the standard scan string methods are applied to the decrypted
>stuff. I've heard that it has been so successful, that once it has
>detected the decryption routine used by some anti-virus product to
>decrypt its scan strings, which has caused false positives... :-)

I wouldn't call anything that gets false positives, "so successful".

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Wed, 10 Nov 93 04:31:58 -0500
From:    frisk@complex.is (Fridrik Skulason)
Subject: False positive in BRINF126 (PC)

There is a file named BRINF126.ZIP available on various archives, including
oak.oakland.edu in /pub/msdos/dskutl.  This package contains a file named
VIRBOOT.EXE that causes F-PROT 2.09f (and possibly other scanners) to generate
a false positive: "Seems to be a LZEXE-packed Denzuko dropper".

An examination of the file revealed that it includes fragments from various
boot sector viruses, for detection purposes, without bothering to encrypt
them.

Our policy is to fix all false positives, *UNLESS* they are genereated by
another anti-virus product (in that case we see it as the responsibility of
the other manufacturer), so doing anything about this is very low on our
priority list.

- -frisk

------------------------------

Date:    Wed, 10 Nov 93 09:33:58 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: of interest (PC)

Fridrik Skulason (frisk@complex.is) writes:

> >TBAV has -many- things that F-Prot doesn't have.

> Eh...that only applies to the shareware version.  The "Pro" version includes
> an off-line integrity checker, a resident integrity checker and a generic
> disinfector.

Well, first, I compared what is available to me. :-) Second, it is
just fair to compare the two shareware versions of the programs. The
commercial version of TBAV comes with a hardware anti-virus card, as
far as I know... :-) Third, even the shareware version of TBAV still
has additional utilities than the ones in F-Prot Pro that you listed.

For instance:

	- ability to "immunize" the boot sector (although DiskSecure
II seems better to me);

	- ability to save a copy of the boot sector to a file for
later examination (although an utility Anthony Naggs works on seems
better to me);

	- an utility to wipe files (although WipeInfo from Norton
Utilities is better);

	- a monitoring program (those are bad in general and I have
seen better ones);

	- utility for automatic scan string extraction if a new virus
is found. This is available only to the registered users and will be
often unsuccessful (e.g., with a polymorphic virus), but it's still
some kind of protection that helps to fight viruses.

I will repeat - TBAV is an excellent collection of anti-virus
protections; the only problem is that none of them is implemented in
the best possible way.

Speaking of F-Prot, I am still missing the set of small utilities that
were available in version 1.x - the memory browser, the utilities to
dump a copy of the boot sectors, the monitoring program, the disk
write protector... Yes, none of them can be made secure enough to be
relied upon, but they are still useful tools to have when figthing a
virus infection.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 10 Nov 93 09:50:55 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Advice sought re scanning procedures (PC)

Bob MorrisG (bmorris@netcom.com) writes:

> Would it be reasonable to assume that weekly use of SCAN and F-PROT, plus
> NAV ( resident, with executables scanned ) would be a generally safe way
> to avoid most detectable viruses?

Hm. If the question is so formulated, I would say that the answer is
"yes, quite probably". I would like just to not two things. By "most
detectable" you probably mean the most widespread viruses? Because
every virus is detectable - there are no undetectable viruses. Also,
if you are the only one to use the machine, there is no real need to
scan it regularly - it is sufficient if you are disciplined enough to
scan -all- incoming software. Including the blank or data-only
diskettes that have been in somebody else's machine. Oh, yes, and the
scanners must be kept reasonably up-to-date.

> Are there any major gaps/holes in the above?

Yes. The above procedure doesn't detect new viruses which are unknown
to the scanners you listed.

> Any advice?

Use also a good integrity checker. A couple of other kinds of
anti-virus utilities will be handy too. And, of course, don't forget
to make good backups.

> Any FAQs I
> could be directed to?

Try the FAQ of this newsgroup, questions A8, all of sections C and D,
and many of the other questions too - you might find them useful.

> I'm not trying to start a Holy War, but am interested in what you
> obvious professionals here think would be the best lines of defense
> against viruses on PCs.

My opinion is that the best line of defense is to use all available
lines of defenses. :-)

> Is there any way to protect against new strains?

Yes - integrity checkers and monitoring programs. The latter are too
obtrusive and easy to circumvent though, so you are left with the
integrity checkers.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 10 Nov 93 10:27:57 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Why should a scanner HAVE to open a file? (PC)

Eric_N._Florack.cru-mc@xerox.com (Eric_N._Florack.cru-mc@xerox.com) writes:

> point - where the virus is likely to be. And, in order to figure out
> the file entry point, you'll have to open the file.<<

> I would think that this is not altogether correct, though I`d have to do som
> work on it. In theory, DIR and FAT info should tell you where a file starts,
> and you should also be able to use that information, and mathmatics, to move
> a particular offset, to look for your string.

You are right - in theory. In practice, it will be slow and difficult
(you'll have to do more than what DOS does) and it will be too
unreliable on non-hard disk platforms, as Frisk mentioned. The
problems with it are just too many and the benefits - rather doubtful;
that's why most anti-virus producers have decided not to bother.

> I grant you, this would be
> slow.... at least slower than opening the files.

The "right" task (figuring out which sectors belong to a file and
scanning only them) will be fast - in fact it will be faster than
using the DOS functions. Just look at TbScan. It is the "reverse" task
which is slow.

> Perhaps it would be better no
> to bother looking for the offset; by the time you get done doing the offset
> the manner I suggest, you could have just gone ahead and scanned the whole
> file....

Doing what TbScan does (interpreting the file system "manually" and
accessing the disk at sector level) is faster and still allows you to
look at fixed offsets. Doing what you proposes (scanning at sector
level and if something is found figuring out to which file it belongs)
will be much slower, unreliable, and inconvenient. And why scanning
the whole file, if you can just scan at fixed offsets - this is much,
much faster and just as secure in practice.

> and to interpret it. In short, the solution will be rather slow and
> your users are likely to select your competitor's scanner, which is
> much faster... :-)<<

> I guess that depends if you are, or are not interested in a scanner that won
> make an existing virus problem worse, in the process of looking for such
> problems.

No, it depends on the implementation. If your main concern is to
bypass the viruses that infect on file open - well TbScan's method
already does it and is faster than the implementation you propose.

> Quite true. But, I would hope that the scanner wouldn`t find a `hit` very
> often, and therefore wouldn`t need to sample FAT info very often, either.

My real-life experience tells me something rather different. Do you
know how a Dark_Avenger.1800.A infection looks like? Every program
that the user has executed or opened (read or copied) is infected.
Additionally, if the payload has activated, the virus has botched the
hard disk here and there with sectors that contain the first 512 bytes
of its body. Those sectors could be in a file, or in a subdirectory,
or in the free disk space. Do you imagine how much time it will take
to find all of them and determine to which files they belong on a
reasonably large hard disk? On the other side, it will permit to find
not only the infected files, but also the corrupted ones - but this is
valid only for this particular virus.

And do you know what will happen after the user runs a disinfector?
The virus will be truncated, the file beginning will be restored, but
the virus body will most probably remain in the freed disk space. The
next time the user runs your sector scanner, it will take exactly as
much time as on an infected system - because it will continue to find
the scan string here and there and will have to waste its time to
compute that those sectors don't actually belong to files.

> I guess I attribute this to a different design philosophy. Why would one
> continue to use a scanner, allowing it to run, once a problem is found? Forg
> me, but I was of the impression that the purpose of a scanner was to find if
> there was a problem anywhere on the disk, to alert the user. The clean-up
> proceedure (Ex: CLEAN.EXE) would be called in at the first sign of trouble..
> which would then go through the whole disk and clean up any occurrance of th
> virus.

First of all, most scanners also disinfect the viruses that they find;
McAfee's product is one of the few that forces the user to run a
separated program. Second, if you want just to find the first
infection and then run something that handles the problem better - why
run a scanner at all? Just run an integrity checker.

> Granted, that looking up all the pertanent FAT  and DIR information would be
> slow task.

Only the reversed task is slow.

> >>There is a different idea, however, which -can- be used (and is used
> by e.g., TbScan) and which does improve system performance and reduces
> the threat of having an active fast infector in memory to infect all
> files that are being scanned. The idea consists of not opening the
> files using the normal DOS function calls, but interpretting the
> FAT/directory information for them "manually", determining which
> sectors they occupy (this is fast as opposed to the reverse task) and
> then scan only those sectors.<<

> Only problem here is future virus development; is it possible we`ll see a vi
> that will break the rules of DOS, and hide a file somewhere on the disk, or
> mark a sector as bad, and then use it to stick itself into?

I have many disagreements with what you said above; let's try to list
them all.

First, a scanner can detect only known viruses. It is useless to worry
now about any future developments, because regardless of what they do,
a scanner won't be able to handle them anyway. Once those viruses
appear, we'll see what they do, and the scanners will be appropriately
upgraded to handle them.

Second, viruses that do what you describe already exist - those are
the boot sector viruses. As you probably know, they don't represent
any problem to the scanners.

Third, in order to spread, a virus has to be executed. In order to be
executed, it has to "hook" itself somewhere in the executable path -
in one of the boot sectors, at the directory entry, as a companion, or
in an existing file. Regardless of where exactly it is, a scanner will
be able to find it by looking there.

This is just like the argument about the viruses residing in EMS or
CMOS or whatever. No such viruses exist yet, so it is useless for the
scanners to look at those places. And even if somebody writes such a
virus, in order to run it will have to contain parts in the
conventional memory, which means that a scanner will be able to find
it by looking -there-.

Fourth, even if we ignore the arguments listed above and assume that
what you said is right, I still don't see how the method proposed by
you solves the problem better than, say, TbScan's. Except that it is
much slower and clumsier than TbScan's.

> many variables to discuss them here, I guess. Then again, non-standard iron,
> and OS`s tend to foul quite a few viruses, too, so I suppose there`s some
> equity, there. (grin)

Problem is, those two issues are incompatible and you cannot use the
same kind of reasoning in both cases. The virus writers doesn't care
if his (its? <grin>) virus does not work on some systems - so what; it
will infect others. The producer of anti-virus software, however, must
be particularly careful to ensure the highest possible compatibility
of his product - otherwise he will lose customers.

> up somehow. (Always the problem, isn`t it?) Still, in all, I`d rather take t
> extra time, rather than spread the virus I`m looking for. Does that make me
> exception?

> > Yes, you can do it without opening a file, but why bother?<<

> Here it is: To avoid the scanner infecting the uninfected files on the disk,
> the process of the scan.

Three remarks. First, if all you are concerned about is not to infect
the file when opening it - use TbScan's method. As I said, it is much,
much faster than yours (because it doesn't have to solve the reverse
task) and is even faster than DOS (becaus DOS has to do some aditional
tasks).

Second, even if you do sector access, there are still viruses which
will be able to infect the files you are reading. (Off the top of my
head I can think about two - Dir_II and Int13.)

Third, if you are concerned about the speed, take care to use
some good string scanning algorithm. When you have to search for
3,000+ scan strings, this becomes more important than the time for
reading the file.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Wed, 10 Nov 93 14:25:39 -0500
From:    nathan@remus.Rutgers.EDU (Nathaniel Schiffman)
Subject: Anti-tel and VShield problem? (PC)

Has there been a problem with VShield picking up the Anti-tel virus?
One computer that we have here got the virus even though VShield is in place
with the lock option.

Thanks for any help.

------------------------------

Date:    Wed, 10 Nov 93 14:25:32 -0500
From:    "David M. Chess" <chess@watson.ibm.com>
Subject: re: Text File With Portion of Form Code (PC)

>From:    msz2@po.CWRU.Edu (Mark S. Zajaros)
>Later in the day, the user went to retrieve a large WordPerfect
>file. Only half appeared. One of our staff looked at the file
>with a sector editor and found the text portion of the Form
>virus and, I believe (not sure) part of the code.

This happens once in awhile.  The FORM is more than one sector
long, so as well as the boot sector, it has to write some of
itself elsewhere on the disk.  It tries to interpret the FAT in
order to find unused sectors, mark them as "bad", and write
itself there, but sometimes (due to the usual bugs) it fails,
and writes itself elsewhere on the disk, sometimes in sectors
that are in use.  The off-boot sector of the form contains
half of the virus's code (but not enough to be infective!),
and the message area, including the rude message to Corinne...

- - -- -
David M. Chess                    |    "This chicken has a *very*
High Integrity Computing Lab      |        small opening book!"
IBM Watson Research               |

------------------------------

Date:    Wed, 10 Nov 93 14:26:21 -0500
From:    Eric_N._Florack.cru-mc@xerox.com
Subject: Scanning below DOS (PC)

David_Conrad@MTS.cc.Wayne.edu says in #146:

>>But one major reason for not scanning at the sector level, the most
important reason IMNSHO, hasn't been mentioned.  Any scanner which did
this would lose compatibility with future DOS versions, or with other
environments (OS/2, Windows NT, UN*X DOS boxen) which emulate DOS.  A
program which opens and reads a file via handles and standard calls will
be able to do so under DOS 8.21, even if it uses something like HPFS.
Any program which tries to redo DOS will get hopelessly confused and fail,
I hope gracefully, at worst it may fail catastrophically.<<

No argument, except that actually, this has been discussed. However, as I
suggested, the  problem with this argument is that virus programs have a
tendency to fail under these varied conditions, as well.

I suggest that by sticking to `standard solutions` we are inviting problems.
Consider: if the detection programmer plays by the rules, he does exactly what
the virus hacker /expects/ them to do, and thereby plays into the hands of
these idiots. And, by way of example, spreads the virus all around while
/looking/ for a virus.... which is exactly what the author of the virus
intends.

I`ll more than grant (as I have previously) that non-standard solutions create
some of their own problems, and the weird iron problem is one of these. But
since when has weird iron stopped people from creating software that works for
the majority of us?
I would suggest that non-standard iron be addressed as such, and not included
in the mainstream.... if we do otherwise, we limit everyone on the basis on
someone`s having non-standard equipment. Very fair, to be sure, but highly
ineffective... at least not nearly as effective as it could be.

/E
===================

*#*
  V     `Everyone`s entitled to my opinion,
            but that doesn`t mean Xerox pays
            me for it...  (Damn!)`

Eric_Florack.CRU-MC@Xerox.COM

====================

------------------------------

Date:    10 Nov 93 17:23:47 +0000
From:    virusbtn@vax.oxford.ac.uk
Subject: Re: Form virus--IBM (PC)

Doubtless plenty of people will reply to this thread but, on the off
chance that this is of interest:

FORM

The Form virus is the most common PC virus by a pretty large margin -
certainly within the UK. The virus is of Swiss origin, and infects the
DOS Boot sector of fixed disks.

When the Form virus is executed (by booting from an infected disk), it
reserves 2 kilobytes at the top of RAM and reads the second half of
itself from disk.  If a read error occurs during this process, the
virus does not retry the operation but simply hangs the machine.

When Form is first loaded into memory, it reads the Partition Table
and locates the active DOS Partition. If this is not already infected,
and the sector size is 512 bytes, the contents of the DBS are copied
to the last sector of the partition and the second half of the virus
is stored in the preceeding sector. Finally the virus overwrites the
first sector of the partition.

When form is memory-resident, it only intercepts requests to read from
track 0 on drives A and B - in all other cases control is passed back
to the origial INT 13h handler. This will generally result in the
infection of diskettes the first time they are activated.

Form has a harmless but irritating trigger routine. After INT 13h is
hooked, the date is checked. If this corresponds to the 18th of any
month, the virus also hooks the keyboard interrupt. The new INT 09h
handler causes a click to be produced by the PC's speaker every time a
key is pressed.

Getting rid of Form is easy: one can either copy the original contents
of the DBS back to its rightful place, or one can use the SYS command
to re-write the contents of the DBS. Either procedure should work
completely painlessly.

NB: For Form (or any boot sector virus) to spread, the user must boot
from an infected diskette, so try and get out of the habit of leaving
disks in the drive last thing at night. Also, if your PC has a switch
in the BIOS to disable boots from floppy you might want to think about
using it.

Regards,

Richard Ford			| Tel +44 (0)235 555139
Editor, Virus Bulletin.		| Fax +44 (0)235 559935

------------------------------

Date:    Wed, 10 Nov 93 17:20:50 +0000
From:    wbg@festival.ed.ac.uk (W Geake)
Subject: [Q] Cross-linked files => virus? (PC)

I've been trying to sort out a PC with LOTS of cross-linked fiels, using
utilities such as BNorton Disk Doctor, CHKDSK, etc.  I got rid of them
all, and left the PC to it's user's tender care.  He used it for a
couple of days and the cross-linking has returned.

I ran a check with F-Prot 2.09D (August 1993) and it detected no virus,
or indeed anything suspect - might it have been duped?

The usage of this PC makes it vulnerable to attack - lots of floppies
from other, public access machines.

Thanks for any advice,

Bill.

------------------------------

Date:    Wed, 10 Nov 93 17:39:06 -0500
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: Commercial Virus Scanners in the dark??? (PC)

giuse_r@pavo.concordia.ca <GIUSE_R@PAVO.CONCORDIA.CA> wrote:
>and one person (Rock Steady) developed a virus called "Varicella" this virus
>system. and to advice you, the varicella virus is fairly a stealth virus that
>disinfects files on the file, when opened and reinfects them when closed,
>and it hides its virus length very well! such a virus can easily get out of

Most of this Virus Writer's viruses are actually snippets from other people's
viruses.  Is this the case here as well?
- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    10 Nov 93 20:54:23 -0500
From:    sullivan@cobra.uni.edu
Subject: Monkey is not cute! (PC)

Hi,

We have had a major onslaught of infected diskettes which have
spread to hard drive machines in our student computer centers.
The symptoms are similar to some of the postings I've seen.
VIRSTOP didn't protect against it, and I haven't seen a definitive
answer, so I have a couple of questions.

I've used F-prot version 2.09f, Vshield version 5.54B108, and
Norton Anti-Virus version 3.0 to try to narrow the identification.
I also got KillMonk version 1.1.

Vshield reports the infection as the [Mon] virus.  F-Prot calls it
a new variant of Stoned.  Norton reports it as Stoned.Empire.Monkey.
KillMonk says that the diskette is infected with Monkey.

I was able to clean disks with KillMonk and Norton Disk Doctor
version 6.01 rebuild.  Earlier versions of NDD, FDisk /MBR, FixMBR
didn't work and, in fact, I ended up destroying a 250 MB loaded hard
drive in the process.

I have loaded VShield with the /boot option and that is trapping the
infections on diskette accesses.  NAVTSR also is able to trap the virus
before it goes active.  VIRSTOP isn't, even when I use the /boot
parameter.  I have tried it with and without the /disk parameter, so
that I'm fairly certain I was giving it a good chance.  BTW, during
this experimentation, I also received a couple of diskettes with Form
and tried the same sets of TSR's.  VIRSTOP did trap this one, so I'm
convinced I have it loaded correctly and functioning.

There are several reasons for wanting VIRSTOP to get this.  First,
we've already paid the fees for a fairly large site license, and the
powers that be are not going to want to spend another hefty sum for the
same sort of protection.  Second, we already have people pushing the
edge of the 640K envelope and 50K for the VShield TSR is not a welcome
addition.  NAV is just plain too expensive for most of our people.
We've tried forcing a scan with F-Prot each time a diskette drive is
chosen, but on anything less than a 386 it's just too time consuming.
At the moment we are forcing a scan of all hard drives every time they
reboot and locking the keyboard if an error code is returned, but we'd
like a better solution.

I have diskettes with the infection and have found that I can easily
make more ;-} so I could provide them.  Has anyone encountered this and
sent it to Frisk?  Can you tell me how to encode the virus so that I
can send it to him?  Is there a chance this would be included in version
2.10?  Is there a better way for us to plug security holes in our
student computer centers?

Any suggestions for maintaining security from infected diskettes in
public facilities while still allowing enough flexibility for the center
to remain usable would be appreciated.

Thanks
Diane
===============

sullivan@uni.edu
Diane Sullivan
ISCS NTS
University of Northern Iowa
Cedar Falls, Iowa 50614-0121
(319) 273-6814

------------------------------

Date:    Wed, 10 Nov 93 22:00:58 -0500
From:    "Gerry Cross" <gcross@fox.nstn.ns.ca>
Subject: Re: Sorry, I need more RAM memory (PC)

>Date:    Mon, 08 Nov 93 06:45:09 +0000
>From:    byng@solomon.technet.sg (Ng Bee Yong)
>
>Has anyone encounter the following error message from SCAN?
>
>  Sorry, I need more RAM memory
>  390 kbytes should be enough
>
>Is it some kind of bug in SCAN?  I am quite sure I have more than 500 kbytes

    I encountered this error running SCAN 107 on my entire HD. The problem
can be avoided by using the  /npkl option.   This bug did not appear when
running SCAN 108. I just checked, and SCAN 108 doesn't support this switch
anyway, so this condition must be fixed.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Gerry Cross            Snail via -------->     11 Chappell Street
   "This machine slays fascists."                Dartmouth, Nova Scotia
        - Woody Guthrie                            Canada    B3A 3N8
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

------------------------------

Date:    Wed, 10 Nov 93 10:48:06 -0500
From:    James Ford <JFORD@UA1VM.UA.EDU>
Subject: New files / mirror site on risc (PC)

Several new files have been placed on risc.ua.edu in /pub/ibm-antivirus.
These files were taken from Vesselin's (sp?) FTP site.

             fp-209f.zip  -  FProt v2.09f
            nav21upd.zip  -  Norton's Antivirus v2.1 update signatures
            nav30upd.zip  -  Norton's Antivirus v3.0 update signatures

The following file has been mirrored from ftp.mcafee.com and placed
in /pub/ibm-antivirus/Mirrors/Mcafee:

           vsumx310.zip - Virus Summary Listing.

New site mirrored:  cert.org
- ----------------------------
The /pub/virus-l directory of cert.org is now being mirrored on risc.ua.edu
in /pub/ibm-antivirus/Mirrors/cert.org.  If you have any questions or
comments, please let me know.
- ----------
A road map always tells you everything except how to refold it.
- ----------
James Ford -  Seebeck Computer Center
              The University of Alabama (in Tuscaloosa, Alabama)
              jford@ua1vm.ua.edu, jford@seebeck.ua.edu
              Work (205)348-3968  fax (205)348-3993

------------------------------

Date:    Wed, 10 Nov 93 15:17:01 -0500
From:    HAYES@urvax.urich.edu
Subject: AVP107_B and KILLMNK3 available for FTP (PC)

Hello.
Announcing the availability of KILLMNK3.ZIP and AVP107_B.ZIP for FTP processing
from our site.  Please use off-hours (22:00/06:00 EST) to fetch AVP:  the file
is over 1 meg long...

Site:       urvax.urich.edu,  [141.166.36.6]    (VAX/VMS using Multinet)
Directory:  [anonymous.msdos.antivirus]

FTP to urvax.urich.edu with username anonymous and your email address
as password.  You are in the [anonymous] directory when you connect.
cd msdos.antivirus, and remember to use binary mode for the zip files.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Claude Bersano-Hayes     HAYES @ URVAX                 (Vanilla BITNET)
University of Richmond   hayes@urvax.urich.edu     (Bitnet or Internet)
Richmond, VA  23173

------------------------------

Date:    Thu, 04 Nov 93 14:13:14 -0500
From:    "Rob Slade" <roberts@decus.ca>
Subject: "Eye of the Storm" (*another* Desert Storm virus? :-)

BKEYESTM.RVW   931019

Gold Eagle/Worldwide
225 Duncan Mill Road
Don Mills, Ontario
M3B 3K9
"Eye of the Storm"

Those who like books with series titles like "The Executioner" will
like this book.  'Nuff said.

The computer virus is by no stretch of anyone's imagination a major
subplot, even in a book which seems to consist only of subplots.
Nevertheless, it is interesting to note what it indicates about the
popular perception of viral programs.

The "virus" is tripped during an attempt to find a tap in a voice
(phone and radio) network.  Since phone switches are basically
computers with special peripherals, this could be realistic.  There
are viral programs which can "sense" probes into memory or operations,
and can then trigger.  However, there is no indication of reproduction
in the story, and, therefore, the malicious program is either a logic
bomb or a trojan horse (or both).

Interestingly, the system under attack is protected by a "worm".  The
theory is proposed that you protect your own computer by shutting down
if you detect suspicious activity.  (One suspects this was the idea
behind the "Immunizer".)  Having written the shutdown program, you
should know how to recover the system, whereas unknown malicious
software can damage your data structure in ways that may take longer
to diagnose and rectify.

The concept is initially interesting, but somewhat flawed.  First of
all, the reliability of the system is internally compromised by such
protection, and this is not acceptable in all situations.  (In the
book, communications are shut down at a vital juncture.)  Further, the
detection of suspicious activity requires a background of known
methods of attack.  (Interestingly, the protection program in the book
is stated to be subject to periodic upgrading.)  Given the need for
specific knowledge of security loopholes that the malicious software
might use, there will probably be better means to deal with the
insecurities.  Finally, if the attacking program uses an unknown
method, the attack may still succeed.

In the book, we once again see the myth of a virus (or the defending
"worm" in this case) being able to damage hardware.  Fuses blow, wires
burn out and the power for the entire complex shuts down.  Debugging
the system involves the "MIS manager" character crawling under desks
with a roll of electrical tape.  Guess we still have some educating to
do.

copyright Robert M. Slade, 1993   BKEYESTM.RVW   931019
Permission granted to distribute with unedited copies of the Digest
======================
DECUS Canada Communications, Desktop, Education and Security group newsletters
Editor and/or reviewer ROBERTS@decus.ca, RSlade@sfu.ca, Rob Slade at 1:153/733
DECUS Symposium '94, Vancouver, BC, Mar 1-3, 1994, contact: rulag@decus.ca

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 147]
******************************************

