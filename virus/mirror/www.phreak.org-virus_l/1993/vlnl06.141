VIRUS-L Digest   Monday,  1 Nov 1993    Volume 6 : Issue 141

Today's Topics:

Washington Concerns
Re: Draft Swiss AntiVirus regulation
Re: 'Dark Avenger'
Can I get a virus from reading this newsgroup?
Re: Virus scanning for Unix (UNIX)
Re: Virus scanning for UNIX (UNIX)
Re: Virus scanning for UNIX (UNIX)
Re: Virus scanning for UNIX (UNIX)
How to clean Empire.Monkey.B (PC)
Re: Rosenthal again.. (PC)
Automated virus scan every n days ? (PC)
Viruses on Microsoft NT and NT AS (PC)
Re: of interest (PC)
Re: MtE virus...what does it do? (PC)
Re: Essex virus (PC)
Stoned cannot be safely removed (PC)
Re: TREMOR virus (PC)
Re: A few questions... (PC)
Re: info about ANTIX (PC)
Re: Rosenthal again.. (PC)
Re: Commercial Virus Scanners in the dark??? (PC)
VShield-detection (PC)
Intel LanDESk VIrus Protect questions (PC)
Re: Satan Bug (Virus alert) (PC)
Re: KEYPRESS 5 virus (PC)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Fri, 29 Oct 93 08:52:02 -0400
From:    padgett@tccslr.dnet.mmc.com (A. Padgett Peterson)
Subject: Washington Concerns

>From:    Rich Travsky <RTRAVSKY@uwyo.edu>
>Subject: Viruses & Electronic Warfare

>The October 18th issue of Aviation Week has an interesting item in its
>Washington Outlook column on future developments in electronic warfare.
>Paraphrase follows:
.
>  It was pointed out that American C3I
>  systems are vulnerable because of their many nodes and reliance on
>  computers and commercial off the shelf components.

Interesting. I am told that the November SIGNAL (Armed Forces
Communications and Electronics Association magazine) is going to
contain an article on the subject I sent in almost a year ago. Wonder
if they got an advance copy ?

						Warmly,
							Padgett

   "Think of it as Evolution in Action" (Oath of Fealty) - VSI94

------------------------------

Date:    Fri, 29 Oct 93 10:21:33 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Draft Swiss AntiVirus regulation

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> Once again, A virus does stuff, and it doesn't tell you what is going
> on (usually).  They don't just stop and say, "Oh, I am going to infect
> this file, is this okay?"

Oh, there are half a dozen viruses that do... :-) Yet, we still
consider them viruses.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 10:28:43 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: 'Dark Avenger'

Fernando Bonsembiante (fernando@ubik.satlink.net) writes:

>  VB> of tricks, you should look at Number_of_the_Beast

>     Excellent! I admire who can pack so much in only 512 bytes... If
> only the author had written an useful device driver instead of that...

And if you want to see so much nastiness packed in 512 bytes, take a
look at EXE_Bug... The one that overwrites random sectors in March.

>     Other one very nice is Ping Pong. It's very well written, and I

I wouldn't advise it to a complete beginner. There's a lot in it that
has nothing to do with the virus properties (i.e., the infection
mechanism) - like the code that displays the bouncing ball, for
instance. Also, the code that locates free clusters and marks them as
bad is quite sophisticated and may seem too difficult for a beginner.
Maybe Stoned is a better sample - it's relatively simple and
straighforward.

> allways loved the trick it uses to jump to top of the memory... It's a
> pitty that trick doesn't works with 80286 and higher, it would be nice
> to use that in other programs.

Fortunately it doesn't work, otherwise it would be possible to bypass
the memory protection in those CPUs.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 10:32:14 -0400
From:    vfreak@aol.com
Subject: Can I get a virus from reading this newsgroup?

From:    S.P.Taylor@bradford.ac.uk (S.P.Taylor)
>Last night, about 11PM, I just decided to read comp.virus for the
>first time. As I read the last article, the whole of our University's
>Multi-User computer came crashing down around my (and everyone else's)

The short answer is no.

for a virus to become active, the user must run an infected program,
or attempt to boot from an infected diskette. COMP.VIRUS and it's
Internet counterpart is text, and there is no executable code at all.

Bill

------------------------------

Date:    Fri, 29 Oct 93 08:48:36 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Virus scanning for Unix (UNIX)

Richard Mitchell 1026 (mitchell@aol12.wff.nasa.gov) writes:

> egads! why would anyone want to boot a dos sloppy in a unix box?

> [Moderator's note: Usually by accident; the user inadvertently leaves
> a floppy disk in drive A: and then performs a reboot.  Most PC BIOSes
> try to boot from the floppy first.  QED...]

Besides the reason mentioned by Ken, there are other good ones. We
just had a call from a company that sells Unix for the PC (Xeninx, I
believe). They asked us whether a PC with only this operating system
installed, can get infected by Michelangelo and, more important,
whether the virus can destroy the contents of the hard disk on March
6.

When we gave a positive reply, they seemed a bit surprised. You see,
several of their customers had a disk crash (as they described it) on
March 6. Meanwhile, they have discovered that the installation
diskette used to install Xenix on the PC, is infected with
Michelangelo. They've spent half an year since March 6, asking
different self-appointed "experts" whether Mich can destroy a
Unix-only PC - and always getting a negative reply. ("What, Unix?
Destroyed by a virus? Michelangelo? No way, those nasty things exist
only in MS-DOS. In Unix, you see, there is protection, only the
supervisor can write to the disk directly...")

As I said, they were rather upset when discovering that the above is
not true, because they had about 20,000 customers, and now had to warn
them all about the problem... :-(

The moral of the story is: remember, an MBR infector -can- infect ANY
IBM PC compatible machine, regardless of what OS it runs. Such a
machine might not be infective (because the OS does not allow the
virus to spread), but it can certainly be infected. If the virus is
causing damage at boot time, it will be able to cause the damage, and
no OS-based protections are going to stop it. In the case of a floppy
disk, the situation is even worse - it can not only be infected, but
also be infective. Be careful with the installation diskettes that
require you to boot from them, regardless of what OS they contain.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 09:12:53 -0400
From:    "David M. Chess" <chess@watson.ibm.com>
Subject: Re: Virus scanning for UNIX (UNIX)

>From:    gmckee@cloudnine.com (Gary McKee)

>When is the last time you copied an executable from one UNIX machine
>onto another one? This is not a characteristic mode of usage for UNIX
>activity.  Usually, programs are recompiled when being ported to
>another machine.

>How often do you transfer data between UNIX machines by carrying a
>floppy disk from machine to machine? Usually, UNIX machines are on
>some kind of network and data is transferred electronically.

>In any event, if you have access to a UNIX machine, you probably are
>too busy doing something interesting to have time for virus writing.

Exactly my point!   I am just claiming that it's this sort of
consideration (which I've called "cultural"; perhaps that was
the wrong word), rather than the existence of access control bits,
protected memory, and so on, that make Unix viruses so rare.

*If* these sorts of cultural things were to change (and Ken's
interlocution suggests that they are changing here and there,
now and then), we might well have to worry about Unix viruses
even though the underlying operating system still had all those
traditional security features.  So I wasn't saying "we're
about to have lots of Unix viruses"; I was saying "the fact
that we don't have Unix viruses has more to do with the
kinds of reasons you've cited, which I called 'cultural',
than with technical reasons having to do with access-control
features of the operating system."  That's all!

- - -- -
David M. Chess                           For Best Results,
High Integrity Computing Lab                Consume Before Above Date
IBM Watson Research

------------------------------

Date:    Fri, 29 Oct 93 09:50:06 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Virus scanning for UNIX (UNIX)

David M. Chess (chess@watson.ibm.com) writes:

> to go round and round on the question for days, I'd like to say
> just one more time that as far as I know we have *no* evidence
> that the lack of protection mechanisms in the PC world has anything
> to do with the fact that viruses have spread there.  Numerous

Well, not quite. There are heaps of MS-DOS viruses that would not work
if there were some reasonable protection - like memory protection,
access control, etc. There are whole classes of tricks that are not
possible under Unix - e.g., stealth and tunnelling (unless the virus
gets root access). Even in MS-DOS, lots of viruses stop working when
something gets changed. The introduction of DOS 4.0 and its large
partitions stopped Poin Pong (the change in the CPU also stopped it,
but that's a different story). The appearance of MS-DOS 5.0 loaded
high caused lots of troubles to many viruses that were expecting to
find everything in a single segment. There is still no virus that is
able to bypass the file and directory passwords in DR-DOS, regardless
that it is trivial to do it.

In general, any incompatibility in the environment greatly reduces the
chances of the existing viruses to spread. Also, increasing the
sophistication of the OS increases the level of knowledge the average
virus writers must have, and thus reduces the number of people who are
able to produce viruses. (Unfortunately, it also takes only one of
them to figure out how to do it, and to post the method on some VX
BBS.)

> people have by now demonstrated that there's no *technical*
> barrier to viruses spreading quite merrily around in Unix systems
> *without* finding or exploiting any security holes.  They can

Indeed, the protection in Unix is not able to stop the viruses
completely. It does, however, slow down the speed of their spread -
even within a single machine. They are far from impossible - they are
just not as successful. On the other hand, a system like Unix provides
very powrful tools for virus writing - it is perfectly possible to
write a virus using the sh script language (and indeed, I have seen at
least two such viruses; one of them was reported in the wild). Such
virus would be portable even between machines with different CPUs and
maybe even between different versions of the operating system.

> So, while it's very easy to say "well, Unix system have security /
> access control / permission bits / whatever, and this will make
> it harder to write a virus", I don't think we have any evidence

It only makes them harder (slower) to spread.

> that it really *will* make it harder.  Viruses can spread anyway,
> through authorized channels.

Yes, it just takes some more time. The supervisor does not execute my
programs every day, so a virus must first find a spreading path
through a chain of users who trust each other and the supervisor must
be a member of this chain. Heck, I don't think that -anybody- executes
my programs on our machine... Neither do I execute the programs of any
other "regular" user. Therefore, I don't see how I can infect
somebody, and in order somebody to infect me, they must get to the
root/bin/daemon/whatever account first.

> Another way to look at it: most
> PCs are still standalone machine even these days: there's *no*
> way for a virus on one machine to get to another machine unless
> someone intentionally carries or transmits something from one
> to the other.

Yes, but unfortunately, this picture is *much* worse than the Unix
world. Under Unix, the different users don't give each other
executable files; they usually run one and the same files, made
available and protected by the superuser. Also, even if I write a
nifty program and my friend wants to use it, s/he probably get it in
source and recompile it, because most certainly the binary won't run
on his/her machine - for instance, I am using VAX/Ultrix, while almost
everybody else here uses SUN stations. They can get my files; they
just can't run the executables. And yes, it is possible to write a
source-code virus too - it's just a tad more difficult than patching
yet another Jerusalem variant or running the latest Virus Generator.

> way, even if all a virus can do in Unix is infect the programs
> that it currently has authority to write to, and hope that eventually
> one of those will be executed in another administrative domain,
> that might well be enough to lead to a Unix virus problem, if
> the culture of program sharing were sufficient.

Yes, there are cultural differences that make the virus spread more
difficult under Unix. There are technical problems too - most people
don't swap binaries not because they don't like it, but because they
can't. Also being able to write only to some restricted set of files,
instead of to everything in sight, helps a bit. As I said, it doesn't
stop, but at least it slows 'em down.

> We're probably all agreeing with each other loudly here, but

Indeed. My message is not a disagreement with you; I am just refining
some points.

> I like to raise a little red flag whenever anyone casually
> implies that things like access controls have to be broken
> before a virus can spread...

Certainly. Discretionary access controls can't stop viruses - they can
only slow them down.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 09:53:44 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Virus scanning for UNIX (UNIX)

Paul J. Ste. Marie (pstemari@well.sf.ca.us) writes:

> Doesn't a secure file system greatly limits the potential for spead of
> viruses?

Yes, it slows it down. It is not able to stop them completely,
however.

> An infected program would have to be executed by root to
> spead the infection to most of the system software.

No. In order to spread, and infected program has to be executed by
somebody else - not necessarily the root. Then it will be able to
infect the files, which are writable by the user who is executing it.
(Actually, this is not just the write-enabled files, but also ALL
executable files owned by that user - because even if they are
read-only, the virus has the rights to make them writable.)

>From that second user, a virus could jump to a third user, if s/he
executes one of the second user's programs. And so on. Eventually,
this chain may reach root. If this happens, the virus has full rights
and can infect ALL infectable objects on the machine - and many of
those on other machines as well.

Yet, this still slows it down and it doesn't spread as fast as between
PC users, who exchange executable code much more often.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 28 Oct 93 14:52:55 -0400
From:    mallen@redvax1.dgsca.unam.mx (Mallen Fullerton Guillermo Manuel-UIA)
Subject: How to clean Empire.Monkey.B (PC)

WARNING: This procedure is not intended for end users or people without a good
        knowledge of the internal structure of a hard disk. The author will
        not be responsible of damage caused in hard disks by mistakes or
        any other reason.

PROCEDURE:

1.- Boot the computer from the HARD DISK. The virus will be active
        in memory.

2.- Read the MBR with any utility that uses BIOS interrupts (almost any one)
        and put it in a diskette. The diskette will become infected.

3.- List the MBR (in HEX and ASCII). You should see the message errors,
        the partition table (starting at offset 0x01be usually with an 0x80)
        and the 55aa marker at the end of the MBR. Stop if you don't see
        any of this things.

4.- Boot again from A CLEAN DISKETTE (write protected to avoid accidents)

5.- Copy the MBR from the diskette to the hard disk using any utility
        designed to do that. Be careful not to boot from the infected
        diskette where you have the MBR.

6.- Clean the diskette where you put the MBR. Use SYS command or FORMAT A:/U

 If you have many machines to clean you can use the same diskette to store
 the MBRs. Put there the utilities to read/write the MBR.

Buena suerte

Guillermo M. Mallen-Fullerton

PS
I sent Frisk a message with information about this virus, but it probably
was destroyed in Frisk's hard disk crash, so I sent him the message again
and I assume he soon will be able to clean this virus without any problem.

------------------------------

Date:    Thu, 28 Oct 93 16:21:08 -0400
From:    frisk@complex.is (Fridrik Skulason)
Subject: Re: Rosenthal again.. (PC)

datadec@ucrengr.ucr.edu (kevin marcus) writes:

> <vfreak@aol.com> wrote:
>>2. It is a very bad idea to release  virus signatures because the VX guys can
>>easily open the files and know what bytes of a virus to change in order for a
>>new variant to slip by a scanner undetected.

>t is unlikely this will occur for every virus they can "find".  I don't
>this is a very common practice.

Well - I received 280 brand new viruses recently - every single one which
had been patched to avoid being detected by a particular set of search
strings that had been "published".

That is common enough for me......

- -frisk

------------------------------

Date:    Thu, 28 Oct 93 22:09:49 +0000
From:    jlaw@irus.rri.uwo.ca (Jeff Lawrence)
Subject: Automated virus scan every n days ? (PC)

I'm trying to solve a problem with my PC. I presently have SCANV and
FPROT on my system. What I am looking for is a program/autoexec code
that will execute F-PROT and SCAN only once on say Thursday and then ignore
all other boots until the following week, etc. I had some code from
PC Magazine's USER-TO-USER (I think) from last year but it did not
work properly. Is there such a beast out there? Please mail all repsonses
to jlaw@irus.rri.uwo.ca.

Thanks in advance!

- --
Slainthe!
Jeff

------------------------------

Date:    Thu, 28 Oct 93 20:34:37 -0400
From:    trimm@netcom.com (Trimm Industries)
Subject: Viruses on Microsoft NT and NT AS (PC)

After Comdex (November 15 thru 19 in Las Vegas) I will be setting
up a small Windows NT AS server with one or two NT clients in
my lab for fault tolerance testing.  Is anyone interested in
using them for virus vulnerability testing?  It will be a sterile,
isolated system with DAT tape and CD-ROM regeneration capabilities
for initializing to a known-clean state.

Regards,
- --
Gary M. Watson
Trimm Industries                          Internet: trimm@netcom.com
North Hollywood, CA 91605                 Compuserve 72242,3437
* See the Trimm RAID-Ready Disk Enclosures at Comdex Las Vegas Nov 15-19 *

------------------------------

Date:    Fri, 29 Oct 93 00:19:59 -0400
From:    vfreak@aol.com
Subject: Re: of interest (PC)

From:    Eugen_Woiwod@f0.n11.z9.virnet.bad.se (Eugen Woiwod)

>Im just wondering why you have not done ThunderByte Anti-Virus which does
>better then all of the mentioned virus utilities here.

TBAV is good, but according to my tests, F-proy is slightly better.

However; TBAV has generic detection routines that F-Prot doesn't have.

------------------------------

Date:    Fri, 29 Oct 93 01:42:22 -0400
From:    datadec@ucrengr.ucr.edu (kevin marcus)
Subject: Re: MtE virus...what does it do? (PC)

John Coughlin <jcoughli@vela.acs.oakland.edu> wrote:
>I recently encountered a virus that Norton NAVSCAN identified as
>MtE. Unfortunately, Norton didn't provide a description of the virus;
>it basically told me to delete it and reinstall the file. Neither
>the versions of Central Point CPAV, MacAffee, or PC Virus that I
>have even recognize this virus. Does anyone know what this MtE virus
>does, and if there's a way to remove it without re-installing the
>infected files?

The MtE is an object module, the "Mutation Engine".  Quite simply,
NAV is telling you that it believes it found a file which is using
a decryptor generated by this engine, which is mostly only useful in a
virus.  (I can't think of a good non-virus use for it, off the top of
my head, but anyways...)

If you only had one occurance of this, it's likely to be a false
identification

CPAV is trash when it comes to detecting any virus, so don't worry
that it didn't pick it up.  Make sure you have a recent version of
McAfee, or consider upgrading to NAV 3.0, which, by algorythm, detects
100% MtE samples.  It is possible, if it is a false id, that it will
still be there.  Additionally, F-Prot is a good choice to quickly scan
over it, or send the particular file to a particular researcher.
Since this a virus using the MtE is most likely encrypted, it is
relatively difficult to disinfect, and I don't know of any
non-integrity based programs which do it.

- --
  -- Kevin Marcus:   datadec@ucrengr.ucr.edu,  tck@bend.ucsd.edu
  CSLD Room Monitor, Thurs 10-12p, Sunday  5-10p (909)/787-2842.
  Computer Science,  University of California, Riverside.

------------------------------

Date:    Fri, 29 Oct 93 04:52:44 -0400
From:    Norman Data Defense Systems <norman@norman.no>
Subject: Re: Essex virus (PC)

Russell Aminzade had a couple of questions regarding the Essex-virus on
his machines. Using SYS to clean a floppy is unreliable and highly
DOS version dependant. The secure way of doing this is as always to
copy the data off and reformat the floppy with the /U option. Make a
simple batch-file to ease the disk-jockey job :) .
Regarding infection of the Novell-volume: Russell is right - NetWare
does not maintain a boot sector - it relies on DOS to run SERVER.EXE.
One possibility, however, is that the image used to boot disk-less
workstations is infected. This is possible if the image was made from
an infected disk. The virus can hence propagate if a workstation
with a floppy drive is booted off the infected image, and floppies
are used in the workstation afterwards etc. Check the image source for
system virus signatures!

                        Kristian A. Bognaes
                        Norman Data Defense Systems Inc.
                        norman@norman.no
                        norman@digex.com

------------------------------

Date:    Fri, 29 Oct 93 08:05:28 -0400
From:    ballard@atl.sofkin.ca (Rick Ballard)
Subject: Stoned cannot be safely removed (PC)

I have a Zenith Turbosport 386 laptop running Stacker that is,
according to SCAN and a number of infected floppies, infected by the
Stoned virus.

CLEAN C: [stoned] gives the following error message :

Found the [Stoned] virus in partition table.
Virus cannot be safely removed from partition table.

What are the implications of this message ? Why can it not be safely
removed ?

There same thing happens when booting off, and running scan from a
clean floppy.

Is this problem caused by its being a Zenith Computer, the fact that
it is running stacker, or some other reason ?

How can I safely remove the virus ?

Thanks to anyone who can help me.

+-----------------------------+---------------------------------------------+
| Rick Ballard                | Phone: 902-468-3680    Fax: 902-468-3679    |
| Facilities Manager          |
| Software Kinetics Ltd.      | Internet:  ballard@atl.sofkin.ca
| 900 Windmill Rd., Suite 107 |
| Dartmouth,NS,Canada B3B 1P7 |
+-----------------------------+---------------------------------------------+

------------------------------

Date:    Fri, 29 Oct 93 09:05:54 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: TREMOR virus (PC)

vfreak@aol.com (vfreak@aol.com) writes:

> Wouldn't it be better to copy all .COM and .EXE files to non executable
> extensions?

I haven't checked it, but I think that yes, it will work.

> This would speed up the process greatly.

Agreed.

> Of course Hard drive space may be critical, and they would not be able to us
> this trick.

There is an extension of the trick, which can save some disk space.
Instead of simply copying the files - archive them. This is not a
cure-all (i.e., it's easy to write a stealth virus that wouldn't be
disinfectable by this method), but it still works in most cases with
fully stealth viruses.

> I used .CVM, and .EVE as the non executable extensions when I needed to get
> rid of an accidental FRODO infection about a year ago.

Some viruses check only for the part of the extension, so I suggest
that you change all letters (e.g., COM -> XYZ, EXE -> UVT).

> Neither of the tricks will work unless the users have a write protected
> bootable diskette available.

Oh, if you know what you are doing, and if you know the virus well,
you can often do the trick without a clean bootable diskette. Just do
the copying/archiving with the virus in memory, so that you disinfect
all files (except COMMAND.COM). The copy COMMAND.COM to, say,
EAT_THIS.XYZ, and modify CONFIG.SYS to use that as a command
interpreter at boot time:

	shell=c:\eat_this.xyz

(Of course, if you use an editor to modify CONFIG.SYS, the editor will
get infected, so you have to copy it to non-exectuable extension
again. Alternatively, don't use an editor at all - just rename the old
CONFIG.SYS and create a new one using the old "copy con config.sys"
method.)

Then you can cold-boot the machine, rename the files back, and restore
the original contents of CONFIG.SYS.

Again, there are many cases in which the above procedure won't work,
so "don't try this at home, kids!"... :-) Use the old, tried, and
reliable method of booting from an uninfected, write-protected, system
diskette.

Regards,
Vesselin

P.S. Uhm, now probably a couple of dozens of people will send me
e-mail, asking when the procedure described above won't work. OK, here
are some cases:

1) The virus is not fully stealth - it's semi-stealth and only hides
the file increase.

2) The virus has infected the two DOS files (IBMBIO.COM and
IBMDOS.COM).

3) The virus is multi-partite or infects other objects too, like
device drivers.

4) The virus is aware of the above procedure and tries to prevent it
from succeeding - for instance by trapping the copy and archiving
commands; well, you get the idea.

There are probably a couple of other cases which I have forgotten.
Enough for not relying on the procedure described, except if you know
perfectly well what you are doing.
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 09:26:27 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: A few questions... (PC)

David M. Chess (chess@watson.ibm.com) writes:

> > in places where they are likely to be. For instance, it's useless (and
> > harmful) to look for Stoned in the low memory or in the DOS buffers.
> > Likewise, Jerusalem will be always at addresses lower than the PSP of
> > your program and Tiny will always reside in the interrupt table.
> > Reporting the virus if you detect it at a place where it obviously
> > cannot be is a mistake. F-Prot makes this mistake - actually, it is
> > rather paranoid when scanning memory.

> So does IBM AntiVirus, at least in some cases, and I disagree that
> it's necessarily a "mistake".  It's a tradeoff: following your rule
> would decrease certain kinds of false alarms, but it would also
> mean that (say) a Jerusalem variant that loaded in higher memory,

OK, you got me with Jerusalem - it was a bad example and I didn't
think about loading it high. However, even in this case it is possible
to take some reasonable assumptions and to look for the virus only
where it is likely to be - below the current PSP and in Upper memory.
Or trace the MCBs. Or whatever. Yes, it introduces some additional
burden to the programmer of the scanner, but wins you reduced
probability for false positives.

(You can't completely eliminate the probability for false positives
with this method; we're talking only about taking reasonable care to
reduce them.)

> or a Tiny variant that loaded elsewhere would be missed, whereas

Gotcha here; a Tiny variant can't be loaded elsewhere and be still
active. All viruses in the Tiny family (I mean the Bulgarian ones; not
Danish_Tiny, Tiny-DI, Tiny-GM, or whatever - I have not checked them)
must install themselves at a particular address. If somebody rewrites
the virus to use a completely different memory allocation strategy -
well then it will be a sufficiently different virus and will belong to
another family. :-)

> it might otherwise have been detected.  Each manufacturer, in
> partnership with the customers, has to decide where the right
> balance is.

Yes, definitely. But, if the customers don't yell at the
manufacturers, nothing is going to change. Back in the old days, the
scanners used to scan every single byte in the file for viruses. I
think that IBM's scanner still does so. However, the customers have
required faster products, so now most scanners use a more intelligent
method and look for the virus only where it is supposed to be. Yes,
this does produce some false negatives - e.g., when a known virus is
"masked" by an unknown one appended to it, or by something stupid like
CPAV's "immunizer" module, but it also eliminates some false positives
and greatly increases speed.

> From what I've seen in our customer set, this
> particular kind of "paranoid" behavior seems to be what the
> customers want, at least in many cases.   Of course, it should

Of course, I can't argue with you on this point - I have never had
even a thousandth of the percent of the customers that IBM has.
However, I would just like to share my own experience here - people
keep calling us because of a false positivess or ghost positives,
caused by paranoid scanners, and I have had noody to complain that the
scanner has not caught a significantly new variant, because it has not
been paranoid enough. Somehow, everybody seems to know that scanners
can't detect new viruses.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 09:54:05 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: info about ANTIX (PC)

Otto Stolz (RZOTTO@NYX.UNI-KONSTANZ.DE) writes:

> If you are, however, refer to ANTHRAX virus, watch out: this is a
> multipartite virus that infects COM and EXE files, and the MBR.

Except that this virus is very unlikely to spread... :-) Once on a
computer, it acts as a non-resident virus and infects only the files
on the first DOS partition. It never infects anything on diskettes.
Even if you copy an infected file on a diskette and execute it from
there on a clean machine, the virus will not infect that machine - it
doesn't infect when the floppy disk motor is on. The only way to get
infected by it is to download an infected file, or to copy an infected
file on the hard disk and to execute it from there. The only known
cases of this virus in the wild were caused by downloading an infected
program from a BBS and executing it.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 10:04:13 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Rosenthal again.. (PC)

kevin marcus (datadec@ucrengr.ucr.edu) writes:

> It would only be "a lot of work" if the >STRINGS< are encrypted.  For
> some products, this is trivial (i.e. Central Point - even while in
> memory, it's trivial to find them).

Not to disagree with you that what Rosenthal has done is useless, bad,
and dangerous, and that a collection of scan strings can't be used to
test how well a scanner detects a virus; just some nit-picking on a
fine point.

Even if the strings are encrypted, this won't stop a determined
hacker. For instance, the strings in SCAN are encrypted, and the last
time I've looked, they even never decrypted them - instead, they
encrypted in the same way the bytes read and then did the comparison.
Nevertheless, there are hackers all over the world, who regularly
crack SCAN and distribute lists of the scan strings used in it. Three
years ago, when I was in the Soviet Union (in the part that is now
Ukraine), cracking SCAN was considered as some kind of intellectual
excercise...

> If the >STRINGS< are encrypted, then it would take abit of time to figure
> out what is going on, and might require tracing through a good few hundred
> K sized file to find out where they are decrypted, and how so.

Nevertheless, they do it. And it takes just one person to do it and to
post the results on a VX BBS, for everybody to use... :-((

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 10:14:26 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Commercial Virus Scanners in the dark??? (PC)

Chris Atkinson (disruptor@pcscav.com) writes:

>  Question: Why are "popular `industry-known' " virus scanners such as
> McAfee's ViruScan, CPAV and NAV so slow to adopt heuristics when it's
> proven to be THE best method of virus detection...

I have the impression that you are a bit misinformed. Frist,
heuristics are not the "best" method of virus detection - nothing is.
They have their good and bad sides. One of the very bad sides is that
they cause a lot of false positives. And each false positive means a
call to the tech support departments. And a large company, that has
hundreds of thousands of users, doesn't like this. Can you imagine
what will happen if just half a percent of them call the tech suport?

Yes, heuristics are a very useful method for virus detection, but they
should be used with care. In particular, I like something that Dr.
Solomon calls "conservative heuristics". Those are heuristics that
give a lot of false negatives and almost no false positives. This way,
if you combine them with a good known-virus scanner, you can still
catch almost all known viruses, a large class of unknown viruses, and
have no false positives.

Second, you are not correct that the producers mentioned above don't
use any kind of heuristics. SCAN uses a wildcard scan string that is
very likely to be found in boot sector viruses (and calls it
GenP/GenB, depending on where it is found) - this is a kind of
heuristics. CPAV 2.x uses heuristics with a very low level of false
positives (I have not seen any) - it calls this "artificial
intelligence", "expert system", "neural networks", or some other such
nonsense. Unfortunately, the program crashes badly on my virus
collection, so I can't check the level of false negatives of their
heuristics. NAV 3.0 (the resident part, I think; I have not seen the
product) uses some heuristic-based technology previously used in NOVI.

And so on. Heursitics will find their way in the anti-virus products;
they will just never become the -only- way for virus detection.

>  It's a REAL SHAME that products such as Thunderbyte and FProt aren't as
> popular as otherwise lame and overrated products such as the
> "industry-known" scanners.

Yes, it's a real shame. It's a real shame that a product as bad as
CPAV can become so popular. It's a shame that -anything- else is not
used instead of it...

But what do you want... Nobody's perfect... Frisk, Frans, and some
others know how to make good scanners; CPS, Symantec, and some others
know how to make a lot of money. :-)

>  Just a comment. I've been out of the scene for about 5 months and
> noticed that things haven't changed much...

Meybe you have to look more carefully.

>  Data Disruptor
>  RABID Development

> disruptor@pcscav.com (Chris Atkinson)

You mean, the virus writer's group?! Or are you just posting from
somebody else's account?

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 10:39:08 -0400
From:    edwing@stack.urc.tue.nl (Edwin Groothuis)
Subject: VShield-detection (PC)

Hello,

I'm quite sure some people don't like this question, but how
can I detect from within a program how VShield is loaded? I'm
using CHKSHLD now and looking to the errorlevel the program
returns, but I want to do it faster (I'm now executing CHKSHLD
from a floppy and that is ***SLOW***)

thanks in advance

Edwin
- --
Note: if you reply, check the address!!!! [I'm using a buggy tin]

Edwin Groothuis          | WordPerfect: (dutch)
edwing@stack.urc.tue.nl  |           Is going to be perfect.
2:284/205.1              |                      Can somebody tell me when?

------------------------------

Date:    Fri, 29 Oct 93 10:49:15 -0400
From:    "George C. Russ: 803-953-6817" <RUSSG@Citadel.edu>
Subject: Intel LanDESk VIrus Protect questions (PC)

We are considering the possiblity of switching from F-Prot to
LandDesk Virus Protect.  DOes anyone have any info on the
ability of this program to protect the Workstations as well as the
F-Prot product does?
Please respond directly, I ma not a member of the list.  Thanks!
George

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
George C. Russ                               803-953-6817 (FAX 953-2212)
Network Services Manager                     Internet:russg@citadel.edu
The Citadel, Charleston SC 29409             BITNET:russg@citadel
			**  GO 'NOLES  **

------------------------------

Date:    Fri, 29 Oct 93 10:49:22 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Satan Bug (Virus alert) (PC)

Eric_N._Florack.cru-mc@xerox.com (Eric_N._Florack.cru-mc@xerox.com) writes:

[quoting Network World]

> Vendors of antivirus software are scrambling to update their products
> to cope with the Satan Bug, an encrypted, polymorphic virus that is
> attacking government computer systems.

Funny, as Frisk noticed, the source of this virus has been first
posted on a government-run virus exchange BBS...

> as particularly difficult to battle because it is encrypted.  Satan
> Bug can render files inoperable, change dates, and shut users out of
> LANs by damaging LAN interface drivers.

This is a way to say that the virus is not intentionally destructive,
but could cause unintentional damge due to bugs in it.

> (It attacks DOS computers, damages .COM, .EXE, .SYS, AND .OVE files
> and makes LANs inaccessible by damaging LAN drivers)

More exactly, it infects everything Opened or Executed (INT 21h, AH=
3Dh, 4Bh, 6Ch), determining the file type by the presence of 'MZ' in
the first two bytes. I don't think that it will be able to infect SYS
files correctly.

> missing code so that it can be put back where it belongs.  The Satan
> Bug has up to nine levels of encryption, the level being different for
> each infection.*, the CIAC bulletin stated.

Huh?! What do they mean??

> The encryption will also make the virus invisible to antivirus
> scanners dated before August.

ANY virus will be invisible to the scanners produced before it has
appeared and this is not because of the encryption... :-)

>  *Satan Bug is a complicated virus, and it9s hard to detect*, said

That's true, and one of the reasons is that it is encrypted in memory,
so detecting that it is active is not that trivial.

> Roger Thompson, president of Marietta, Ga-based Leprechan Software,
> Inc., *It has an encryption / decryption loop, and it decrypts itself
> by using a key anywhere between 40 and 2,000 bits long.:

HUH?! Somebody correct me if I am wrong, but as far as I can see, the
key is always 2 (two) bytes. Maybe they mean the length of the
decryptor? Can it be 2,000 bits (250 bytes)? Hmm, it seems so...

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Fri, 29 Oct 93 11:02:50 -0400
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: KEYPRESS 5 virus (PC)

HXR01 (hrosenblatt@abb.com) writes:

>           Anyone have any experience with KEYPRESS 5 virus????

>           Please respond ASAP....I am not sure what we
>           are dealing with here. Central Point Virus detect
>           version 2.0 picks it up.

I have just tested CPAV 2.0 on my collection of Keypress variants, and
the one that it calls KeyPress 5 is something that we call
Keypress.Ufo (I wonder what do they call KeyPress 2 - I got reports
for many variants of KeyPress 1, and also KeyPress 3, 4, 5 - but never
2.) Unfortunately, this is a very new virus, and we have not analysed
it yet.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 141]
******************************************

