VIRUS-L Digest   Monday, 22 Nov 1993    Volume 6 : Issue 148

Today's Topics:

Liabilities
SURVEY: please help!
Virus at an atomic power station
Draft Swiss AntiVirus regulation
Draft Swiss AntiVirus regulation
Freeware distribution of anti-virus software
Wanted: Integrity Checker (Mac)
Unix virus issues (UNIX)
Re: Virus scanning for UNIX (UNIX)
Novell certification for NetShield (Novell)
Novell Certification for McAfee's NetShield (Novell)
Re: Sorry, I need more RAM memory (PC)
Re: Sorry, I need more RAM memory (PC)
Attention! False positives in SCAN 108 (PC)
Re: Sorry, I need more RAM memory (PC)
Re: Help on virus DIR2. (PC)
Re: error unzipping McAfee stuff (PC)
Re: Text File With Portion of Form Code (PC)
Re: Problems with Anti-Tel (A-Vir) (PC)
Re: Satanbug (PC)
Re: Scanning below the DOS level (PC)
Re: Commercial Virus Scanners in the dark??? (PC)
Stoned in Iowa (PC)
Rosenthal again.. (PC)
Stoned Dual-report with McAffee Scan (PC)
re: IBM pc's and viruses (PC)

VIRUS-L is a moderated, digested mail forum for discussing computer
virus issues; comp.virus is a gatewayed and non-digested USENET
counterpart.  Discussions are not limited to any one hardware/software
platform - diversity is welcomed.  Contributions should be relevant,
concise, polite, etc.  (The complete set of posting guidelines is
available by FTP on CERT.org or upon request.)  Please sign submissions
with your real name; anonymous postings will not be accepted.
Information on accessing anti-virus, documentation, and back-issue
archives is distributed periodically on the list.  A FAQ (Frequently
Asked Questions) document and all of the back-issues are available by
anonymous FTP on CERT.org (192.88.209.5).

Administrative mail (e.g., comments, suggestions, beer recipes)
should be sent to me at: krvw@ASSIST.IMS.DISA.MIL.

All submissions should be sent to: VIRUS-L@Lehigh.edu.

   Ken van Wyk

----------------------------------------------------------------------

Date:    Thu, 11 Nov 93 01:07:16 -0500
From:    ktark@src4src.linet.org (Karl Tarhk)
Subject: Liabilities

Vesselin Bontchev (bontchev@fbihh.informatik.uni-hamburg.de)
writes in reply to: Fernando Bonsembiante (fernando@ubik.satlink.net):

>     To quote Mark Ludwig, we can use computer viruses to do research
> about artificial life.

>It seems to me that Mr. Mark Ludwig has no real idea of what
>"artificial life" is. The "organizms" in those experiments exist in a
>very restricted emulated environment and have nothing to do with the
>real viruses that infect real programs. Everybody is welcome to do
>such experiments in such restricted environments. It's writing viruses
>for the real computers that we label as malicious, unethical, and
>criminal.

>>     Ok, but a virus author may argue he wrote his virus only for
>> investigation purposes, and it escaped... So "intent" isn't enough...

>In such cases the author could be prosecuted for criminal negligeance
>- - for letting his "creature" escape.

>Look, here is an analogy that Dr. Alan Solomon told me once. Suppose I
>want to keep a pet tiger. I consider myself knwoledgeable enough to
>handle it, keep it strictly in my house and all that. Should I be
>forbidden to do it? Of course not (ignore for a moment the more
>delicate issues of protected species, etc.). However, suppose that one
>day the tiger escapes and causes some damage. For instance, eats my
>neiborgh's mother-in-law. (Hmm, is this a damage or a favor? <grin>)
>Is it my fault and should I be hold responsible for it? Of course!

With all the respect this analogy is seriously flawed.

Viruses are not living entities that can 'escape' unless helped by
humans with secondary intentions.  Viruses are just inanimated pieces
of computer code. By attributing non existent powers to computer code
using such analogies is a dangerous thing.  If you take a couple of
preventive measures no computer virus can escape like a 'tiger'.

Lets look at the following counter analogy:

I am a gun manufacturer and inventor.  Should I be held liable for the
uses and misuses of such weapon, if I am not able to control who gets
it and who does not?  Absolutely, positively NOT!

The bottom of the line here is not whether to write viruses or not to
write viruses but who gets them.

And we all know that there is a few CARO virus collections floating
around in the wrong places, so that should answer the question of who
is responsible or who is not.

The point to be made is, that regardless of how careful anyone is
distributing code , for each person the code given to, the
possibilities that the code will end up in the wrong hands is
increased at an exponential rate.

>I don't think that virus creation should be forbidden per se. But I do
>think that if a virus is found somewhere where it is unwanted, the
>author of the virus should share the responsability, even if he has
>not introduced the virus into that system.

By the same token, the manufacturers of firecrackers should be held
liable when someone uses their product in a malicious way?

NO!

You are assuming something that can NOT be proven: Computer viruses
are inherently destructive.  This is false; and, while a million of
you will argue that a good use for a computer virus is yet to be
found, there is yet to be proven that there isn't a good use for a
computer virus.

QED

Regards,
Karl Tarkh

ktark@src4src.linet.org

------------------------------

Date:    Thu, 11 Nov 93 01:51:13 -0500
From:    jwu@convex1.tcs.tulane.edu (John Wuzbek)
Subject: SURVEY: please help!

I am doing a research paper, would you please help out by answering the
following questions:

(1) Do you think your system is at risk of computer virus attack?

(2) Do you think you can take reasonable measures that can totally secure
    your system?

(3) Do you think there should be laws against the deliberate transmission
    of computer viruses?

Please send your responses to jwu@convex1.tcs.tulane.edu
Thank you very much for your time.

------------------------------

Date:    Thu, 11 Nov 93 06:55:45 -0500
From:    A.APPLEYARD@fs1.mt.umist.ac.uk
Subject: Virus at an atomic power station

  On Ceefax (text info transmitted via BBC TV 1 (a British TV channel) on
evening of Wed. 10 Nov 1993:-
  VIRUS: A computer virus sparked a safety scare at Sizewell B nuclear power
station, the latest Computer Weekly says. A man was later sacked for
introducing unauthorized software.

------------------------------

Date:    Thu, 11 Nov 93 22:04:38 -0500
From:    fernando@ubik.satlink.net (Fernando Bonsembiante)
Subject: Draft Swiss AntiVirus regulation

Viernes 05 de Noviembre de 1993, Vesselin Bontchev writes to All:

 VB> I don't think that virus creation should be forbidden per se. But I do
 VB> think that if a virus is found somewhere where it is unwanted, the
 VB> author of the virus should share the responsability, even if he has
 VB> not introduced the virus into that system.

    Ok, that's exactly what I think. I only want to warn about a law that
might be abusive or induce to abuse.

Saludos, Fernando (fernando@ubik.satlink.net)

{                        Fernando Bonsembiante                         }
{ Guemes 160 dto 2                                Tel: (54-1) 654-0459 }
{ Ramos Mejia (1704)                                Fidonet: 4:901/303 }
{ Republica Argentina              Internet: fernando@ubik.satlink.net }

------------------------------

Date:    Thu, 11 Nov 93 22:05:01 -0500
From:    fernando@ubik.satlink.net (Fernando Bonsembiante)
Subject: Draft Swiss AntiVirus regulation

Viernes 05 de Noviembre de 1993, kevin marcus writes to All:

 km> I don't think that would be very funny.

 km> Have you ever heard of something called, "ethics" or "morals"?  I don't
 km> think that there would, "be no difference".

    I'm speaking in legal terms. You can't write a law speaking of ethics or
morals. As ethics and morals change from place to place, from time to time,
an from person to person, we should have something very clear do
differentiate between what is legal and what is not. So, if the law makes no
difference betwen virus writing and anti virus writing (both activities need
the knowledge, the analysis and the exchange of existing computer viruses),
you can say that one is 'moral' and the other isn't, but you will go to jail
anyway.

    I wanted to reduce the problems I saw with that law project to the absurd
to make clear what I think is wrong with it.

 km> This is why most AV people advocate there is no such thing as a good
 km> virus, and that to write a virus, no matter what you say it's for,
 km> you have malicious intent.  The current idea is to label the definition
 km> of a virus as malignant programs, so that the intent can get ruled out.
 km> (IMHO)

    Ok, but we must take care in that definition. We must arrive to a clear
definition to avoid future problems with the law. To quote a friend: what's
the difference between a computer virus and Stacker or Double Space? An
automathic compression program is changing our files without authorization.
We could talk about 'implicit authorization'. I don't say it would be
impossible to differentiate between a virus an a 'legal' program, but we must
be very careful when writting the law. Think about that: if some person finds
a commercial program that can be considered as 'malicious' acording to the
law's definition, perhaps something like Double Space or Pklite, that person
may think that it would be great to sue Microsoft or Pkware and get some
millions of dollars for free...

Saludos, Fernando (fernando@ubik.satlink.net)

{                        Fernando Bonsembiante                         }
{ Guemes 160 dto 2                                Tel: (54-1) 654-0459 }
{ Ramos Mejia (1704)                                Fidonet: 4:901/303 }
{ Republica Argentina              Internet: fernando@ubik.satlink.net }

------------------------------

Date:    Fri, 12 Nov 93 04:18:09 -0500
From:    Norman Data Defense Systems <norman@norman.no>
Subject: Freeware distribution of anti-virus software

I read with interest the article by Rob Slade about freeware
distribution distribution of anti-virus software. I am a supporter of
the freeware and shareware principles, and have both written and
supported applications on a "please support" basis. Shareware or
freeware versions of virus scanners have doubtlessly saved my systems
a couple of times as well when I was a student. Still, I have a
concern regarding this method of distribution when it comes to
anti-virus protection software: - Freeware is often written on a
volunteer basis. Software maintenance and support is handed from one
person to another. Keeping a reasonable level of quality and
continuity will often prove to be difficult, with the exception of the
companies that also have full commercial versions available (I wrote a
few freeware applications for use by HAM radio operators, none that I
still seriously support. I never made any money either, although the
software is in use by many).

                             Kristian A. Bognaes
                             Norman Data Defense Systems
                             norman@norman.no
                             norman@digex.com



------------------------------

Date:    Fri, 12 Nov 93 07:43:02 -0500
From:    gerald@vmars.tuwien.ac.at
Subject: Wanted: Integrity Checker (Mac)

Well, I'm looking for an Integrity Checker for Apple MacIntosh (System 7):

   Commercial or x-Ware (x=share,free,happy,postcard,...)
   English or German

Thanks for any replies,
Gerald

- ----------------------------------------------------------------------------
 Gerald Pfeifer (Jerry)              Technical University Vienna, Austria .
 gerald@vmars.tuwien.ac.at                                                .
..........................................................................
 Business is: Druckerei Peter Pfeifer             Address: Leutnerstr. 2  .
         Fax: +43 (2944) 2830                              2054 Haugsdorf .
       Phone: +43 (2944) 2226                              Austria        .

------------------------------

Date:    Wed, 10 Nov 93 23:38:05 -0500
From:    radatti@cyber.com (Pete Radatti)
Subject: Unix virus issues (UNIX)

The entire question of a virus being executed by root
or by a user is really moot.  The objective of
most attack software on Unix systems is to gain root
access. This is very easy to do even on a well protected
system.  The basic protection against unauthorized access
to superuser privilage on a Unix system is that the methods
used to break in are not often discussed, except by crackers...

As long as race conditions such as exist in mkdir and the
ability to have an EUID, (Effective User ID) continue, there
will never be any serious level of security in Unix.  This
does not make Unix bad.  Unix was designed to be open and
foster communication between users.  Security is necessary
and the main argument will always be what is the risk benefit
ratio.  The risk is slowly increasing so more measures are
needed.  I don't believe that the risk will ever be so great
that Unix will be dropped.  MSDOS is very high risk but there
are more copies of it in use than any other operating system.

Pete Radatti
radatti@cyber.com

------------------------------

Date:    Thu, 11 Nov 93 16:34:38 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Virus scanning for UNIX (UNIX)

Paul J. Ste. Marie (pstemari@well.sf.ca.us) writes:

> The system software is owned by either root or bin, and not writable
> by normal users.

Directly, yes. But there are some other sensitive users, e.g. daemon.
Probably some others. If there is a transitive information from from
one "regular" user to one of the sensitive ones, a virus could
eventually manage to infect a file that will be executed by root, or
to gain root access by other means.

I agree with you than on a well-administered Unix system this
shouldn't be the case, but sometimes it is very difficult to tell
whether a particular Unix system with lots of users and groups is well
administered. Maybe tools like Kuang and Tiger can help to determine
the possible sensitive paths of information flow between the users on
a system.

> Major software packages such as Oracle usually
> require a special user to be created to own the software, but access
> to that user account has the same restrictions as root/bin.

Yes, such special users are also sensitive. Also, probably sync, uucp,
and some others.

> Obviously, this doesn't apply to user programs, but typical Unix
> installation have very few user programs that are executed by anyone
> other than the user that created them.

Agreed, this happens rarely enough to make the virus spread on Unix
machines slow and ineffective. My point is that it is not enough to
stop them completely from replicating, and that the probability to get
root access after infecting a chain of users is greater than zero...

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 19:29:59 -0500
From:    nhirsch@panix.com (Norman Hirsch)
Subject: Novell certification for NetShield (Novell)

McAfee announced Novell certification for NetShield, version 1.55 today.
This will eliminate the concerns that many have had regarding installing
an anti-virus program as an NLM that wasn't Novell certified.

As I understand it, it was Novell certified for Netware 3.11, 3.12, 4.01,
SFT-III and NetWare for OS/2.

Best regards,

Norman Hirsch, NH&A, authorized McAfee agent.
Phone: (212) 304-9660, Fax: (212) 304-9759, BBS: (212) 304-9759,,,,,,3
                                                      (commas delay dailing)
Internet: nhirsch@panix.com
CompuServe: 72115,661

------------------------------

Date:    Fri, 12 Nov 93 14:53:23 -0500
From:    nhirsch@panix.com (Norman Hirsch)
Subject: Novell Certification for McAfee's NetShield (Novell)

McAfee's NetShield, the NLM anti-virus program for Novell NetWare was
certified for the following operating systems:

NetWare (v3.11)
NetWare (v3.12)
NetWare SFT III (v3.11)
NetWare (v4.01)
NetWare for OS/2 (v4.01)

NLM Category: Virus Protection
NLM Type:     Server Utility

McAfee Associates' NETShield is a server based anti-virus utility for
Novell NetWare.  NETShield provides facilities for real-time virus
scanning on file access and at user-defined intervals.  It also provides
CRC fingerprinting of executable files.

For further information, evaluation copies, site licensing, etc., contact
McAfee Associates or any authorized McAfee agent.

Best regards,

Norman Hirsch
NH&A, authorized McAfee agent
Internet: nhirsch@panix.com         CompuServe: 72115,661
Phone: (212) 304-9660               Fax: (212) 304-9759
BBS: (212) 304-9759,,,,,,,3 (commas delay dialing)

------------------------------

Date:    Thu, 11 Nov 93 11:50:00 -0500
From:    dreamer@info.polymtl.ca (Eric Robibaro)
Subject: Re: Sorry, I need more RAM memory (PC)

Ng Bee Yong (byng@solomon.technet.sg) wrote:
: Has anyone encounter the following error message from SCAN?

:   Sorry, I need more RAM memory
:   390 kbytes should be enough

: Is it some kind of bug in SCAN?  I am quite sure I have more than 500 kbytes
: of conventional memory before running SCAN.  It happened when I scanned some
: standalone machines, and also when I tried to scan the network.

: Anyone knows the problem please enlighten me.  Thks.
: The error occurs sometimes before checking of RAM for viruses, sometimes in
: the midst of scanning some files.
I heard that it could be due to some memory allocation algorithm in
version 107, you did not specify which version you use, i suggest getting
version 108 form mcafee.com or a mirror of the simtel
archive(oak.oakland.edu) through anonymous ftp, it should solve the
problem
 --

Eric Robibaro
dreamer@info.polymtl.ca
the News's Sleepy Animal
If you only beleive half of what he says, that cuts it down to one-hundred
fifty.  That's not too plausible either for a human...
	- Tanis Half-Elven, to Apoletta, in dragons of Spring Dawning

------------------------------

Date:    Thu, 11 Nov 93 11:53:26 -0500
From:    dreamer@info.polymtl.ca (Eric Robibaro)
Subject: Re: Sorry, I need more RAM memory (PC)

Ng Bee Yong (byng@solomon.technet.sg) wrote:
: Has anyone encounter the following error message from SCAN?

:   Sorry, I need more RAM memory
:   390 kbytes should be enough

: Is it some kind of bug in SCAN?  I am quite sure I have more than 500 kbytes
: of conventional memory before running SCAN.  It happened when I scanned some
: standalone machines, and also when I tried to scan the network.

: Anyone knows the problem please enlighten me.  Thks.
: The error occurs sometimes before checking of RAM for viruses, sometimes in
: the midst of scanning some files.
Oups, in my last posting, i forgot to mention that using the /A option of
scan was the most prone to cause the errors you mentioned
- --

Eric Robibaro
dreamer@info.polymtl.ca
the News's Sleepy Animal
If you only beleive half of what he says, that cuts it down to one-hundred
fifty.  That's not too plausible either for a human...
	- Tanis Half-Elven, to Apoletta, in dragons of Spring Dawning

------------------------------

Date:    Thu, 11 Nov 93 13:31:43 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Attention! False positives in SCAN 108 (PC)

Hello, everybody!

It has been brought to my attention that McAfee's SCAN 108 reports
viruses in two of the files on our anonymous ftp site. This is a FALSE
POSITIVE, I repeat, those files DO NOT CONTAIN VIRUSES. I will try to
explain here what the problem is.

1) When run with the /A option, SCAN 108 reports "Abraxas5 [OW] Virus"
in the file -V.DEM from the archive avp_107b.zip.

Explanation. This file is part of the help system of the package AVP.
More exactly, it contains the programs that demonstrate the different
virus video and sound effects. Very often, the code for these
demonstrations is picked directly from the respective virus. The file
is not encrypted, so when the whole of it is scanned, this code may
cause a false positive, if the scanner has selected part of the
payload of the virus as a scan string (bad idea).

It is difficult to say which of the two programs (AVP or SCAN) is the
guilty one; I would say that they share the guilt.

Possible solutions, in order of preference.

a) Tell the author of AVP to keep this file encrypted. (I already did
that.)

b) Don't use the /A option of SCAN - this option should be used ONLY
after an infection is found in "normal" mode.

c) Use a better anti-virus program instead of SCAN - a program that
identifies viruses, instead of looking for scan strings.

2) SCAN 108 reports the file HS.COM from the arhive hs32.zip as
containing the "TridenT [TridenT] Virus". This is in normal scanning
mode; no fancy options used.

Explanation. First of all, SCAN reports this not about a particular
virus, but about ALL viruses based on TPE (TridenT's Polymorphic
Engine). This polymorphic engine is similar to the MtE and can be used
much in the same way to generate highly polymorphic viruses. One
notable difference is that the decryptors generated by it are a bit
less polymorphic, but much more "generic" than the ones generated by
the MtE. By "generic" I mean that it is perfectly possible to find a
TPE-generated decryptor in a perfectly legitimate piece of code. The
decryptors can be long and sophisticated as well as short and simple.
This creates the possibility for a program which tries to recognize
the TPE-based viruses only by their decryptors, to cause false
positives.

In our particular example, the program HS.COM is encrypted and
decrypts itself at runtime. It's decryptor looks like that:

	mov	cx,cs:[07B5]
	mov	bx,cs:[07B7]
	push	cx
	push	bx
decr_lp:
	xor	word ptr cs:[bx+0100],052A
	add	bx,2
	loop	decr_lp

The last three instructions of the decryptor do the real work. And
they are a decryptor that can be generated by the TPE. Since SCAN
tries only to recognize the decryptors (instead of performing exact
identification of the particular virus), it gives a false positive.

Possible solutions.

a) Inform the author of HS and ask him to use a different decryption
routine.

b) Don't use SCAN, or more exactly, don't rely on it when it reports a
TPE-based virus (i.e., TridenT [TridenT]). In any case, the current
version of SCAN 108 is NOT able to detect reliably ANY of the
TPE-based viruses, using ANY of the available 5 versions of TPE. This
problem has been reported to McAfee Associates in August.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 14:46:05 -0500
From:    Bryan Bross <bbross@umr.edu>
Subject: Re: Sorry, I need more RAM memory (PC)

Ng Bee Yong (byng@solomon.technet.sg) wrote:
: Has anyone encounter the following error message from SCAN?

:   Sorry, I need more RAM memory
:   390 kbytes should be enough

: Is it some kind of bug in SCAN?  I am quite sure I have more than 500 kbytes
: of conventional memory before running SCAN.  It happened when I scanned some
: standalone machines, and also when I tried to scan the network.

: Anyone knows the problem please enlighten me.  Thks.
: The error occurs sometimes before checking of RAM for viruses, sometimes in
: the midst of scanning some files.

I had that problem for a while and it bugged me as well.  I was running
386MAX v7.0 & VSAFE.exe from Norton.  I didn't know which one of these was
causing the problem at the time, but now I am pretty sure it was vsafe.
Get rid the that piece of trash software, and use fprot's virstop or
something.  I have not had any problems since I terminated vsafe, although
I am not running 386MAX right now either.  Good Luck!

Bryan --
   *-----------------------------------------------------------------------*
	Bryan C. Bross			|	bbross@umr.edu
	Geological Engineering		|	s099186@umrvma.umr.edu
	University of Missouri - ROLLA	|	71613.42@compuserve.com
   *-----------------------------------------------------------------------*
	EXPERTS use expertise and wisdom; WIZARDS use smoke and mirrors!

------------------------------

Date:    Thu, 11 Nov 93 15:12:58 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Help on virus DIR2. (PC)

sl2yt@cc.usu.edu (sl2yt@cc.usu.edu) writes:

> my friend just bought a brand new pc but the problem with it when i
> try to copy from from the flopy disk to the hard disk in some
> files(only some files )it fails copying them and it only copies part
> of the files.for example, if the file is 100k it fails copying at 65k
> so it copys only 65k and then it gives me an error message saying
> fail, ignore, abort, retry? then when i say the option fail it says
> the message fail on init 24.  some people says it is the floppy or
> hard disk but they are new and the id controler card also new.  but

What you describe indeed sounds like a hardware problem. Not like a
viral one.

> someone told me it is a virus called dir2.  is that true?.  please

No. If it were Dir_II, you could be able to copy only one cluster (512
bytes, 1 Kb, 2 Kb, 8 Kb, 16 Kb, or 32 Kb - but I doubt that your disk
is that large) - not 65 Kb of the file.

> send me an email message if you have any idea or if i can find any
> software in ftp to check that virus.  i will be real thanksful.

Try ftp.informatik.uni-hamburg.de:/pub/virus/progs/dir2clr.zip. The
archive also contains a description of what the virus does.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 15:16:38 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: error unzipping McAfee stuff (PC)

John M. Clark (c2mxcla@fre.fsu.umd.edu) writes:

> I transfered a copy of wscan108.zip, scanv108.zip and cleanv108.zip from
> mcafee.com to my school's VAX.  I then downloaded the files to my 286.  I
> tried to unzip the files with pkunzip v 204g, but it reported an error and
> told me to use pkzipfix.  I did this and then when I tried unzip, it
> reported that I need to use PKUnzip version 7.3 or later.

> There is no such version, is there??

No, there isn't. Most probably, you have made some communication
mistake. Did you set mode to binary when getting the files via ftp?
Did you check what is the proper way to transfer binary files from the
VMS account to your PC? I suggest that you contact the system
administrator or technical support person who is responsible for your
mainframe, because the mistake is almost certainly at that level.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 15:20:21 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Text File With Portion of Form Code (PC)

Mark S. Zajaros (msz2@po.CWRU.Edu) writes:

> Later in the day, the user went to retrieve a large WordPerfect
> file. Only half appeared. One of our staff looked at the file
> with a sector editor and found the text portion of the Form
> virus and, I believe (not sure) part of the code. Needless
> to say I'm a little puzzled. Anyone experience anything similar
> with Form or any other virus? Does anyone have any clues as to
> the cause?

Yes, this can happen and can indeed be cause by the Form virus. The
problem is, that when this virus infects the hard disk, it stores the
second part of its body (the one that contains the texts) over the
last cluster of the active partition, regardless whether this cluster
is free or not. If the cluster happens to belong to a file, this file
will be corrupted. This is what has happened in your case.

It's a good example how a not intentionally destructive virus like
Form, can cause damage due to design bugs or because it has infected a
system its author knows nothing about.

> BTW, F-Prot was used on at least 12 other infected computers
> covering at least 20 total infections fo Form without a hitch,
> so I don't think that it had anything to do with F-Prot.

Indeed, it has nothing to do with F-Prot. It has to do with the way
this virus infects hard disks.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 15:27:24 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Problems with Anti-Tel (A-Vir) (PC)

Jose Agustin Lopez Bueno (LOPEZJ@evalun11.bitnet) writes:

>    Last day, one friend tell me that he found Anti-Tel on his computer.
> He cannot use the floppy drive (A:, 3 1/2). Every time that he boot the
> computer, the CMOS configuration for floppy was changed. Firstly, I think of
> the virus was in CMOS, but I've read that it is not possible. Where is the v
> s? How can it do this? The main problem is that my friend has not one anti-v
> s on his computer, and the floppy drive is not functionally (even I change t
> setup configuration, when I reboot, the virus change other time the configur
> on). How could I kill this virus?

1) It is indeed not possible for a virus to reside entirely in the
CMOS.

2) The Kampana virus (or Telefonica, or Anti-Tel - those are just aliases
of one and the same virus) doesn't corrupt the CMOS, as far as I
recall. It is, however, a very destructive virus (trashes your hard
disk after 400 reboots), so you are advised to remove it ASAP. Your
CMOS problem might be unrelated to the virus, however.

3) Indeed, the presence of a boot sector virus in memory sometimes
causes problems when reading 3.5" floppies.

4) The virus is a DOS Boot Sector Infector, so in order to remove it,
it is enough to SYS the infected volume. Beware, however, that the
virus is stealth and you must make sure that it is not present in
memory when you are trying to remove it. The only certain way to
ensure this is to cold-boot from a write-protected uninfected system
diskette. Since you will do SYS, you must make sure that the diskette
contains the same version of the operating system as the volume you
intend to SYS.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 15:57:47 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Satanbug (PC)

Ullrich Fischer (Ullrich_Fischer@mindlink.bc.ca) writes:

> Which scanners detect it?

Several. I have not performed detailled tests, but here are some
results of running different scanners on my collection of replicants
of this virus.

> The article indicates McAfee v108 does.

Nope. I have at least one naturally replicated sample which is NOT
detected by this version of McAfee's SCAN. Therefore, I conclude that
it is not able to detect this virus reliably.

> How about f-prot 2.09f?

It seems to detect it.

> Any others?

TbScan 6.08, AVP 1.07b, VET #E7.50, VPCScan 2.91, NAV 2.1 with updates
of November '93

> CPAV 2.0?

Nope. Even version 2.1 doesn't detect it.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 16:41:27 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Scanning below the DOS level (PC)

David_Conrad@MTS.cc.Wayne.edu (David_Conrad@MTS.cc.Wayne.edu) writes:

> They have all made that point that it would require a great deal of
> work (although it's really just a SMOP :) and that what with reading
> the directory and interpreting the FAT, it would be much slower than
> just using file handles and opening the file through DOS.  (One wonders

Not exactly. I clearly pointed out that if the "right" task is
performed "manually", it will be even faster than DOS itself. However,
the "reversed" task is what will be very slow and ineffective.

> how DOS manages to do it *without* reading the directory and interpreting
> the FAT.)

DOS solves only the right task - determining which sectors belong to a
file. It doesn't solve the reverse task - determining to which file a
sector belongs. Only CHKDSK does it to some extent, and it is not
exactly a speed demon.

> But one major reason for not scanning at the sector level, the most
> important reason IMNSHO, hasn't been mentioned.  Any scanner which did
> this would lose compatibility with future DOS versions, or with other
> environments (OS/2, Windows NT, UN*X DOS boxen) which emulate DOS.  A

It *was* mentioned - by Frisk.

> All this, to get past stealth viruses.

And even without a guarantee to succeed. Virus like Dir_II or Int13
will be still able to stealth the infection from the scanner.

> Well, there's already a simple
> way to do that.  Boot from a known clean, write-protected floppy.

Exactly! The only problem is that in some cases (e.g., EXE_Bug) this
is not so easy and requires a detailled explanation.

> Considering the problems found in sector-level scanning and the easy
> alternative which already exists, it just isn't worth it.

Indeed.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    Thu, 11 Nov 93 17:01:55 -0500
From:    bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Commercial Virus Scanners in the dark??? (PC)

giuse_r@pavo.concordia.ca (GIUSE_R@PAVO.CONCORDIA.CA) writes:

> well, readers of perhaps pro-virus magazines, such as the infamous NuKE
> info-journal issue #7, had a VERY interesting article concerning the
> heuristic use of ThunderByte's AntiVirus' package.

How VERY intersting. From the description that follows, I understand
that the readers of those magazines have had also the wonderful
opportunity to infect their machines, while reading the article. How
very exciting, indeed.

> the _terrible_ bug, was with the TBCLEAN.EXE utility, this program which is
> available in all version of TBAV, claims to be able to clean viruses, withou
> any needed information on the virus. basically it will set up an environment
> that will actually _execute_ the virus-infected file to be cleaned! Now my
> _greatist_ fear is if TBCLEAN is unable to "handle" the virus, the virus can
> get out of hand and go resident and start infecting the computer!!!

Indeed, one particular version of TbClean had a bug in the virus
tracing routine that allowed a virus to do that. But why don't you say
that you are talking about an old, obsolete version (was it 6.01?) and
that the bug has been fixed long time ago and that the current version
is free of it? Otherwise, I agree with you that tracing the virus is a
risky business and lots of care must be taken. A much better (but also
much slower) method is to emulate the virus code.

> and one person (Rock Steady) developed a virus called "Varicella" this virus

How naughty... One wonders - who that guy could be...

> did exactly the above! meaning if I gave you a file (anyfile) infected with
> the Varicella virus, and if you tried to clean this virus infected file with
> tbclean, what would actual happen is that tbclean will report "that this fil
> is not infected by a virus" but what _actually_ happen was that the virus
> escaped the controlled environment that tbclean setup to try to disinfect th
> file, and the virus will go resident and hook interrupts 21h,13h,8h,1ch. and
> it will allocate memory under the TOM, and fool tbclean in reporting that no
> virus is in the file, and tbclean will exit normally!

However, TbScan was not able to detect the virus in the first place,
so few people would have the idea to run TbClean on an infected file -
they will just not know that the file is infected. And, if the virus
has already infected their machine, it is certainly not TbClean's
fault. However, I agree with you that that particular version of
TbClean was dangerously buggy. The bug has been fixed, however, since
a long time.

> whereby, infact the varicella virus went resident and is now infecting the
> system. and to advice you, the varicella virus is fairly a stealth virus tha

However, the stealth was implemented in a rather clumsy way - the
files were disinfected on file open and re-infected on file close.
This would cause a significant slowdown and is too far away of the
elegant solutions in Frodo or Number of the Beast.

BTW, the standard CARO name of the virus you are talking about is
Npox.1482.

> disinfects files on the file, when opened and reinfects them when closed,
> and it hides its virus length very well! such a virus can easily get out of
> control on a huge level. all because we trusted heuristic scanning!

No, not because we trusted heuristic scanning. It has happened,
because

> because tbclean, actually tries to remove viruses from the infect file by
> executing the virus, with the help of the int 1 & 3. makes this method

Exactly. You seem to be messing heuristic scanning with heuristic
disinfection. Those are two different things. TbScan does NOT trace
the files it scans like TbClean.

> very dangerous to use! as shown to you by mr. rock steady of Nuke.

All "Mr. Rock Steady of NuKE" has shown is the presence of a security
bug in a particular version of TbClean. The bug has been fixed long
time ago.

> so before you think "heuristic" is the best method of scanning/cleaning
> think again!

Even before that, go and learn what heuristics really are and what
kinds of them are available.

> the rate of false positives is WAY TOO HIGH! and remember that

It entirely depends on how the designer of the heuristic analyser has
set the trigger level of his heuristics. Ever seen Dr. Solomon's
FindVirus to report "a new boot virus" while it is in fact a false
positive? Nope. It has a very high trigger level for its heuristics -
it misses a lot of unknown viruses, but if it triggers, you can be
pretty sure that it has indeed found a virus. This is called
"conservative heuristics", BTW.

> it is better to be 100%, than 99% because that 1% can cause quite a bit of
> damage, if we disreguard it!

I'm not sure what you mean by those percentages, but if it is the
level of security you want - just turn your computer off. Heuristics
have nothing to do here - there is a positive probability that
any anti-virus protection will be bypassable under some circumstances
and by some attacks.

Regards,
Vesselin
- --
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany

------------------------------

Date:    11 Nov 93 16:51:37 -0500
From:    stuttik1241@cobra.uni.edu
Subject: Stoned in Iowa (PC)

I'M HAVING TROUBLE WITH EITHER A VARIANT OF THE STONED VIRUS OR MONKEY. FROM
WHAT I GATHER IT MAY BE THE SAME VIRUS WITH TWO DIFFERNT NAMES.
         WELL, I USED F-PROT AND IT DETECTED A VARIANT OF STONED ON MY D: DRIVE
 WHICH IS MY SLAVEDRIVE. THE DETECTION WAS IN THE BOOT SECTOR. I RAN NORTONS
DISK DOCTOR/REBUILD AND IT SAID NEITHER C: NOR D: WERE DOS PARTITIONS.??..
(F-PROT SCANNED MY C:DRIVE AS O.K.)
         I CHOOSE TO FIND DOS PARTITION ON THE D: DRIVE. IT DID ITS
THING THEN REBOOTED THE SYSTEM. NOW SCANNING THE DRIVE WITH F-PROT IT DISPLAYS
A POSSIBLE VARIANT OF STONED IN THE BOOT SECTER OF DRIVE 2. THEN I RAN NORTONS
ANTI-VIRUS AND IT SCANS BOTH DRIVES AS CLEAN.
        I GUESS MY QUESTION IS- AM I CLEAN? THE D: DRIVE IS EMPTY, I WOULD LIKE
TO TOTALLY WIPE IT AND GET AN O.K. SCAN FROM F-PROT. IS THERE A BETTER WAY OF
CLEANING THE HARDDRIVE UP?

------------------------------

Date:    Thu, 11 Nov 93 22:04:49 -0500
From:    fernando@ubik.satlink.net (Fernando Bonsembiante)
Subject: Rosenthal again.. (PC)

Viernes 05 de Noviembre de 1993, Vesselin Bontchev writes to All:

 VB> Simple. When the scanner in question is run on the collection, it
 VB> detects NONE of the viruses in it. Almost every other scanner tried
 VB> detects most of the viruses or says that they are new variants. The
 VB> conclusions are obvious.

    Something like that happened to me. I've got a lot of VCL, Suriv and
Jerusalem variants, and that scanner didn't detected anything. Other scanners
detected the viruses as new variants of old viruses. I think that all people
reading this may like to know that the scanner that failed to detect those
viruses is McAfee Scan, and the others are Dr Solomon's and F-Prot. To avoid
detection with Scan, all you need to do is to insert a NOP in the right
place.

Saludos, Fernando (fernando@ubik.satlink.net)

{                        Fernando Bonsembiante                         }
{ Guemes 160 dto 2                                Tel: (54-1) 654-0459 }
{ Ramos Mejia (1704)                                Fidonet: 4:901/303 }
{ Republica Argentina              Internet: fernando@ubik.satlink.net }

------------------------------

Date:    Fri, 12 Nov 93 15:41:54 -0500
From:    THE GAR <GLWARNER@samford.bitnet>
Subject: Stoned Dual-report with McAffee Scan (PC)

Can anyone tell me why some machines would report being infected
with STONED twice on a single scan?  I'm running Scan 108, and
when I scan some infected machines it reports that STONED has
been found in the partition table, then scans a minute more,
and reports the same thing again.

This is the first field work I've done with the 108 release on "old"
machines, and was dissappointed to learn that Scan and Clean no
longer will fit on a single 360k DOS 3.3 bootable disk!  If anyone
is listening, let me register that as an official complaint!

 /++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\
!  Later        +   Systems Programmer                                 !
!  Gary Warner  +   Samford University Computer Services               !
!               +   II TIMOTHY 2:15                                    !
 \+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++/

------------------------------

Date:    Fri, 12 Nov 93 16:17:34 -0500
From:    "David M. Chess" <chess@watson.ibm.com>
Subject: re: IBM pc's and viruses (PC)

>From:    gt7495b@prism.gatech.edu (Daniel H. Smith)

>I have recently discovered at work that the new IBM pc's have the
>capability of catching viruses on the Reference Disk that is stored on
>the computer's hard drive.

The reference partition on Model 90's and 95's (those are the
only machines that I know have them; there may be others) can
indeed become infected, by booting from an infected reference
diskette, and they are difficult to clean up.  The way they
work, as I understand it, is that after a normal boot, the
BIOS completely closes off access to the reference partition;
so no scanner run after a normal boot will find the virus.
The virus also won't get a chance to load in that case, since
the BIOS hasn't executed anything from there, either.  But if
you boot from a reference diskette, or if you press the Magic
Key Combination during boot, the BIOS instead forgets about
the normal part of the hard disk, and comes up with only
the reference partition visible.  If you've booted from an
infected reference diskette, the virus will be able to infect
the MBR or the SBR of the reference partition, and if you've
booted from an infected reference partition with the magic
key combination, the virus will be loaded from there.  After
loading, the virus will be able to spread to other diskettes
that you use until reboot (typically only reference diskettes).

The reference partition isn't really a "partition" in the
usual sense; it's a part of the hard disk that's reserved
by BIOS, that's normally completely invisible.  It's not
trivial to scan/clean it.  I'll describe something that works
for us but NOTE that it is a completely unofficial and
unsupported method, and may make your system fly into little
pieces for all I know.  For more official help, contact your
computer or anti-virus supplier.

To make a diskette that'll boot your machine with DOS, but with
the reference partition visible, make a disk copy of a reference
diskette (that is, a track-for-track copy), and replace the COMMAND.COM,
IBMBIO.COM, and IBMDOS.COM on the copy with the same-named files
from your favorite DOS machine.  Then boot your Model 90 or
whatever from that diskette; you *should* find yourself in DOS,
with a C: drive visible that has unfamiliar-looking files on it.
You can then stick in a diskette with your anti-virus program
on it, and run it against the C: drive.  That should be able
to detect and remove and viruses lurking there.  Then reboot
normally.  Again, this is Completely Unofficial, and may not
work for you...

DC

------------------------------

End of VIRUS-L Digest [Volume 6 Issue 148]
******************************************

